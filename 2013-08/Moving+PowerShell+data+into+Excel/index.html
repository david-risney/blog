<!doctype html>
<html lang="en" class="gradient-background">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Moving PowerShell data into Excel</title>
		<meta name="description" content="Dave Risney&#39;s blog on web, coding, and things">
		<link rel="alternate" href="/dave/feed/feed.xml" type="application/atom+xml" title="deletethis.net">
		<link rel="alternate" href="/dave/feed/feed.json" type="application/json" title="deletethis.net">

		<meta name="generator" content="Eleventy v2.0.0">

		<link rel="icon" type="image/svg+xml" href="/dave/img/semicolon.svg">
		<link rel="stylesheet" href="/dave/css/index.css">

		<script>
window.addEventListener("pageswap", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});

window.addEventListener("pagereveal", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});
		</script>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/dave/" class="home-link">deletethis.net<!-- img src="/img/semicolon-dark.svg" class="logo" --></a>
			<nav>
				<h2 class="visually-hidden">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/dave/post/">Blog</a></li>
					<li class="nav-item"><a href="/dave/about/">About</a></li>
					<li class="nav-item"><a href="/dave/feed/feed.xml"><!-- img class="logo" src="/img/rss-dark.svg" -->Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			<h1>Moving PowerShell data into Excel</h1>

<ul class="post-metadata">
	<li><time datetime="2013-08-15">15 August 2013</time></li>
</ul>

<div xmlns="http://www.w3.org/1999/xhtml"><div>
  PowerShell nicely includes ConvertTo-CSV and ConvertFrom-CSV which allow you to serialize and deserialize your PowerShell objects to and from CSV. Unfortunately the CSV produced by ConvertTo-CSV is
  not easily opened by Excel which expects by default different sets of delimiters and such. Looking online you'll find folks who recommend using automation via COM to create a new Excel instance and
  copy over the data in that fashion. This turns out to be very slow and impractical if you have large sets of data. However you can use automation to open CSV files with not the default set of
  delimiters. So the following isn't the best but it gets Excel to open a CSV file produced via ConvertTo-CSV and is faster than the other options:
  <pre><code>Param([Parameter(Mandatory=$true)][string]$Path);<br><br>$excel = New-Object -ComObject Excel.Application<br><br>$xlWindows=2<br>$xlDelimited=1 # 1 = delimited, 2 = fixed width<br>$xlTextQualifierDoubleQuote=1 # 1= doublt quote, -4142 = no delim, 2 = single quote<br>$consequitiveDelim = $False;<br>$tabDelim = $False;<br>$semicolonDelim = $False;<br>$commaDelim = $True;<br>$StartRow=1<br>$Semicolon=$True<br><br>$excel.visible=$true<br>$excel.workbooks.OpenText($Path,$xlWindows,$StartRow,$xlDelimited,$xlTextQualifierDoubleQuote,$consequitiveDelim,$tabDelim,$semicolonDelim, $commaDelim);</code></pre>See
  <a href="http://msdn.microsoft.com/en-us/library/ff837097.aspx">Workbooks.OpenText documentation</a> for more information.
</div></div>

<ul class="links-nextprev"><li>Previous: <a href="/dave/2013-08/Serializing+JavaScript+Promise+Execution/">Serializing JavaScript Promise Execution</a></li><li>Next: <a href="/dave/2013-08/FitBit+and+WebOC+Application+Compatibility+Errors/">FitBit and WebOC Application Compatibility Errors</a></li>
</ul>

		</main>

		<footer></footer>

		<!-- Current page: /dave/2013-08/Moving+PowerShell+data+into+Excel/ -->
	</body>
</html>
