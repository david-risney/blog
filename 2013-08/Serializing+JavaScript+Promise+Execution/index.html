<!doctype html>
<html lang="en" class="gradient-background">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Serializing JavaScript Promise Execution</title>
		<meta name="description" content="Dave Risney&#39;s blog on web, coding, and things">
		<link rel="alternate" href="/dave/feed/feed.xml" type="application/atom+xml" title="deletethis.net">
		<link rel="alternate" href="/dave/feed/feed.json" type="application/json" title="deletethis.net">

		<meta name="generator" content="Eleventy v2.0.0">

		<link rel="icon" type="image/svg+xml" href="/dave/img/semicolon.svg">
		<link rel="stylesheet" href="/dave/css/index.css">

		<script>
window.addEventListener("pageswap", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});

window.addEventListener("pagereveal", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});
		</script>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/dave/" class="home-link">deletethis.net<!-- img src="/img/semicolon-dark.svg" class="logo" --></a>
			<nav>
				<h2 class="visually-hidden">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/dave/post/">Blog</a></li>
					<li class="nav-item"><a href="/dave/about/">About</a></li>
					<li class="nav-item"><a href="/dave/feed/feed.xml"><!-- img class="logo" src="/img/rss-dark.svg" -->Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			<h1>Serializing JavaScript Promise Execution</h1>

<ul class="post-metadata">
	<li><time datetime="2013-08-10">10 August 2013</time></li>
</ul>

<div xmlns="http://www.w3.org/1999/xhtml"><div>
  Occasionally I have need to run a set of unrelated promises in series, for instance an object dealing with a WinRT camera API that can only execute one async operation at a time, or an object
  handling postMessage message events and must resolve associated async operations in the same order it received the requests. The solution is very simply to keep track of the last promise and when
  adding a new promise in serial add a continuation of the last promise to execute the new promise and point the last promise at the result. I encapsulate the simple solution in aÂ simple
  constructor:<br><br><pre><code>    function PromiseExecutionSerializer() {<br>        var lastPromise = WinJS.Promise.wrap(); // Start with an empty fulfilled promise.<br><br>        this.addPromiseForSerializedExecution = function(promiseFunction) {<br>            lastPromise = lastPromise.then(function () {<br>                // Don't call directly so next promise doesn't get previous result parameter.<br>                return promiseFunction();<br>            });<br>        }<br>    }</code></pre><br>
<p>The only thing to watch out for is to ensure you don't pass the result of a previous promise onto a subsequent promise that is unrelated.</p>
</div></div>

<ul class="links-nextprev"><li>Previous: <a href="/dave/2013-08/Considerate+MessagePort+Usage/">Considerate MessagePort Usage</a></li><li>Next: <a href="/dave/2013-08/Moving+PowerShell+data+into+Excel/">Moving PowerShell data into Excel</a></li>
</ul>

		</main>

		<footer></footer>

		<!-- Current page: /dave/2013-08/Serializing+JavaScript+Promise+Execution/ -->
	</body>
</html>
