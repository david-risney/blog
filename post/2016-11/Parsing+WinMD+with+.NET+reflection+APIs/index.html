<!doctype html>
<html lang="en" class="gradient-background">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Parsing WinMD with .NET reflection APIs</title>
		<meta name="description" content="David Risney&#39;s blog on web, coding, and things">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="dave.deletethis.net">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="dave.deletethis.net">

		<meta name="generator" content="Eleventy v2.0.0">

		<link rel="icon" type="image/svg+xml" href="/img/semicolon.svg">
		<link rel="stylesheet" href="/css/index.css">

		<script>
window.addEventListener("pageswap", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});

window.addEventListener("pagereveal", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});
		</script>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<header>
			<a href="/" class="home-link">dave.deletethis.net <img src="/img/semicolon-dark.svg" class="logo"></a>
			<nav>
				<h2 class="visually-hidden">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/post/">Blog</a></li>
					<li class="nav-item"><a href="/about/">About</a></li>
					<li class="nav-item"><a href="/feed/feed.xml"><img class="logo" src="/img/rss-dark.svg"> Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			<h1>Parsing WinMD with .NET reflection APIs</h1>

<ul class="post-metadata">
	<li><time datetime="2016-11-02">02 November 2016</time></li>
</ul>

<div xmlns="http://www.w3.org/1999/xhtml"><div><p>
    Parsing WinMD files, the containers of WinRT API metadata, is relatively simple using the appropriate .NET reflection APIs. However, figuring out which reflection APIs to use is not obvious. I've
    got a completed <a href="https://github.com/david-risney/WinMDGraph/blob/master/WinMDTypes.cs">C sharp class parsing WinMD files</a> that you can check out for reference.
  </p><p>
    Use <code><a href="https://msdn.microsoft.com/en-us/library/system.reflection.assembly.reflectiononlyload(v=vs.110).aspx">System.Reflection.Assembly.ReflectionOnlyLoad</a></code> to load the
    WinMD file. Don't use the normal load methods because the WinMD files contain only metadata. This will load up info about APIs defined in that WinMD, but any references to types outside of that
    WinMD including types found in the normal OS system WinMD files must be resolved by the app code via the <code><a href="https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.windowsruntime.windowsruntimemetadata.reflectiononlynamespaceresolve(v=vs.110).aspx">System.Reflection.InteropServices.WindowsRuntimeMetadata.ReflectionOnlyNamespaceResolve</a></code>
    event.
  </p><p>
    In this event handler you must resolve the unknown namespace reference by adding an assembly to the NamespaceResolveEventArgs's ResolvedAssemblies property. If you're only interested in OS system
    WinMD files you can use <code><a href="https://msdn.microsoft.com/en-us/library/hh138431(v=vs.110).aspx">System.Reflection.InteropServices.WindowsRuntimeMetadata.ResolveNamespace</a></code> to
    turn a namespace into the expected OS system WinMD path and turn that path into an assembly with ReflectionOnlyLoad.
  </p></div></div>

<ul class="links-nextprev"><li>Previous: <a href="/post/2016-08/WPAD+Server+Fiddler+Extension+Source/">WPAD Server Fiddler Extension Source</a></li><li>Next: <a href="/post/2016-11/Let-s+Encrypt+NearlyFreeSpeech.net+Update/">Let&#39;s Encrypt NearlyFreeSpeech.net Update</a></li>
</ul>

		</main>

		<footer></footer>

		<!-- Current page: /post/2016-11/Parsing+WinMD+with+.NET+reflection+APIs/ -->
	</body>
</html>
