<!doctype html>
<html lang="en" class="gradient-background">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Multiple Windows in Win10 JavaScript UWP apps</title>
		<meta name="description" content="Dave Risney&#39;s blog on web, coding, and things">
		<link rel="alternate" href="/feed/feed.xml" type="application/atom+xml" title="deletethis.net">
		<link rel="alternate" href="/feed/feed.json" type="application/json" title="deletethis.net">

		<meta name="generator" content="Eleventy v2.0.0">

		<link rel="icon" type="image/svg+xml" href="/img/semicolon.svg">

		<style>
		@view-transition { navigation: auto; }

::view-transition-group(*) { animation-duration: 0.2s; }

@keyframes slide-in-from-left { from { translate: -150vw 0; } }
@keyframes slide-in-from-right { from { translate: 150vw 0; } }
@keyframes slide-out-to-left { to { translate: -150vw 0; } }
@keyframes slide-out-to-right { to { translate: 150vw 0; } }
@keyframes scale-up { from { scale: 0; } }
@keyframes scale-down { to { scale: 0; } }
@keyframes fade-in { from { opacity: 0; } }
@keyframes fade-out { to { opacity: 0; } }

html:active-view-transition-type(forwards, backwards) {
	:root { view-transition-name: none; }
	header { view-transition-name: header; }
	main { view-transition-name: main; }
	footer { view-transition-name: footer; }
}

html:active-view-transition-type(forwards) {
	&::view-transition-old(main) { animation-name: fade-out; }
	&::view-transition-new(main) { animation-name: fade-in; }
}

html:active-view-transition-type(backwards) {
	&::view-transition-old(main) { animation-name: fade-out; }
	&::view-transition-new(main) { animation-name: fade-in; }
}

html:active-view-transition-type(reload) {
	&::view-transition-old(root) { animation-name: fade-out; }
	&::view-transition-new(root) { animation-name: fade-in; }
}

/* Defaults */
:root {
	--font-family: -apple-system, system-ui, sans-serif;
	--font-family-monospace: Consolas, Menlo, Monaco, Andale Mono WT, Andale Mono, Lucida Console, Lucida Sans Typewriter, DejaVu Sans Mono, Bitstream Vera Sans Mono, Liberation Mono, Nimbus Mono L, Courier New, Courier, monospace;
}

/* Theme colors */
:root {
	--color-gray-20: #e0e0e0;
	--color-gray-50: #C0C0C0;
	--color-gray-90: #333;

	--background-color-rgb: 255, 255, 255;
	--background-color: rgb(var(--background-color-rgb));
	--background-color-slightly-transparent: rgba(var(--background-color-rgb), 0.75);

	--text-color: var(--color-gray-90);
	--text-color-link: #082840;
	--text-color-link-active: #5f2b48;
	--text-color-link-visited: #17050F;

	--syntax-tab-size: 2;
}

@media (prefers-color-scheme: dark) {
	:root {
		--color-gray-20: #e0e0e0;
		--color-gray-50: #C0C0C0;
		--color-gray-90: #dad8d8;

		--background-color-rgb: 21, 32, 43;

		/* --text-color is assigned to --color-gray-_ above */
		--text-color-link: #1493fb;
		--text-color-link-active: #6969f7;
		--text-color-link-visited: #a6a6f8;

		--content-border: #dad8d8;
		--content-background: #272727;
	}
}


/* Global stylesheet */
* {
	box-sizing: border-box;
}

html {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
	background-color: var(--background-color);
}

body {
	padding: 0;
	margin: 0 auto;
	font-family: var(--font-family);
	color: var(--text-color);
}
html {
	overflow-y: scroll;
}

@media (width <= 50em) {
	body {
		max-width: 25em;
	}

	#recap-container {
		display: grid;
		grid-template-columns: 1fr;
		grid-template-rows: repeat(1, 1fr);
		gap: 1em;
	}

	#blog-posts {
		grid-column: 1 / 2;
		grid-row: 1 / 2;
	}

	#mastodon-posts {
		grid-column: 1 / 2;
		grid-row: 2 / 3;
	}
}

@media (width > 50em) {
	body {
		max-width: 50em;
	}

	#recap-container {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 1em;
	}

	#blog-posts {
		grid-column: 1 / 2;
	}

	#mastodon-posts {
		grid-column: 2 / 3;
	}
}

/* https://www.a11yproject.com/posts/how-to-hide-content/ */
.visually-hidden {
	clip: rect(0 0 0 0);
	clip-path: inset(50%);
	height: 1px;
	overflow: hidden;
	position: absolute;
	white-space: nowrap;
	width: 1px;
}

p:last-child {
	margin-bottom: 0;
}
p {
	line-height: 1.5;
}

li {
	line-height: 1.5;
}

a[href] {
	color: var(--text-color-link);
}
a[href]:visited {
	color: var(--text-color-link-visited);
}
a[href]:hover,
a[href]:active {
	color: var(--text-color-link-active);
}

main {
	padding: 1rem;
	background-color: var(--content-background);
}
main :first-child {
	margin-top: 0;
}

.links-nextprev {
	list-style: none;
	border-top: 1px dashed var(--color-gray-20);
	padding: 1em 0;
}

table {
	margin: 1em 0;
}
table td,
table th {
	padding-right: 1em;
}

pre,
code {
	font-family: var(--font-family-monospace);
}
pre:not([class*="language-"]) {
	margin: .5em 0;
	line-height: 1.375; /* 22px /16 */
	-moz-tab-size: var(--syntax-tab-size);
	-o-tab-size: var(--syntax-tab-size);
	tab-size: var(--syntax-tab-size);
	-webkit-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
	direction: ltr;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
}
code {
	word-break: break-all;
}

/* Header */
/* header is flex with the items aligned to the ends 
   so that the first item is left aligned and the
   last is right aligned */
#floatyHeader {
	display: grid;
	align-items: center;
	padding: 1em;
	grid-template-columns: 1fr auto;
	grid-template-areas: "home nav";
}

#floatyHeader {
	top: 0px;
	position: sticky;
	height: 4em;
}

#floatyHeader {
	height: 100%;
	width: 100%;
	background: var(--background-color-slightly-transparent);
	backdrop-filter: blur(5px) saturate(200%);
}

#floatyHeader {
	border-bottom: 5px dashed var(--color-gray-20);

	animation: headerChange auto linear;
	animation-timeline: scroll(root);
}

@keyframes headerChange {
	0% { 
		height: 300px; 
		margin-bottom: 0px; 
		grid-template-areas: "home nav";
	}
	15% { 
		height: 4em; 
		margin-bottom: calc(300px - 4em);
		grid-template-areas: "home nav";
	}
	100% { 
		height: 4em; 
		margin-bottom: calc(300px - 4em);
		grid-template-areas: "home nav";
	}
}

.home-link {
	grid-area: home;
	animation: homelinkChange auto linear;
	animation-timeline: scroll(root);
}
@keyframes homelinkChange {
	0% { font-size: 3em; }
	15% { font-size: 1em; }
	100% { font-size: 1em; }
}

nav {
	grid-area: nav;
	height: 100%;
}
.home-link {
	font-size: 1em; /* 16px /16 */
	font-weight: 700;
	margin-right: 2em;
}
.home-link:link:not(:hover) {
	text-decoration: none;
}

/* Nav */
.nav {
	display: flex;
	padding: 0;
	margin: 0;
	list-style: none;
}
.nav-item {
	display: inline-block;
	margin-right: 1em;
}
.nav-item a[href]:not(:hover) {
	text-decoration: none;
}
.nav a[href][aria-current="page"] {
	text-decoration: underline;
}

/* Posts list */
.postlist {
	list-style: none;
	padding: 0;
	padding-left: 1.5rem;
}
.postlist-item {
	display: flex;
	flex-wrap: wrap;
	align-items: baseline;
	counter-increment: start-from -1;
	margin-bottom: 1em;
}
.postlist-item:before {
	display: inline-block;
	pointer-events: none;
	content: "" counter(start-from, decimal-leading-zero) ". ";
	line-height: 100%;
	text-align: right;
	margin-left: -1.5rem;
}
.postlist-date,
.postlist-item:before {
	font-size: 0.8125em; /* 13px /16 */
	color: var(--color-gray-90);
}
.postlist-date {
	word-spacing: -0.5px;
}
.postlist-link {
	font-size: 1.1875em; /* 19px /16 */
	font-weight: 700;
	flex-basis: calc(100% - 1.5rem);
	padding-left: .25em;
	padding-right: .5em;
	text-underline-position: from-font;
	text-underline-offset: 0;
	text-decoration-thickness: 1px;
}
.postlist-item-active .postlist-link {
	font-weight: bold;
}

/* Tags */
.post-tag {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	text-transform: capitalize;
	font-style: italic;
}
.postlist-item > .post-tag {
	align-self: center;
}

/* Tags list */
.post-metadata {
	display: inline-flex;
	flex-wrap: wrap;
	gap: .5em;
	list-style: none;
	padding: 0;
	margin: 0;
}
.post-metadata time {
	margin-right: 1em;
}

/* Direct Links / Markdown Headers */
.header-anchor {
	text-decoration: none;
	font-style: normal;
	font-size: 1em;
	margin-left: .1em;
}
a[href].header-anchor,
a[href].header-anchor:visited {
	color: transparent;
}
a[href].header-anchor:focus,
a[href].header-anchor:hover {
	text-decoration: underline;
}
a[href].header-anchor:focus,
:hover > a[href].header-anchor {
	color: #aaa;
}

h2 + .header-anchor {
	font-size: 1.5em;
}

/* logo is the size of the text and center aligned 
against the center of the text */
.logo {
	width: 1em;
	height: 1em;
	vertical-align: middle;
}
		</style>
		<script>
window.addEventListener("pageswap", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});

window.addEventListener("pagereveal", async (e) => {
	if (e.viewTransition) {
		if (navigation.activation.from.url === navigation.activation.entry.url) {
			e.viewTransition.types.add('reload');
		} else {
			e.viewTransition.types.add('forwards');
		}
	}
});
		</script>
	</head>
	<body>
		<a href="#skip" class="visually-hidden">Skip to main content</a>

		<header id="floatyHeader">
			<a href="/dave/" class="home-link">deletethis.net<!-- img src="/img/semicolon-dark.svg" class="logo" --></a>
			<nav>
				<h2 class="visually-hidden">Top level navigation menu</h2>
				<ul class="nav">
					<li class="nav-item"><a href="/dave/post/">Blog</a></li>
					<li class="nav-item"><a href="/dave/about/">About</a></li>
					<li class="nav-item"><a href="/feed/feed.xml"><!-- img class="logo" src="/img/rss-dark.svg" -->Feed</a></li>
				</ul>
			</nav>
		</header>

		<main id="skip">
			<h1>Multiple Windows in Win10 JavaScript UWP apps</h1>

<ul class="post-metadata">
	<li><time datetime="2018-03-10">10 March 2018</time></li>
</ul>

<div xmlns="http://www.w3.org/1999/xhtml"><div><h2>
    Win10 Changes
  </h2><p>
    In Win8.1 JavaScript UWP apps we supported multiple windows using MSApp DOM APIs. In Win10 we use window.open and window and a new MSApp API getViewId and the previous MSApp APIs are gone:
  </p><table><tbody><tr><td></td><th>
          Win10
        </th><th>
          Win8.1
        </th></tr><tr><th>
          Create new window
        </th><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/open">window.open</a></td><td><a href="https://msdn.microsoft.com/en-us/library/dn254975(v=vs.85).aspx">MSApp.createNewView</a></td></tr><tr><th>
          New window object
        </th><td><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window">window</a></td><td><a href="https://msdn.microsoft.com/en-us/library/dn268315(v=vs.85).aspx">MSAppView</a></td></tr><tr><th>
          viewId
        </th><td>
          MSApp.getViewId(window)
        </td><td><a href="https://msdn.microsoft.com/en-us/library/dn567969(v=vs.85).aspx">MSAppView.viewId</a></td></tr></tbody></table><h2>
    WinRT viewId
  </h2><p>
    We use window.open and window for creating new windows, but then to interact with WinRT APIs we add the MSApp.getViewId API. It takes a window object as a parameter and returns a viewId number
    that can be used with the various <a href="https://docs.microsoft.com/en-us/uwp/api/Windows.UI.ViewManagement.ApplicationViewSwitcher">Windows.UI.ViewManagement.ApplicationViewSwitcher</a> APIs.
  </p><h2>
    Delaying Visibility
  </h2><p>
    Views in WinRT normally start hidden and the end developer uses something like <a href="https://docs.microsoft.com/en-us/uwp/api/windows.ui.viewmanagement.applicationviewswitcher#Windows_UI_ViewManagement_ApplicationViewSwitcher_TryShowAsStandaloneAsync_System_Int32_">TryShowAsStandaloneAsync</a>
    to display the view once it is fully prepared. In the web world, window.open shows a window immediately and the end user can watch as content is loaded and rendered. To have your new windows act
    like views in WinRT and not display immediately we have added a window.open option. For example<br /><code>let newWindow = window.open("https://example.com", null, "msHideView=yes");</code></p><h2>
    Primary Window Differences
  </h2><p>
    The primary window that is initially opened by the OS acts differently than the secondary windows that it opens:
  </p><table><tbody><tr><td></td><th>
          Primary
        </th><th>
          Secondary
        </th></tr><tr><th>
          window.open
        </th><td>
          Allowed
        </td><td>
          Disallowed
        </td></tr><tr><th>
          window.close
        </th><td>
          Close app
        </td><td>
          Close window
        </td></tr><tr><th>
          Navigation restrictions
        </th><td>
          ACUR only
        </td><td>
          No restrictions
        </td></tr></tbody></table><p>
    The restriction on secondary windows such that they cannot open secondary windows could change in the future depending on feedback.
  </p><h2>
    Same Origin Communication Restrictions
  </h2><p>
    Lastly, there is a very difficult technical issue preventing us from properly supporting synchronous, same-origin, cross-window, script calls. That is, when you open a window that's same origin,
    script in one window is allowed to directly call functions in the other window and some of these calls will fail. postMessage calls work just fine and is the recommended way to do things if
    that's possible for you. Otherwise we continue to work on improving this.
  </p></div></div>

<ul class="links-nextprev"><li>Previous: <a href="/dave/2017-10/MSApp.getHtmlPrintDocumentSourceAsync+-+JavaScript+UWP+app+printing/">MSApp.getHtmlPrintDocumentSourceAsync - JavaScript UWP app printing</a></li><li>Next: <a href="/dave/2018-05/Tiny+browser+features-+JSBrowser+zoom/">Tiny browser features: JSBrowser zoom</a></li>
</ul>

		</main>

		<footer></footer>

		<!-- Current page: /dave/2018-03/Multiple+Windows+in+Win10+JavaScript+UWP+apps/ -->
	</body>
</html>
